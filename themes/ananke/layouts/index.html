{{ define "main" }}
  <!-- 메인 콘텐츠 -->
  <article class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy {{ $.Param "text_color" | default "mid-gray" }}">
    {{ .Content }}
  </article>

  {{/* 메인 페이지: 모든 섹션에서 최신 글 */}}
  {{ if .IsHome }}
    <div class="pa3 pa4-ns w-100 w-70-ns center">
      <h1>{{ i18n "latestPostsTitle" }}</h1> <!-- 다국어로 "최신 글" 번역 -->
      <section class="w-100 mw8">
        {{ $latestPosts := first 3 .Site.RegularPages.ByDate.Reverse }}
        {{ range $latestPosts }}
          <div class="relative w-100 mb4">
            {{ $featured_image := partial "func/GetFeaturedImage.html" . }}
            {{ $summary := .Content | plainify | truncate (default 30 .Site.Params.summaryLength) "..." }}

            <!-- 이미지 출력 -->
            {{ if $featured_image }}
              <div class="mb3">
                <a href="{{ .RelPermalink }}">
                  <img src="{{ $featured_image }}" alt="{{ .Title }}" style="width: 100%; height: auto;">
                </a>
              </div>
            {{ end }}

            <!-- 타이틀 -->
            <h2 class="f3 fw4 lh-title mt0">
              <a href="{{ .RelPermalink }}" class="link black dim">{{ .Title }}</a>
            </h2>

            <!-- 요약 내용 -->
            <p>{{ $summary }}</p>

            <!-- 더 보기 링크 -->
            <a href="{{ .RelPermalink }}" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">
              {{ $.Param "read_more_copy" | default (i18n "readMore") }}
            </a>
          </div>
        {{ end }}
      </section>
    </div>
  {{ else }}
    {{/* 기존 섹션 동작 유지 */}}
    {{ $mainSections := .Site.Params.mainSections | default (slice "post") }}
    {{ range $mainSections }}
      {{ $section_name := . }}
      {{ $section := where $.Site.RegularPages "Section" "in" $section_name }}
      {{ $section_count := len $section }}
      {{ if ge $section_count 1 }}
        <div class="pa3 pa4-ns w-100 w-70-ns center">
          {{ with $.Site.GetPage "section" $section_name }}
            <h1 class="flex-none">
              {{ $.Param "recent_copy" | default (i18n "recentTitle" .) }}
            </h1>
          {{ end }}

          {{ $n_posts := $.Param "recent_posts_number" | default 3 }}
          <section class="w-100 mw8">
            {{ range (first $n_posts $section) }}
              <div class="relative w-100 mb4">
                {{ $featured_image := partial "func/GetFeaturedImage.html" . }}
                {{ $summary := .Content | plainify | truncate (default 30 .Site.Params.summaryLength) "..." }}

                <!-- 이미지 출력 -->
                {{ if $featured_image }}
                  <div class="mb3">
                    <a href="{{ .RelPermalink }}">
                      <img src="{{ $featured_image }}" alt="{{ .Title }}" style="width: 100%; height: auto;">
                    </a>
                  </div>
                {{ end }}

                <!-- 타이틀 -->
                <h2 class="f3 fw4 lh-title mt0">
                  <a href="{{ .RelPermalink }}" class="link black dim">{{ .Title }}</a>
                </h2>

                <!-- 요약 내용 -->
                <p>{{ $summary }}</p>

                <!-- 더 보기 링크 -->
                <a href="{{ .RelPermalink }}" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">
                  {{ $.Param "read_more_copy" | default (i18n "readMore") }}
                </a>
              </div>
            {{ end }}
          </section>

          {{ if ge $section_count (add $n_posts 1) }}
            <section class="w-100">
              <h1 class="f3">{{ i18n "more" }}</h1>
              {{ range (first 4 (after $n_posts $section)) }}
                <h2 class="f5 fw4 mb4 dib {{ cond (eq $.Site.Language.LanguageDirection "rtl") "ml3" "mr3" }}">
                  <a href="{{ .RelPermalink }}" class="link black dim">
                    {{ .Title }}
                  </a>
                </h2>
              {{ end }}
              {{ with $.Site.GetPage "section" $section_name }}
                <a href="{{ .RelPermalink }}" class="link db f6 pa2 br3 bg-mid-gray white dim w4 tc">
                  {{ i18n "allTitle" . }}
                </a>
              {{ end }}
            </section>
          {{ end }}
        </div>
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}
