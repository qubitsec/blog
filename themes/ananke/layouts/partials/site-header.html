{{ $featured_image := partial "func/GetFeaturedImage.html" . }}
{{ if $featured_image }}
  {{ $featured_image_class := .Params.featured_image_class | default "cover bg-center" }}
  {{ $cover_dimming_class := .Params.cover_dimming_class | default "bg-black-60" }}
  <header class="{{ $featured_image_class }}" style="background-image: url('{{ $featured_image }}');">
    <div class="{{ $cover_dimming_class }}">
      {{ partial "site-navigation.html" . }}
      <div class="tc-l pv6 ph3 ph4-ns">
        {{ if not .Params.omit_header_text }}
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">{{ .Title | default .Site.Title }}</div>
          {{ with .Params.description }}
            <div class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              {{ . }}
            </div>
          {{ end }}
        {{ end }}
      </div>
    </div>
  </header>
{{ else }}
  {{/* Define language and URL-based image paths */}}
  {{ $lang := .Site.Language.Lang }}
  {{ $url := .Page.RelPermalink | replace "/" "-" | trim "-" }}
  {{ $imagePath := printf "/images/%s%s.jpg" $lang $url }} <!-- Language-URL specific image -->
  {{ $defaultLangImage := printf "/images/%s-bg.jpg" $lang }} <!-- Language-specific default image -->

  {{/* Determine final background image */}}
  {{ $backgroundImage := $imagePath }}
  {{ if not (fileExists (printf "static%s" $imagePath)) }}
    {{ $backgroundImage = $defaultLangImage }}
  {{ end }}

  {{/* Debugging Information */}}
  <!-- Debug Information -->
  <!-- Lang: {{ $lang }}, URL: {{ $url }}, ImagePath: {{ $imagePath }}, DefaultLangImage: {{ $defaultLangImage }}, Final BackgroundImage: {{ $backgroundImage }} -->

  <header class="cover bg-center" style="background-image: url('{{ $backgroundImage }}');">
    <div class="{{ .Site.Params.background_color_class | default "bg-black" }}">
      {{ partial "site-navigation.html" . }}
    </div>
  </header>
{{ end }}
