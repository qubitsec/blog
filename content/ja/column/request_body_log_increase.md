---
title: "要求本文ログの保存時の容量増加率の分析"
date: 2023-05-05T10:37:00
draft: false
description: "要求本文（Post-body）をログに残す場合は、ログ容量の増加率とストレージ要件を分析します。"
featured_image: "cdn/column/request_body_log_increase.jpg"
tags: ["リクエスト本文", "Post-body", "Request-body", "ログ分析"]
---

📝伝統的に、Webサーバーのアクセスログ(access.log)にはリクエスト本文(Post-body)が含まれていません。これは、デフォルト設定では本文ログが提供されず、本文ログによる容量の増加が懸念されるためです。しかし、本文ログはWebアプリケーションファイアウォール(WAF)の回避攻撃を防ぎ、セキュリティを強化するために不可欠です。

<!--more-->

![リクエスト本文ログ保存分析](https://blog.plura.io/cdn/column/request_body_log_increase.jpg)

---

### 1. **リクエスト本文ログ保存の必要性**

- **セキュリティ強化:** 本文ログなしでは、特定の攻撃を検出または分析することが困難です。
- **WAF回避攻撃への対応:** 本文ログを保存することで、WAF回避攻撃などの脅威に効果的に対応できます。[1]
- **デバッグおよび分析:** リクエスト本文は、トラフィック分析やデバッグに有用な情報を提供します。

---

### 2. **ストレージ増加率の予測**

#### **Q1. リクエスト本文ログを保存するとどの程度増加するのか？**

リクエスト本文をログに保存すると、**リクエストサイズ**に応じてログファイルの容量が増加します。一般的に:

- リクエスト本文が大きいほど、ログサイズの増加幅が大きくなります。
- POSTリクエストの割合が高いほど、ログファイルのサイズはさらに増加します。

#### **Q2. 平均的に何%増加するのか？**

リクエスト本文のサイズは多様であるため、正確な増加率を予測するのは困難ですが、一般的な増加率は次のとおりです:

- 平均して **30%〜50%** の増加が予想される
- 例: 現在のログファイルサイズが100GBの場合、リクエスト本文を追加で保存すると **130GB〜150GB** に増加する可能性あり

#### **Q3. ストレージ要件の算定**

予測された増加率を基に、ストレージ容量を計画する必要があります:

1. **現在のログサイズを確認:** 現在のログファイルサイズを基に増加率を適用
2. **POSTリクエストの割合を分析:** POSTリクエストが全体のリクエストに占める比率を把握
3. **ログ圧縮および管理:** ログファイルの圧縮およびローテーションポリシーを活用してストレージ要件を最適化

---

### 3. **ログ保存の最適化対策**

- **ログ圧縮:** Gzipなどの圧縮技術を活用して、ログファイルのサイズを削減可能
- **ログローテーション:** 一定の周期でログファイルを分割し、ストレージ管理を効率化
- **セキュリティ優先:** 容量増加が懸念される場合でも、セキュリティ強化のためにリクエスト本文ログの保存を推奨

---

### ✍️ 結論

リクエスト本文ログを保存すると、ログ容量が平均で30%〜50%増加する可能性があります。これはセキュリティを強化し、WAF回避攻撃を防ぐために不可欠です。ストレージ要件を事前に予測し、圧縮やログローテーションなどの管理手法を活用して効率的に対応することが重要です。

---

### 📖 **一緒に読む**
- [Webファイアウォールバイパス攻撃どのように対応できますか？](https://blog.plura.io/ja/column/waf_bypass_response/)
