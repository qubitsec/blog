---
title: "IPSとNDRの違いと限界"
date: 2023-02-23
draft: false
description: "IPSとNDRの主な違いと限界を分析し、「すでにWAFがある場合はなぜ必要なのか」という観点から、ホストベースのセキュリティシステムの代替ニーズを議論します。"
featured_image: "cdn/column/ips_vs_ndr.jpg"
tags: ["IPS", "NDR", "セキュリティ", "ネットワークセキュリティ", "暗号化パケット", "Endpoint Security"]
---

🔍 **IPS**（Intrusion Prevention System）と **NDR**（Network Detection and Response）は、いずれも**ネットワークセキュリティ**のカテゴリに属します。  
しかし、現代のセキュリティ環境、特に**TLS/SSLなどの暗号化が普及した環境**では、これらのソリューションが**本来の機能を十分に発揮しにくくなっています**。  
また、すでに **WAF**（Web Application Firewall）を導入している場合、  
「**IPSやNDRを追加で運用する必要があるのか？**」という疑問が生じます。

本記事では、**IPS・NDRの目的と限界**を整理し、WAFがある環境でIPS・NDRが本当に**必須なのか、あるいは不要なのか**について考察します。

![IPSとNDRの違い](https://blog.plura.io/cdn/column/ips_vs_ndr.jpg)

<!--more-->

---

## 1. **IPSとNDR：どのような役割か？**

### 💡 **基本的な定義**
- **IPS（侵入防御システム）**  
  - 主に**ネットワークの境界**に配置され、**リアルタイム**で**悪意のあるトラフィック**を遮断するデバイス。  
  - 主に**既知の攻撃パターン**や**ルールセット**（シグネチャ）に基づいて動作。  

- **NDR（ネットワーク検出・対応）**  
  - **ネットワーク内部**のトラフィックを監視・分析し、**機械学習・AI**を活用して**異常な動作**を検出。  
  - 従来のシグネチャベースの検知の限界を補い、**未知の**（new）脅威を発見することを目的とする。

### 🔑 **Webアプリケーションファイアウォール（WAF）との比較**
- **WAF**は**HTTP/HTTPSトラフィック**に特化したソリューションで、**Webアプリケーション**への攻撃（XSS、SQLインジェクション、ファイルアップロードの脆弱性攻撃など）を重点的に防御し、**アプリケーション層**を保護する。  
- 一方、**IPS・NDR**は**HTTP(S)以外のさまざまなプロトコル**（SMTP、FTP、SSH、RDP、DB接続など）までカバーすることを目的とするが、現代のネットワーク環境では**ほとんどの通信が暗号化**されているため、**ペイロード（データ本体）の解析が制限**されるという課題がある。

---

## 2. **暗号化されたパケット解析の現実的な限界**

### 🔒 **解析が不可能な領域**
- **HTTPS**や**SSH**など、パケットが**暗号化**されている場合、**IPS・NDR**はパケットの内容を直接解析することが困難です。  
- WAFはHTTPSを復号（SSLオフロードなど）して**Webリクエスト**を詳細に解析できますが、**SSH、RDP、VPN**などの通信はカバー範囲外となります。

### ⚠️ **SSL復号（Decryption）の負担**
- **IPS・NDRが適切に動作するためには、暗号化トラフィックを途中で復号する必要がありますが、以下の課題が発生します。**
  - **個人情報保護の問題**
  - **パフォーマンスの低下**
  - **コスト増加**
  - **証明書管理の複雑さ**
  
- 高リスクのWebトラフィックであれば復号の必要性はありますが、**SSHやRDPなど"そもそも暗号化を前提としたプロトコル"**では、  
  - **復号ソリューションを導入しても実用性が低く、実装コストが高い**という問題があります。

---

## 3. **それなら「すでにWAFがあるのに、IPS・NDRは本当に必要か？」**

1. **WAFはWeb層（HTTP/HTTPS）に対して非常に強力なセキュリティ対策**です。  
   - SQLインジェクション、XSS、ファイルアップロードの脆弱性などを**具体的なHTTPリクエスト**から検出できるため、  
     **アプリケーションセキュリティの観点では極めて効果的**です。

2. **IPS・NDRが対象とする「他のプロトコル」**（SSH、RDP、DB接続など）はほとんどが暗号化されており、  
   - **ペイロード（本文）の解析が不可能**であり、  
   - イベント発生時に適切な**ブロックや対応**を行うことが困難になる可能性があります。

3. **結論として、**
   - WAFでWebセキュリティをすでに確保している場合、  
   - **IPS・NDRが同じHTTPSを再復号して監視するのは「重複投資」**となり、  
   - SSHやRDPなどの他のプロトコルも**暗号化の影響で期待するほどの効果が得られない**可能性が高いです。

> 「それならホスト（サーバー）内部でセキュリティ対策を実施する**HIPS/EDR**のほうが適切」  
> → **暗号化が解除された時点**（実際のプロセス、ファイルシステム、メモリアクセス）を正確に監視・遮断できる。

---

## 4. **ホストベースのセキュリティが必要な理由**

### 🛡️ **ホストベースの方が有利な理由**
1. **暗号化トラフィックの内部解析が可能**  
   - ホスト（サーバー）内部では、最終的にデータが**復号された状態**で処理されます。  
   - **HIPS/EDR**はこの復号後のポイントを監視できるため、IPS・NDRの**暗号化解析の限界**を補うことができます。

2. **ネットワークのパフォーマンス低下を防ぐ**  
   - ネットワーク機器側でSSL復号を行わなくてもよいため、**パフォーマンス負荷**や**個人情報保護の問題**を大幅に軽減できます。

3. **包括的な動作分析が可能**  
   - プロセスの挙動、ファイルI/O、メモリアクセス、レジストリ改ざんなど、**OSレベルでの動作**を監視し、  
     **実際の攻撃をより確実に検出・阻止**できます。

---

## 5. **結論: IPS・NDRは「導入すべきか、しなくてもよいか？」**

1. **すでにWAFを導入している場合**  
   - Webベースの攻撃（HTTP/HTTPS）は**WAF**で十分に防御できます。  
   - 他の暗号化トラフィック（SSH、RDPなど）を**IPS・NDR**が解析しようとしても、**実際のデータは見えない**ため、  
     **防御効果が低い**、もしくは**誤検知・過検知**が頻発する可能性があります。

2. **セキュリティ投資を最適化するなら**  
   - 「**IPS・NDRでSSL復号**」するより、**ホスト内部（サーバー・PC）にHIPS/EDRを適用**するほうが、  
     **実質的なセキュリティ効果が高い**という意見が多いです。  
   - ネットワークレベルで防げない攻撃も、ホスト内部では**復号済みの状態**で監視・阻止できます。

3. **「IPS・NDRは必須なのか？」**  
   - 一部の高度な**NDR**ソリューションは、行動分析や**AI検知**を活用し**差別化**を図っていますが、  
     **暗号化通信の根本的な制約**は依然として残ります。  
   - そのため、**「WAF + ホストベースのセキュリティ」**という組み合わせだけでも、実用的な防御力を確保できる可能性が高く、  
     IPS・NDRの追加導入は、「ステアリングホイールカバー」のように**好みの問題**や**特定の特殊用途**に近いという意見もあります。

---

## ✅ **最終まとめ**
1. **WAF**はWebトラフィックの防御に特化しており、**HTTP/HTTPS**の攻撃（アプリケーションレベル）を効果的にブロックできます。  
2. **IPS・NDR**はWeb以外のプロトコルもカバーしようとしますが、**暗号化**の影響でペイロードの解析が難しく、**限定的な効果**にとどまることが多いです。  
3. 予算や運用リソースが限られている場合、**ホストベースのセキュリティ**（EDR、HIPS）の方がより実質的な防御を提供できます。  
4. そのため、「**すでにWAFがあるのに、IPS・NDRは本当に必要か？**」という問いに対しては、  
   - **暗号化環境**ではIPS・NDRの有効性が大幅に低下するため、  
   - **WAF + ホストベースのセキュリティ**を優先的に導入する方が**より合理的**な選択となる可能性があります。

> **結論として、IPS・NDRは必ずしも必要不可欠ではありません。**  
> すでに**WAF**がWeb領域の攻撃を防ぎ、**ホストセキュリティ**が内部の挙動を監視・阻止できるのであれば、  
> **IPS・NDRの追加運用は、実質的なセキュリティ強化ではなく、重複投資や過剰なシステム構成になる可能性があります。**
