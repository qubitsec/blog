---  
title: "RAM ã«ã‚ã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç‹™ã† â€“ T1003.001: LSASS ãƒ¡ãƒ¢ãƒª ãƒ€ãƒ³ãƒ—æ”»æ’ƒ"  
date: 2025-06-20  
draft: false  
description: "T1003.001 æŠ€æ³•ï¼ˆLSASS ãƒ¡ãƒ¢ãƒª ãƒ€ãƒ³ãƒ—ï¼‰ã‚’åˆ©ç”¨ã—ãŸè³‡æ ¼æƒ…å ±ç›—é›£æ–¹æ³•ã¨ Eventâ€¯ID ã«åŸºã¥ãæ¤œå‡ºã€LSASSâ€¯PPLã€Credentialâ€¯Guard ãªã©ã®å¯¾ç­–æˆ¦ç•¥ã‚’ã¾ã¨ã‚ã¾ã™ã€‚"  
featured_image: "cdn/respond/attck-T1003-os-credential-dumping.png"  
tags: ["MITREâ€¯ATT&CK", "T1003.001", "LSASSâ€¯Memory", "Credentialâ€¯Dumping", "RAMâ€¯æ”»æ’ƒ", "EDR", "PLURAâ€‘XDR", "ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£"]  
---

> **è¦ç´„ 3è¡Œ**  
> 1ï¸âƒ£ æ”»æ’ƒè€…ã¯ `lsass.exe` ã®ãƒ¡ãƒ¢ãƒªã‚’ãƒ€ãƒ³ãƒ—ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ ãƒãƒƒã‚·ãƒ¥ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç›—ã¿å–ã‚Šã¾ã™ã€‚  
> 2ï¸âƒ£ Eventâ€¯IDâ€¯4656/10 ãªã©ã®ãƒ—ãƒ­ã‚»ã‚¹-ãƒãƒ³ãƒ‰ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã§æ¤œå‡ºå¯èƒ½ã§ã™ã€‚  
> 3ï¸âƒ£ **LSASSâ€¯PPL + Credentialâ€¯Guard + ASR ãƒ«ãƒ¼ãƒ«** ã«ã‚ˆã£ã¦äº‹å‰ã«é˜»æ­¢ã—ã¦ãã ã•ã„ã€‚

![ATT&CK ã‚¢ã‚¤ã‚³ãƒ³ã¨ LSASS ãƒ¡ãƒ¢ãƒª ãƒ€ãƒ³ãƒ— æ¦‚è¦](https://blog.plura.io/cdn/respond/attck-T1003-os-credential-dumping.png)

<!--more-->

## ğŸ” é–¢é€£ MITREâ€¯ATT&CK æŠ€æ³•

| ID            | åå‰ | ä¸»ãªå†…å®¹ |
|--------------|------|----------|
| **T1003.001** | **OS Credential Dumping: LSASS Memory** | `lsass.exe` ãƒ—ãƒ­ã‚»ã‚¹ãƒ¡ãƒ¢ãƒªã‚’ãƒ€ãƒ³ãƒ—ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ ãƒãƒƒã‚·ãƒ¥ã‚„ Kerberos ãƒã‚±ãƒƒãƒˆãªã©ã‚’æŠ½å‡º |
| **T1560.001** | Archive Collected Data: `.zip` | ç›—ã‚“ã ãƒãƒƒã‚·ãƒ¥ã‚’ ZIP ã«åœ§ç¸®â€¢æš—å·åŒ–ã—ã¦å¤–éƒ¨ã«æŒã¡å‡ºã— |
| **T1078**     | Valid Accounts | ãƒ€ãƒ³ãƒ—ã—ãŸãƒãƒƒã‚·ãƒ¥ã‚’å†åˆ©ç”¨ã—ã€ãƒ©ãƒ†ãƒ©ãƒ«ç§»å‹•ï¼ˆæ°´å¹³ç§»å‹•ï¼‰ |

> ğŸ“Œ **ãªãœ LSASS ãªã®ã‹ï¼Ÿ**  
> LSASSï¼ˆLocalâ€¯Securityâ€¯Authorityâ€¯SubSystemï¼‰ã¯ãƒ­ã‚°ã‚¤ãƒ³ã‚„ SSO ã®è³‡æ ¼æƒ…å ±ã‚’ãƒ¡ãƒ¢ãƒªã«å¹³æ–‡ã¾ãŸã¯ãƒãƒƒã‚·ãƒ¥å½¢å¼ã§ä¿æŒã—ã¾ã™ã€‚SYSTEM æ¨©é™ã‚’å¾—ã‚Œã°ã€ã‚³ã‚¹ãƒˆ <= ãƒªã‚¿ãƒ¼ãƒ³ ã®æ”»æ’ƒæ§‹é€ ãŒæˆç«‹ã—ã¾ã™ã€‚

---

## ğŸ§‘â€ğŸ’» æ”»æ’ƒãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆä¾‹ï¼‰

1. **æ¨©é™æ˜‡æ ¼** â€“ `CVEâ€‘2022â€‘24521` ãªã©ã®ã‚«ãƒ¼ãƒãƒ«è„†å¼±æ€§ã‚„ DACL èª¤è¨­å®šã‚’åˆ©ç”¨ã—ã¦ SYSTEM æ¨©é™ã‚’å–å¾—  
2. **ãƒ¡ãƒ¢ãƒª ãƒ€ãƒ³ãƒ—**  
   ```powershell
   procdump.exe -accepteula -ma lsass.exe lsass.dmp   # Sysinternals ä½¿ç”¨
   rundll32.exe C:\windows\system32\comsvcs.dll, MiniDump  # LOLBINS æŠ€æ³•
    ```
3. **ã‚¯ãƒ©ãƒƒã‚¯** â€“â€¯Mimikatz sekurlsa::minidump lsass.dmp  
4. **å†åˆ©ç”¨** â€“â€¯psexec /hashes:<NTLM> ã§ SMB ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯  

## ğŸ›  æ¤œå‡ºãƒã‚¤ãƒ³ãƒˆ

| ãƒ­ã‚°ã‚½ãƒ¼ã‚¹              | ã‚¤ãƒ™ãƒ³ãƒˆ ID                                | æ„å‘³                                              |
|----------------------|------------------------------------------|---------------------------------------------------|
| **Windows Security** | **4656**ï¼ˆç‰¹æ¨©ãƒ—ãƒ­ã‚»ã‚¹ãƒãƒ³ãƒ‰ãƒ«è¦æ±‚ï¼‰           | ProcessName: lsass.exe ã«å¯¾ã—ã¦ GrantedAccess: 0x40 |
| **Sysmon**           | **10**                                    | lsass.exe ã«å¯¾ã™ã‚‹ **PROCESS_ACCESS** ã®ç™ºç”Ÿ        |
| **ETW**              | Microsoftâ€‘Windowsâ€‘Kernelâ€‘Process/4674     | HANDLE_DUPLICATE â†’ ãƒãƒ³ãƒ‰ãƒ«è¤‡è£½ã®è©¦è¡Œ                  |

> ğŸ¯ **ãƒ’ãƒ³ãƒˆ** â€“Â ã€ŒTargetImage contains lsass.exeâ€¯ANDâ€¯CallTrace not containsâ€¯\Windows\System32\lsass.exeã€ã®æ¡ä»¶ã§èª¤æ¤œå‡ºã‚’æœ€å°åŒ–

## ğŸ›¡ å¯¾å¿œãƒ»é®æ–­æˆ¦ç•¥

| å¯¾ç­–                                     | ã‚³ãƒãƒ³ãƒ‰/ãƒ‘ã‚¹                                                                 | èª¬æ˜                                  |
|----------------------------------------|-----------------------------------------------------------------------------|--------------------------------------|
| **LSASSâ€¯PPL**ï¼ˆProtected Process Lightï¼‰ | reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v RunAsPPL /t REG_DWORD /d 1 /f | ç½²åæ¸ˆã¿ãƒ‰ãƒ©ã‚¤ãƒãŒãªã‘ã‚Œã°ãƒãƒ³ãƒ‰ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’é®æ–­ |
| **Credential Guard**                  | Windows Features â†’ Device Guard â†’ Enable                                   | ä»®æƒ³åŒ–ãƒ™ãƒ¼ã‚¹ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆVBSï¼‰ã§èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’åˆ†é›¢ |
| **ASR ãƒ«ãƒ¼ãƒ«**                          | Block credential stealing from LSASS <br>GUID: 9E6B...                     | Microsoft Defender for Endpoint ã«é©ç”¨ |
| **PLURAâ€‘XDR**                         | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒãƒ³ãƒ‰ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°è¨˜éŒ² + MITRE ãƒãƒƒãƒ”ãƒ³ã‚°                                  | EVENT 10 â†’ è‡ªå‹•é®æ–­ & KQL æ¤œç´¢å¯¾å¿œ    |

```powershell
# LSASS PPL æœ‰åŠ¹åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆWindows 10 20H2+ï¼‰
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v "RunAsPPL" /t REG_DWORD /d 1 /f
Write-Output "[+] LSASS ãŒ Protected Process Light ãƒ¢ãƒ¼ãƒ‰ã«ç§»è¡Œã—ã¾ã—ãŸã€‚"
```
> â˜¢ **æ³¨æ„**â€¯: Registry ã‚’å¤‰æ›´ã™ã‚‹å‰ã«ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®äº’æ›æ€§ç¢ºèªãŒå¿…é ˆã§ã™ã€‚

## ğŸ“š å®Ÿä¾‹ã¨æ•™è¨“

| å¹´       | ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³           | LSASS é–¢é€£æ€§ãƒ»ç¤ºå”†                                       |
|--------|--------------------|--------------------------------------------------------|
| **2022** | **HermeticWiper** | ãƒ‡ã‚£ã‚¹ã‚¯ç ´å£Šã®å‰ã« LSASS ãƒ¡ãƒ¢ãƒªã‚„ãƒªã‚«ãƒãƒªã‚»ã‚¯ã‚¿ã«ç—•è·¡ã‚’æ®‹ã—ã€å¾©å…ƒã‚’å¦¨å®³ |
| **2017** | **NotPetya**      | WMIãƒ»PSExec ã§ã®æ‹¡æ•£æ™‚ã«ç›—ã¾ã‚ŒãŸãƒãƒƒã‚·ãƒ¥ã‚’å†åˆ©ç”¨ â†’ åºƒç¯„ãªãƒ©ãƒ†ãƒ©ãƒ«ãƒ ãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆç™ºç”Ÿ |
| **2019** | **LockerGoga**    | é«˜é€Ÿæš—å·åŒ–ã¨ä¸¦è¡Œã—ã¦ LSASS ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒãƒƒã‚·ãƒ¥ã‚’ç›—ã‚“ã§æ„ŸæŸ“ç¯„å›²ã‚’æ‹¡å¤§ |

## âš– å…è²¬äº‹é …

æœ¬è¨˜äº‹ã¯æ•™è‚²ãƒ»ç ”ç©¶ç›®çš„ã§æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚é‹ç”¨ç’°å¢ƒã«è¨­å®šã‚’é©ç”¨ã™ã‚‹å‰ã« **å°‚é–€å®¶ã«ç›¸è«‡**ã—ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŠã‚ˆã³ãƒ†ã‚¹ãƒˆæ‰‹é †ã‚’é †å®ˆã—ã¦ãã ã•ã„ã€‚æ”»æ’ƒã‚°ãƒ«ãƒ¼ãƒ—ã‚„ã‚µãƒ³ãƒ—ãƒ«ã«ã‚ˆã£ã¦æŒ™å‹•ãŒç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

## ğŸ”š çµè«–

* **lsass.exe ã®ãƒ¡ãƒ¢ãƒª**ã¯ã€Œã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚­ãƒ¼ã€ã§ã™ã€‚ç®¡ç†è€…ã¯ *EVENT ID â†’ LSASS PPL â†’ Credential Guard* ã®3ã‚¹ãƒ†ãƒƒãƒ—ã‚’å¿…ãšå®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚  
* **æ”»æ’ƒã‚ˆã‚Šå…ˆã«æ¤œçŸ¥ãŒå¿…è¦**ã§ã™ã€‚EDR / SIEM ã«è©³ç´°ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡ã—ã€MITRE ATT&CK ã«åŸºã¥ããƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ä½“åˆ¶ã‚’æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†ã€‚  
* **PLURAâ€‘XDR** ã¯ LSASS ãƒãƒ³ãƒ‰ãƒ«è¦æ±‚ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«å¯è¦–åŒ–ã—ã€é®æ–­ãƒãƒªã‚·ãƒ¼ã‚’è‡ªå‹•åŒ–ã—ã¦è¢«å®³ç¯„å›²ã‚’æœ€å°åŒ–ã—ã¾ã™ã€‚

> *Protect Process, Protect Credentials, Protect Enterprise.*


