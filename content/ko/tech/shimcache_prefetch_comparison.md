---
date: 2026-01-24T09:00:00
draft: false
title: "Sysmon â†’ Prefetch â†’ ShimCache â†’ Amcache: ì‹¤í–‰ ì²´ì¸ ë³µì› ì‹¤ë¬´ ê°€ì´ë“œ (LOLBAS ë¡œê·¸ ì—°ê³„ í¬í•¨)"
description: "Sysmon Event ID 1ì„ ì¶œë°œì ìœ¼ë¡œ PrefetchÂ·ShimCacheÂ·Amcacheë¥¼ êµì°¨í•´ â€˜ì‹¤í–‰ ì—¬ë¶€â€™ì—ì„œ â€˜ì‹¤í–‰ ì²´ì¸(Execution Chain)â€™ê¹Œì§€ ë³µì›í•˜ëŠ” ì‹¤ë¬´ íë¦„ì„ ì •ë¦¬í•©ë‹ˆë‹¤. (LOLBAS ë¡œê·¸ ì—°ê³„ í¬í•¨)"
featured_image: "cdn/tech/shimcache_prefetch_comparison.png"
tags: ["Digital Forensics", "Sysmon", "Prefetch", "ShimCache", "Amcache", "Windows Event Log", "LOLBAS", "ì¹¨í•´ ì‚¬ê³  ë¶„ì„", "Execution Chain", "ì§€ì†ì„±(Persistence)"]
---

ğŸ“Œ **ì´ ê¸€ì˜ ëª©í‘œëŠ” í•˜ë‚˜ì…ë‹ˆë‹¤.**  
â€œì•…ì„± íŒŒì¼ì´ ì‹¤í–‰ëëŠ”ê°€?â€ì—ì„œ ëë‚´ì§€ ì•Šê³ , í•œ ë‹¨ê³„ ë” ë“¤ì–´ê°€ì„œ  
âœ… **â€œëˆ„ê°€(ë¶€ëª¨) â†’ ë¬´ì—‡ì„(ìì‹) â†’ ì–´ë–¤ ì¸ì(CommandLine)ë¡œ â†’ ì–¸ì œ ì‹¤í–‰í–ˆê³ , ê·¸ ë‹¤ìŒì— ë­˜ í–ˆë‚˜?â€**  
ì¦‰ **ì‹¤í–‰ ì²´ì¸**(Execution Chain)ì„ **ë³´ê³ ì„œë¡œ í”ë“¤ë¦¬ì§€ ì•Šê²Œ** ë³µì›í•˜ëŠ” ê²ë‹ˆë‹¤.

---

## 0) ì™œ ì´ ìˆœì„œê°€ ì œì¼ ì¹œì ˆí•œê°€ìš”?

ì¹¨í•´ì‚¬ê³  ë¶„ì„ì€ ë³´í†µ ì´ë ‡ê²Œ ì‹œì‘í•©ë‹ˆë‹¤.

- â€œì´ìƒí•œ ì‹¤í–‰ì´ ìˆì—ˆë˜ ê²ƒ ê°™ì€ë°ìš”â€¦â€
- â€œì´ íŒŒì¼ì´ ì•…ì„± ê°™ì€ë° ì‹¤í–‰ëë‚˜ìš”?â€
- â€œEDRì´ ì—†ê±°ë‚˜ ë¡œê·¸ê°€ ì¤‘ê°„ì— ëŠê²¼ì–´ìš”â€¦â€

ì´ëŸ´ ë•Œ **ê°€ì¥ ëœ í—¤ë§¤ëŠ” ìˆœì„œ**ê°€ ìˆìŠµë‹ˆë‹¤.

1) **Sysmon Event ID 1**: ì‹¤í–‰ ì²´ì¸ì˜ ë¼ˆëŒ€(ë¶€ëª¨-ìì‹-ì»¤ë§¨ë“œë¼ì¸-í•´ì‹œ)  
2) **Prefetch**: â€œì§„ì§œ ì‹¤í–‰ë¨â€ì„ ê°€ì¥ ì§ê´€ì ìœ¼ë¡œ í™•ì¦  
3) **ShimCache**: ì‹¤í–‰ì´ ì• ë§¤í•´ë„ â€œê·¸ íŒŒì¼ì´ ê·¸ ê²½ë¡œì— ìˆì—ˆë‹¤â€ë¥¼ ê³ ì •  
4) **Amcache**: íŒŒì¼ëª…ì´ ë°”ë€Œì–´ë„ â€œì´ê²Œ ê·¸ íŒŒì¼â€ì„ì„(ë©”íƒ€/í•´ì‹œ) í™•ì •  
5) (ìˆìœ¼ë©´) **PowerShell/Task/WMI ë¡œê·¸**ë¡œ LOLBASÂ·ì§€ì†ì„±ê¹Œì§€ ì—°ê²°  
6) ë§ˆì§€ë§‰ì— **ë³´ê³ ì„œ**: ì‹œê°„/ê²½ë¡œ/ë™ì¼ì„±/ì²´ì¸ ê·¼ê±°ë¥¼ ì„¸íŠ¸ë¡œ ì œì‹œ

---

## 1) ì‹¤í–‰ ì²´ì¸ ë³µì› íë¦„ë„ (Sysmon 1ë²ˆë¶€í„° ë³´ê³ ì„œê¹Œì§€ ì­‰)

**Sysmon 1ë²ˆ â†’ ë³´ê³ ì„œ**ë¡œ â€œëŠê¸°ì§€ ì•Šê²Œâ€ í•œ ì¥ìœ¼ë¡œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.

```mermaid
flowchart TD
  A[ë¶„ì„ ì‹œì‘] --> B{Sysmon Event ID 1 ë¡œê·¸ ìˆìŒ}

  B -->|Yes| C[Sysmon ID 1ë¡œ ë¼ˆëŒ€ ê³ ì •]
  B -->|No| C2[Sysmon ëˆ„ë½ ê°€ì •]

  C --> D[Prefetch í™•ì¸]
  C2 --> D

  D --> E{Prefetch pf ì¡´ì¬}
  E -->|Yes| F[ì‹¤í–‰ í™•ì •]
  E -->|No| F2[Prefetch ë¶€ì¬ ê°€ëŠ¥ì„±]

  F --> G[ShimCache í™•ì¸]
  F2 --> G

  G --> H[Amcache í™•ì¸]

  H --> I{ì¶”ê°€ ë¡œê·¸ë¡œ í™•ì¥ ê°€ëŠ¥}
  I -->|Yes| J[PowerShell Task WMI 4688 ì—°ê³„]
  I -->|No| K[ì•„í‹°íŒ©íŠ¸ êµì°¨ë¡œ ìµœì†Œ ë³µì›]

  J --> L[ì§€ì†ì„± ì ê²€]
  K --> L

  L --> M[íƒ€ì„ë¼ì¸ ì •ë¦¬]
  M --> N[ë³´ê³ ì„œ ì‘ì„±\nì²´ì¸ ì‹œê°„ ê²½ë¡œ ë™ì¼ì„±]
```

---

## 2) 1ë²ˆ(Sysmon Event ID 1)ë¶€í„° ë³´ëŠ” ì´ìœ : â€œì‹¤í–‰ ì²´ì¸ì˜ ì²™ì¶”â€ë¥¼ ë¨¼ì € ì„¸ìš°ê¸°

Sysmon **Event ID 1**(Process Create)ëŠ” ë§ ê·¸ëŒ€ë¡œ  
â€œ**í”„ë¡œì„¸ìŠ¤ê°€ ìƒì„±(ì‹¤í–‰)ëœ ìˆœê°„**â€ì„ ê¸°ë¡í•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê±´, Sysmonì´ ìˆìœ¼ë©´ **ì‹¤í–‰ ì²´ì¸ì„ â€œì‚¬ëŒ ê°â€ì´ ì•„ë‹ˆë¼ â€œê·¼ê±°â€ë¡œ** ë¬¶ì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ì—ìš”.

### âœ… Sysmon ID 1ì—ì„œ íŠ¹íˆ ì¤‘ìš”í•œ í•„ë“œ

* **ParentImage**: â€œëˆ„ê°€ ì´ê±¸ ì‹¤í–‰ì‹œì¼°ë‚˜?â€
* **Image**: â€œë¬´ì—‡ì´ ì‹¤í–‰ëë‚˜(ì •í™•í•œ ê²½ë¡œ)?â€
* **CommandLine**: â€œì–´ë–¤ ì¸ìë¡œ ì‹¤í–‰ëë‚˜?â€ (LOLBASì—ì„œ ê±°ì˜ í•µì‹¬)
* **Hashes**: â€œì´ íŒŒì¼ì´ ì§„ì§œ ê·¸ íŒŒì¼ ë§ë‚˜?â€ (ë™ì¼ì„± í™•ì •)
* **Time**: íƒ€ì„ë¼ì¸ì˜ ê¸°ì¤€ì 

ğŸ“Œ í•œ ì¤„ ìš”ì•½

> **Sysmon 1ë²ˆì€ â€˜ì²´ì¸â€™ì„ ë§Œë“¤ê³ ,  
> Prefetch/ShimCache/AmcacheëŠ” ê·¸ ì²´ì¸ì„ â€˜í”ë“¤ë¦¬ì§€ ì•Šê²Œâ€™ ê³ ì •í•©ë‹ˆë‹¤.**

---

## 3) 2ë²ˆ(Prefetch)ì„ ë¶™ì´ëŠ” ì´ìœ : â€œì‹¤í–‰ëë‹¤â€ë¥¼ ê°€ì¥ ì§ê´€ì ìœ¼ë¡œ í™•ì¦

PrefetchëŠ” ì›ë˜ **ì‹¤í–‰ ì†ë„ ìµœì í™”** ê¸°ëŠ¥ì´ì§€ë§Œ, í¬ë Œì‹ì—ì„œëŠ” ë‹¨ìˆœí•©ë‹ˆë‹¤.

> `.pf`ê°€ ë‚¨ì•„ìˆë‹¤ë©´, **ê·¸ í”„ë¡œê·¸ë¨ì€ ì‹¤í–‰ëœ ì ì´ ìˆì„ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤.**

### âœ… Prefetchê°€ ì£¼ëŠ” ì‹¤ë¬´í˜• ì¦ê±° 3ì¢…

* **ì‹¤í–‰ ì‹œê°„(Last Run Time)**: â€œì–¸ì œ ì‹¤í–‰ëë‚˜?â€
* **ì‹¤í–‰ íšŸìˆ˜(Run Count)**: â€œëª‡ ë²ˆ ì‹¤í–‰ëë‚˜?â€
* **ì°¸ì¡° í”ì (ë¡œë“œ/ì ‘ê·¼ íŒŒì¼ ê²½ë¡œ)**: â€œì‹¤í–‰í•˜ë©´ì„œ ë¬´ì—‡ì„ ë§Œì¡Œë‚˜?â€

### â— Prefetch ë‹¨ë…ìœ¼ë¡œ ëë‚´ë©´ ì•„ì‰¬ìš´ ì´ìœ 

PrefetchëŠ” â€œì‹¤í–‰â€ì€ ê°•í•˜ì§€ë§Œ,

* â€œëˆ„ê°€ ì‹¤í–‰í–ˆëŠ”ì§€(ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤)â€
* â€œì •í™•í•œ ì»¤ë§¨ë“œë¼ì¸â€  
  ì„ **ì™„ë²½í•˜ê²Œ ë³µì›í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤.**

ê·¸ë˜ì„œ **Sysmon(ë¶€ëª¨/ì»¤ë§¨ë“œ) â†” Prefetch(ì‹¤í–‰ í™•ì¦/ì‹œê°„/íšŸìˆ˜)** ì¡°í•©ì´ ì œì¼ ì•ˆì •ì ì…ë‹ˆë‹¤.

---

## 4) 3ë²ˆ(ShimCache)ì„ ë³´ëŠ” ì´ìœ : â€œê·¸ íŒŒì¼ì´ ê·¸ ê²½ë¡œì— ìˆì—ˆë˜ ê±´ í™•ì‹¤â€ë¡œ ê³ ì •

ê³µê²©ìëŠ” í”íˆ ì´ëŸ° ê±¸ í•©ë‹ˆë‹¤.

* ì‹¤í–‰ í›„ **self-delete**
* íŒŒì¼ ì´ë™/ì´ë¦„ ë³€ê²½
* í”ì  ì‚­ì œ ì‹œë„

ì´ë•Œ ShimCache(AppCompatCache)ëŠ” â€œì‹¤í–‰ ì—¬ë¶€â€ë³´ë‹¤ë„ ë¨¼ì €,  
âœ… â€œ**ê·¸ íŒŒì¼ì´ ì‹œìŠ¤í…œì— ì¡´ì¬í–ˆì—ˆë‹¤**(ê²½ë¡œ í¬í•¨)â€ë¥¼ ê³ ì •í•˜ëŠ” ë° ê°•í•©ë‹ˆë‹¤.

### âŒ ShimCacheì—ì„œ ìì£¼ í•˜ëŠ” ì˜¤í•´(ì¤‘ìš”)

* ShimCacheì˜ íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” ë³´í†µ **â€˜ì‹¤í–‰ ì‹œê°â€™ì´ ì•„ë‹ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**  
  (í™˜ê²½ì— ë”°ë¼ â€œíŒŒì¼ ë§ˆì§€ë§‰ ìˆ˜ì • ì‹œê°„ ì„±ê²©â€ ë“±ìœ¼ë¡œ í•´ì„í•˜ëŠ” ê²ƒì´ ë” ì•ˆì „í•œ ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.)
* ë”°ë¼ì„œ ShimCacheë§Œìœ¼ë¡œ â€œì´ ì‹œê°„ì— ì‹¤í–‰ëë‹¤â€ë¼ê³  ë‹¨ì •í•˜ë©´ **íƒ€ì„ë¼ì¸ì´ í‹€ì–´ì§ˆ ìˆ˜ ìˆì–´ìš”.**

ğŸ“Œ ShimCacheëŠ” ì´ë ‡ê²Œ ì“°ë©´ ë”± ì¢‹ì•„ìš”

> **Prefetch/Sysmonìœ¼ë¡œ ì‹¤í–‰ì„ ì¡ê³ **,  
> **ShimCacheë¡œ ì¡´ì¬/ê²½ë¡œë¥¼ ëª» ë°•ëŠ”ë‹¤**.

---

## 5) 4ë²ˆ(Amcache)ì„ ë§ˆì§€ë§‰ì— ë¶™ì´ëŠ” ì´ìœ : â€œì´ê²Œ ê·¸ íŒŒì¼â€ì„ì„ í™•ì •í•˜ê¸°

AmcacheëŠ” ê²½ìš°ì— ë”°ë¼ **ê²°ì •íƒ€**ê°€ ë©ë‹ˆë‹¤.

* íŒŒì¼ëª…ì´ ë°”ë€Œì—ˆì–´ë„
* ê²½ë¡œê°€ ì´ë™í–ˆì–´ë„
* ì›ë³¸ì´ ì‚­ì œëì–´ë„

Amcacheì— ë‚¨ëŠ” **ì‹ë³„ ì •ë³´**(ë©”íƒ€/í•´ì‹œ ë“±)ë¡œ  
âœ… â€œë™ì¼ íŒŒì¼â€ ì—¬ë¶€ë¥¼ í›¨ì”¬ ê°•í•˜ê²Œ ì£¼ì¥í•  ìˆ˜ ìˆì–´ìš”.

### âœ… Amcacheê°€ íŠ¹íˆ ë¹›ë‚˜ëŠ” ìƒí™©

* IOC(í•´ì‹œ)ë¡œ **ë™ì¼ íŒŒì¼ ì—¬ë¶€ë¥¼ í™•ì •**í•´ì•¼ í•  ë•Œ
* ì •ìƒ íŒŒì¼ë¡œ ìœ„ì¥í–ˆì§€ë§Œ ë©”íƒ€/ì‹ë³„ ì •ë³´ë¡œ **ê±°ì§“ë§ì„ ê¹¨ì•¼** í•  ë•Œ
* Prefetchê°€ ì—†ê±°ë‚˜ ì• ë§¤í•  ë•Œ **ë³´ê°• ê·¼ê±°**ê°€ í•„ìš”í•  ë•Œ

---

## 6) í•œëˆˆì— ë¹„êµ: Sysmon Â· Prefetch Â· ShimCache Â· Amcache

| êµ¬ë¶„     | Sysmon (Event ID 1) | Prefetch        | ShimCache       | Amcache          |
| ------ | ------------------- | --------------- | --------------- | ---------------- |
| í•œ ì¤„ ì—­í•  | ì‹¤í–‰ ì²´ì¸ â€œë¼ˆëŒ€â€          | ì‹¤í–‰ â€œí™•ì¦â€         | ì¡´ì¬/ê²½ë¡œ â€œê³ ì •â€      | íŒŒì¼ â€œì •ì²´ í™•ì •â€       |
| ê°•ì      | ë¶€ëª¨/ìì‹, ì»¤ë§¨ë“œë¼ì¸, í•´ì‹œ    | ì‹¤í–‰ ì‹œê°„Â·íšŸìˆ˜, ì°¸ì¡° í”ì  | ì‚­ì œ/ì´ë™ í›„ì—ë„ ê²½ë¡œ í”ì  | ë©”íƒ€/ì‹ë³„ ì •ë³´ë¡œ ë™ì¼ì„±    |
| ì•½ì      | ì—†ì„ ìˆ˜ ìˆìŒ(ë¯¸ì„¤ì¹˜/ë³´ê´€ê¸°ê°„)   | ì—†ë‹¤ê³  ì‹¤í–‰ ì•ˆ í•œ ê±´ ì•„ë‹˜ | ì‹¤í–‰ ì‹œê°ìœ¼ë¡œ ì˜¤í•´ ìœ„í—˜   | í™˜ê²½/ìƒí™©ì— ë”°ë¼ ê°€ìš©ì„± í¸ì°¨ |
| ì‹¤ë¬´ í¬ì§€ì…˜ | ì‹œì‘ì (ê°€ëŠ¥í•˜ë©´ 1ìˆœìœ„)       | 2ìˆœìœ„ â€œì‹¤í–‰ í™•ì¸â€     | 3ìˆœìœ„ â€œì¡´ì¬ ê³ ì •â€     | 4ìˆœìœ„ â€œë™ì¼ì„± í™•ì •â€     |

---

## 7) ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì´í•´í•˜ê¸°: â€œì‹¤í–‰ í›„ ì‚­ì œâ€ ëŒ€ì‘

### ğŸ“Œ ì‹œë‚˜ë¦¬ì˜¤: ê³µê²©ìê°€ `malware.exe` ì‹¤í–‰ í›„ ì‚­ì œí•˜ê³  ë„ë§ê°

1. **Sysmon ID 1**ì´ ìˆìœ¼ë©´

* ì–´ë–¤ ë¶€ëª¨ê°€ ì‹¤í–‰í–ˆëŠ”ì§€(ParentImage)
* ì–´ë–¤ ì¸ìì˜€ëŠ”ì§€(CommandLine)
* ì–´ë–¤ í•´ì‹œì˜€ëŠ”ì§€(Hashes)  
  ê¹Œì§€ ë¼ˆëŒ€ë¥¼ ë°”ë¡œ ì„¸ì›ë‹ˆë‹¤.

2. **Prefetch**ë¡œ ê°•í™”

* `MALWARE.EXE-****.pf`ê°€ ë‚¨ì•„ìˆìœ¼ë©´ â€œì‹¤í–‰â€ì„ ê°•í•˜ê²Œ í™•ì¦
* ì‹¤í–‰ ì‹œê°„/íšŸìˆ˜ë¡œ **ë°˜ë³µ ì‹¤í–‰** ì—¬ë¶€ê¹Œì§€ ì¡ìŠµë‹ˆë‹¤.

3. **ShimCache**ë¡œ ëª» ë°•ê¸°

* `C:\Temp\malware.exe` ê°™ì€ ê²½ë¡œê°€ ë‚¨ì•„ ìˆìœ¼ë©´  
  â€œê·¸ ê²½ë¡œì— ì‹¤ì œë¡œ ì¡´ì¬í–ˆë‹¤â€ë¥¼ ê³ ì •í•©ë‹ˆë‹¤.

4. **Amcache**ë¡œ ë™ì¼ì„± í™•ì •

* íŒŒì¼ëª…ì´ ë°”ë€Œê±°ë‚˜ ê²½ë¡œê°€ ë°”ë€ í”ì ì´ ìˆì–´ë„  
  â€œê·¸ íŒŒì¼ì´ ë§ë‹¤â€ë¥¼ ì‹ë³„ ì •ë³´ë¡œ ë³´ê°•í•©ë‹ˆë‹¤.

---

## 8) (ë¡œê·¸ê°€ ìˆë‹¤ë©´ ìµœê°•) LOLBAS/ì§€ì†ì„±ê¹Œì§€ â€œì²´ì¸ í™•ì¥â€í•˜ê¸°

ì•„í‹°íŒ©íŠ¸ëŠ” ê°•ë ¥í•˜ì§€ë§Œ, **ë¡œê·¸ëŠ” ì²´ì¸ì„ ë” ê¸¸ê³  ì„ ëª…í•˜ê²Œ** ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.  
íŠ¹íˆ LOLBASëŠ” **CommandLineê³¼ ë¶€ëª¨-ìì‹ ê´€ê³„**ê°€ í•µì‹¬ì´ë¼, ë¡œê·¸ ì—°ê³„ê°€ íš¨ê³¼ê°€ í½ë‹ˆë‹¤.

### 8.1 ì•„í‹°íŒ©íŠ¸ì™€ â€œë°”ë¡œ ë¶™ì´ê¸° ì¢‹ì€â€ ë¡œê·¸ 5ê°œ (ì±„ë„ ê¸°ì¤€)

#### 1) Sysmon: Process Create

* **ì±„ë„**: `Applications and Services Logs > Microsoft > Windows > Sysmon > Operational`
* **ì£¼ìš” Event ID**: **1 (Process creation)**
* **ë¶™ì´ëŠ” ë°©ë²•**: `Image/CommandLine/Hashes` â†” Prefetch/ShimCache/Amcache êµì°¨

#### 2) ë³´ì•ˆ ë¡œê·¸: í”„ë¡œì„¸ìŠ¤ ìƒì„±(4688)

* **ì±„ë„**: `Windows Logs > Security`
* **ì£¼ìš” Event ID**: **4688**
* **í¬ì¸íŠ¸**: Sysmonì´ ì—†ì„ ë•Œ ìµœì†Œí•œì˜ â€œí”„ë¡œì„¸ìŠ¤ ìƒì„±â€ ê·¼ê±° í™•ë³´  
  (ì»¤ë§¨ë“œë¼ì¸ ë¡œê¹… ì •ì±… ì„¤ì • ì—¬ë¶€ê°€ í’ˆì§ˆì„ ì¢Œìš°í•©ë‹ˆë‹¤.)

#### 3) PowerShell: Script Block Logging(4104)

* **ì±„ë„**: `Microsoft > Windows > PowerShell > Operational`
* **ì£¼ìš” Event ID**: **4104**
* **í¬ì¸íŠ¸**: LOLBAS/ë‹¤ìš´ë¡œë“œ/ì‹¤í–‰ ê²½ë¡œê°€ ìŠ¤í¬ë¦½íŠ¸ì— ê·¸ëŒ€ë¡œ ë‚¨ëŠ” ê²½ìš°ê°€ ë§ì•„  
  â†’ ê·¸ ê²½ë¡œë¥¼ ShimCache/Amcacheì—ì„œ ì¡´ì¬/ìœ ì…ìœ¼ë¡œ ê³ ì •  
  â†’ ì‹¤í–‰ íŒŒì¼ì€ Prefetchë¡œ ì‹¤í–‰ í™•ì¦

#### 4) TaskScheduler: ì‘ì—… ê¸°ë°˜ ì‹¤í–‰

* **ì±„ë„**: `Microsoft > Windows > TaskScheduler > Operational`
* **ì˜ˆì‹œ Event ID**: **200/201** ë“±(í™˜ê²½ì— ë”°ë¼ ìƒì´)
* **í¬ì¸íŠ¸**: ì§€ì†ì„±(ìŠ¤ì¼€ì¤„ ì‘ì—…)ìœ¼ë¡œ â€œë‹¤ì‹œ ì‹¤í–‰ë˜ê²Œ ë§Œë“  íŠ¸ë¦¬ê±°â€ë¥¼ ì¡ê¸° ì¢‹ìŒ

#### 5) WMI Activity: WMI ê¸°ë°˜ ì‹¤í–‰/ì§€ì†ì„± ë‹¨ì„œ

* **ì±„ë„**: `Microsoft > Windows > WMI-Activity > Operational`
* **ëŒ€í‘œ Event ID ë¬¶ìŒ**: **5857~5861** ë“±(í™˜ê²½ì— ë”°ë¼ ìƒì´)
* **í¬ì¸íŠ¸**: WMIë¥¼ í†µí•œ ì‹¤í–‰/ì§€ì†ì„±ì€ í”ì ì´ â€œë¡œê·¸ ìª½â€ì— ë‚¨ëŠ” í¸ì´ë¼ ì—°ê²° ê°€ì¹˜ê°€ í¼

---

## 9) ë§ˆì§€ë§‰ í¼ì¦: â€œëˆ„ê°€ ë‹¤ì‹œ ì‚´ë ¸ëŠ”ê°€â€ (ì§€ì†ì„± íŠ¸ë¦¬ê±°)

ìµœì´ˆ ì‹¤í–‰ íŒŒì¼ê³¼ **ì¬ì‹¤í–‰(ì§€ì†ì„±) íŠ¸ë¦¬ê±°**ëŠ” ë‹¤ë¥¸ ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.  
ê·¸ë˜ì„œ ì‹¤í–‰ ì²´ì¸ì˜ ëì€ ë³´í†µ ì—¬ê¸°ë¡œ ê°‘ë‹ˆë‹¤.

* Scheduled Tasks (schtasks)
* Services (ì„œë¹„ìŠ¤ ë“±ë¡)
* WMI ì´ë²¤íŠ¸ êµ¬ë…(ì˜êµ¬ êµ¬ë…)

ğŸ“Œ ì‹¤ë¬´ íŒ

> â€œìµœì´ˆ ì‹¤í–‰(ì´ˆê¸° ì¹¨íˆ¬) ì²´ì¸â€ê³¼ â€œì¬ì‹¤í–‰(ì§€ì†ì„±) ì²´ì¸â€ì„ **ë¶„ë¦¬**í•´ì„œ ê·¸ë¦¬ë©´ ë³´ê³ ì„œê°€ í›¨ì”¬ ëª…í™•í•´ì§‘ë‹ˆë‹¤.

---

## 10) Prefetchê°€ ì—†ê±°ë‚˜ ì•½í•  ë•Œ: â€œì—†ë‹¤ = ì‹¤í–‰ ì•ˆ í–ˆë‹¤â€ ê¸ˆì§€

Prefetchê°€ ë¹„ì–´ ìˆì„ ìˆ˜ ìˆëŠ” ì´ìœ ëŠ” ê½¤ ë§ìŠµë‹ˆë‹¤.

* ì •ì±…/í™˜ê²½ìœ¼ë¡œ Prefetch ë¹„í™œì„±
* ì €ì¥ ê°œìˆ˜ ì œí•œìœ¼ë¡œ ë®ì–´ì“°ê¸°
* ê³µê²©ì ì‚­ì œ
* ì„œë²„/íŠ¹ìˆ˜ êµ¬ì„±

ê·¸ë˜ì„œ Prefetchê°€ ì—†ìœ¼ë©´,

* ShimCache/Amcacheë¡œ ì¡´ì¬Â·ì •ì²´ë¥¼ ë³´ê°•í•˜ê³ 
* (ê°€ëŠ¥í•˜ë©´) ì´ë²¤íŠ¸ ë¡œê·¸ë¡œ ì‹¤í–‰ì„ ë³´ê°•í•˜ê³ 
* ê·¸ë˜ë„ ë¶€ì¡±í•˜ë©´ MFT/USN ê°™ì€ íŒŒì¼ì‹œìŠ¤í…œ ë ˆë²¨ë¡œ í™•ì¥í•©ë‹ˆë‹¤.

---

## 11) ë³´ê³ ì„œì— ì´ë ‡ê²Œ ì“°ë©´ í”ë“¤ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤ (ê·¼ê±° ì„¸íŠ¸)

ë³´ê³ ì„œì—ì„œ ê°€ì¥ í”ë“¤ë¦¬ëŠ” ìˆœê°„ì€ ì´ê±°ì˜ˆìš”.

* â€œì‹¤í–‰ëœ ê²ƒ ê°™ì•„ìš”â€ â†’ ê·¼ê±°ê°€ ì•½í•˜ë©´ ë°”ë¡œ ë°˜ë°•ë‹¹í•¨
* â€œì•…ì„± ë§ì•„ìš”â€ â†’ ë™ì¼ì„±(í•´ì‹œ/ì‹ë³„)ì´ ì—†ìœ¼ë©´ ë…¼ìŸìœ¼ë¡œ ë²ˆì§

ê·¸ë˜ì„œ ë³´ê³ ì„œ ë¬¸ì¥ì€ ê°€ëŠ¥í•˜ë©´ **ì„¸íŠ¸ë¡œ** ì”ë‹ˆë‹¤.

* **ì²´ì¸**: Parent â†’ Child
* **ì‹œê°„**: ì‹¤í–‰ ì‹œê°„(ë¡œê·¸/Prefetch)
* **ê²½ë¡œ**: Full Path(ì•„í‹°íŒ©íŠ¸ êµì°¨)
* **ë™ì¼ì„±**: Hash/ì‹ë³„(ê°€ëŠ¥í•˜ë©´ Amcache/Sysmon)

ì˜ˆì‹œ ë¬¸ì¥(í…œí”Œë¦¿)

> (ì‹œê°„) (ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤)ê°€ (ì»¤ë§¨ë“œë¼ì¸)ìœ¼ë¡œ (ìì‹ í”„ë¡œì„¸ìŠ¤)ë¥¼ ì‹¤í–‰í–ˆìœ¼ë©°,  
> Prefetchì—ì„œ ì‹¤í–‰ í”ì (íšŸìˆ˜/ì‹œê°„)ì´ í™•ì¸ë˜ê³ , ShimCacheì—ì„œ í•´ë‹¹ ê²½ë¡œ ì¡´ì¬ê°€ í™•ì¸ë˜ë©°,  
> Amcache/Sysmon í•´ì‹œë¡œ ë™ì¼ íŒŒì¼ì„ì„ êµì°¨ ê²€ì¦í–ˆë‹¤.  

---

## 12) í˜„ì¥ì—ì„œ ë°”ë¡œ ì“°ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸ (10ë¬¸ 10ë‹µ)

Q1. **ì§€ê¸ˆ ë‚´ê°€ ì¡ì€ ë‹¨ì„œëŠ” â€œì‹¤í–‰(ë¡œê·¸)â€ì¸ê°€ â€œíŒŒì¼(ì•„í‹°íŒ©íŠ¸)â€ì¸ê°€?**  
â†’ ì‹œì‘ì ì„ ì •í•´ì•¼ ì‚½ì§ˆì´ ì¤„ì–´ë“­ë‹ˆë‹¤. ë¡œê·¸ë©´ Sysmonë¶€í„°, íŒŒì¼ì´ë©´ Prefetch/ShimCacheë¶€í„°.

2ï¸âƒ£ **ëˆ„ê°€ ì‹¤í–‰í–ˆë‚˜(ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤)?** â†’ Sysmon ID 1ì˜ `ParentImage`  
3ï¸âƒ£ **ë¬´ì—‡ì´ ì‹¤í–‰ëë‚˜(ì •í™•í•œ ê²½ë¡œ)?** â†’ Sysmon `Image` â†” Prefetch/ShimCache ê²½ë¡œ êµì°¨  
4ï¸âƒ£ **ì •ë§ ì‹¤í–‰ëë‚˜(ë¡œê·¸ê°€ ë¶ˆì™„ì „í•´ë„)?** â†’ Prefetch `.pf` ì¡´ì¬ë¡œ ì‹¤í–‰ ê·¼ê±° ê°•í™”  
5ï¸âƒ£ **ì–¸ì œ ì‹¤í–‰ëë‚˜?** â†’ Prefetch ì‹¤í–‰ ì‹œê° + Sysmon ì´ë²¤íŠ¸ ì‹œê°„ìœ¼ë¡œ íƒ€ì„ë¼ì¸ ê³ ì •  
6ï¸âƒ£ **ëª‡ ë²ˆ ì‹¤í–‰ëë‚˜(ë°˜ë³µ/ì§€ì† ì—¬ë¶€)?** â†’ Prefetch `Run Count`  
7ï¸âƒ£ **ê·¸ íŒŒì¼ì´ ì‹œìŠ¤í…œì— â€˜ìˆì—ˆë˜ ê±´â€™ í™•ì‹¤í•œê°€?** â†’ ShimCacheë¡œ ì¡´ì¬/ê²½ë¡œ ê³ ì •  
8ï¸âƒ£ **ì´ íŒŒì¼, ì´ë¦„ë§Œ ë°”ê¾¼ ê±° ì•„ëƒ? ë™ì¼ íŒŒì¼ ë§ì•„?** â†’ Amcache(ì‹ë³„/í•´ì‹œ)ë¡œ ë™ì¼ì„± í™•ì •  
9ï¸âƒ£ **LOLBAS/ìŠ¤í¬ë¦½íŠ¸ ìš°íšŒ ì‹¤í–‰ í”ì ì€?** â†’ Sysmon CommandLine + PowerShell(4104)/Task/WMI ë¡œê·¸ ì—°ê³„  
ğŸ”Ÿ **ë³´ê³ ì„œì—ì„œ í”ë“¤ë¦¬ì§€ ì•ŠëŠ” ê·¼ê±° ì„¸íŠ¸ëŠ”?** â†’ ì²´ì¸(ë¶€ëª¨â†’ìì‹) + ì‹œê°„ + ê²½ë¡œ + ë™ì¼ì„±(í•´ì‹œ)

---

## ì°¸ê³  ë§í¬

[1]: https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon "Sysmon - Sysinternals (Microsoft Learn)"
[2]: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4688 "4688(S) A new process has been created (Microsoft Learn)"
[3]: https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing "Command line process auditing (Microsoft Learn)"
[4]: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7.5 "about_Logging_Windows - PowerShell (Microsoft Learn)"
[5]: https://research.splunk.com/endpoint/b3632472-310b-11ec-9aab-acde48001122/ "WinEvent Windows Task Scheduler Event Action Started (Splunk Research)"
[6]: https://docs.nxlog.co/integrate/wmi.html "Windows Management Instrumentation (WMI) (NXLog Documentation)"
[7]: https://redcanary.com/threat-detection-report/techniques/windows-management-instrumentation/ "Windows Management Instrumentation (Red Canary)"
[8]: https://lolbas-project.github.io/ "LOLBAS Project"

