---
title: "쿠팡 해킹 사건: JWT 서명키 유출과 내부자 악용으로 발생한 3,370만 계정 대규모 정보 유출"
date: 2025-12-02
draft: false
description: "쿠팡 인증 시스템의 JWT 서명키 관리 실패와 내부자 악용 가능성을 중심으로, 3,370만 계정 개인정보 유출 사고가 어떻게 발생했는지 위협 시나리오 관점에서 분석합니다."
featured_image: "cdn/threats/case-coupang_authkey.png"
tags: ["쿠팡 해킹", "JWT 서명키", "내부자 공격", "Broken Authentication", "데이터 유출", "PLURA-XDR"]
---

2025년 6월 24일부터 약 **5개월간**, 쿠팡은 **정상 로그인 절차 없이도 고객 정보를 조회할 수 있는 인증 취약점**을 공격자에게 노출한 채 운영했습니다.  
정부 조사와 언론 보도를 종합하면, 사건의 근본 원인은 **JWT 서명키 관리 실패 + 내부자(퇴사자)의 악용 가능성**으로 좁혀지고 있습니다.

이번 사건은 전형적인 외부 해킹이 아닌, **“인증 체계 붕괴”와 “내부 지식 재활용”**이 결합된 형태이며,  
국내 대규모 플랫폼 서비스가 **요청/응답 본문 기반 관제 부재**로 인해 어떻게 장기간 유출을 감지하지 못했는지 보여주는 대표 사례입니다.

<!--more-->
---

## 1. 사건 개요
### 🧩 **정상 로그인 없이 3,370만 계정 정보 유출**
- 정부 발표: 공격자는 **JWT 서명키(signing key)**를 이용하여  
  **“정상 로그인 없이도” 쿠팡 서버가 신뢰하는 JWT 토큰을 직접 생성**.  
- 이 토큰을 대량 발급한 뒤 순차적으로 API를 호출해  
  **이름·전화번호·주소·이메일·주문 정보** 등 개인정보를 유출.
- 초기엔 "4,500개 계정 노출"이라고 발표했으나,  
  이후 실제 피해가 **3,370만 계정**임을 확인.
- 일부 배송지 메모에는 **공동현관 비밀번호**가 포함되어 있어 2차 피해 위험도 증가.

### 🧩 **악성코드 흔적 없음 → 내부자/키 유출 중심 사고**
- 서버 내부에서 악성코드나 웹셸은 발견되지 않음.  
- 이는 “취약점 스캔→악성코드 설치” 같은 전통적 침투가 아니라,  
  **인증 체계를 알고 있던 내부자의 지식이 핵심 요소였음을 시사**.

---

## 2. 공격에 사용된 핵심 취약점
### 🔐 **JWT 서명키 유출: 인증 체계가 그대로 붕괴**
JWT 서명키는 “서버가 발급한 토큰인지 확인하는 비밀키”입니다.  
이 키가 유출되면 공격자는:

1. **임의의 계정(sub)을 가진 토큰 생성 가능**  
2. **만료 시간(exp)을 무한대로 설정 가능**  
3. **권한(role)까지 조작 가능**  
4. **로그인 서버를 완전히 우회 가능**

즉, **쿠팡 인증 시스템 전체를 마음대로 통과할 수 있게 되는 것과 동일**합니다.

### 🚨 **퇴사자 계정과 연동된 서명키가 폐기되지 않음**
- 언론 보도에 따르면 관련 서명키는  
  **쿠팡 인증 시스템 담당자(중국 국적 전직원)**와 연동된 것으로 추정.  
- 퇴사 이후에도 이 키가 **갱신·폐기되지 않은 채** 서비스에 남아 있었음.
- 공격자는 해외 VPS에서 이 키를 이용해 **“쿠팡이 발급한 정상 토큰처럼 보이는 JWT”**를 무한 생성.

---

## 3. 공격 흐름 분석
### 🧭 **공격 시나리오(가설)**

#### 1) JWT 서명키 유출 또는 사전 지식 획득
- 인증 담당자였던 전직원은 서명키에 대한 접근권 또는  
  이를 재구성할 수 있는 내부 설계를 알고 있었을 가능성 큼.

#### 2) 해외 VPS에서 JWT 무제한 생성
- Header/Algorithm 동일하게 생성  
- Payload의 `sub` = 1,2,3,… 증가  
- `exp` = 장기 만료 설정  
- Signature = 유출된 서명키로 생성

#### 3) 사용자 ID가 **정수 기반(1,2,3…)**이었다는 점이 큰 취약점
- 난수 UUID가 아닌 정수 ID →  
  **“대상 계정 번호를 1씩 늘려가며 무차별 조회”**가 매우 쉬움.

#### 4) 5개월 동안 탐지되지 않은 이유
- 모든 요청이 **HTTP 200 OK 정상 응답**  
- JWT 서명도 정상  
- 해외 IP라도 장기간, 낮은 속도로 분산 호출 → 평시 트래픽에 섞임  
- **가장 결정적 문제: 응답 본문을 전혀 관제하지 않음**

---

## 4. “왜 5개월 동안 몰랐는가?” — 구조적 보안 실패
### ❌ 1) JWT 서명키 관리 실패
- 퇴사자 키 갱신·폐기 누락  
- 키가 단일 비밀로 사용되어 **전체 인증 체계가 단일 실패 지점(SPOF)** 상태

### ❌ 2) 사용자 ID 설계 문제
- 정수 기반 ID 사용  
- 공격자가 순차적으로 토큰 생성/사용 가능  
- “고객 3,370만 명 전체”를 순회하는 것이 기술적으로 매우 쉬워짐

### ❌ 3) 대량 조회 탐지 부재
- 반복 호출  
- 동일 패턴의 응답 크기 증가  
- 해외 VPS 접속  
→ **어떠한 시나리오 탐지도 설정되지 않음**

### ❌ 4) 요청/응답 본문 관제 부재
> **가장 심각한 문제:**  
> “응답 본문 안에 어떤 개인정보가 포함되어 있었는지”를  
> 서버·WAF·SIEM 어디에서도 감시하지 않았다는 점.

요청/응답 본문을 관제하지 않는 한,  
“정상 200 OK” 속에 **대량 개인정보가 포함된 응답**이 있어도 절대 탐지할 수 없습니다.

---

## 5. PLURA-XDR / WAF가 막을 수 있었던 지점

PLURA-XDR은 **서명키 유출 자체는 잡을 수 없지만**,
그 **악용 패턴은 매우 명확한 이상행위로 탐지 가능**합니다.

### 🔍 1) JWT Payload 기반 탐지

* JWT `sub` 값이 1,2,3…으로 연속 증가
* `exp` 값이 비정상적으로 김
* 동일 IP/ASN에서 수만 개 계정으로 “로그인한 것처럼” 보이는 패턴

### 📦 2) 요청/응답 본문 분석

* 응답 본문에 포함된 개인정보 필드
  (이름·전화번호·주소·주문내역·공동현관 비밀번호 등)의 반복
* 응답 크기 증가
* 비정상적으로 일관된 응답 구조 반복

### 📊 3) 시나리오 기반 대량 조회 탐지

* “해외 IP + JWT 다양성 증가 + 반복 호출 + 대형 응답” 조합을
  **하나의 데이터 유출 인시던트로 자동 묶기**

### 🛑 4) PLURA-WAF 자동 차단

가능한 기술 조치:

* JWT 클레임(`sub`,`exp`) 기반 룰
* 민감 API(`/user/profile`, `/orders`)에 대한 대량 호출 차단
* 응답 본문 패턴 기반 “개인정보 덩어리 응답” 차단
* 자동 IP 차단 + Shadow 모드 검증

**결론:**

> 서명키가 유출되었다 해도,
> **요청/응답 본문 + JWT 패턴 + 시나리오 탐지**가 있었다면
> 유출을 **초기 단계에서 탐지·차단**했을 가능성이 매우 높다.

---

## 6. 결론: 쿠팡 사건이 보여준 위협 모델 혁신의 필요성

* 인증 체계의 단일 실패 지점(SPOF)이 얼마나 큰 피해를 유발하는지 보여주는 대표 사례
* 내부자·퇴사자 위협 모델링 필수
* JWT 같은 현대 인증 기술도 **키 관리 실패 시 치명적**
* 네트워크 중심 보안만으로는 **정상 토큰을 활용한 공격을 절대 막을 수 없음**
* 이제 보안 관점은 **“누가?”가 아니라 “무엇을 조회했는가?” → 데이터 사용 관제로 이동**해야 함

---

## 📚 참고하기

* [AI 보조 WAF 우회: 공격 자동화 시나리오](https://blog.plura.io/ko/tech/ai-waf-bypass/)
* [Gartner 하이프 사이클로 본 SIEM과 SOAR – 왜 둘 다 한계가 있는가?](https://blog.plura.io/ko/column/hypecycle_siem_soar/)
* [우리나라 해킹은 정부의 인증 제도 때문이다](https://blog.plura.io/ko/column/policy-proposal/)
* [ISMS 인증제도, 왜 지금은 더 이상 유효하지 않은가?](https://blog.plura.io/ko/column/policy-proposal-example-useless/)
* [롯데카드 해킹 사고 분석 - 왜 웹방화벽은 무용지물이 되었을까](https://blog.plura.io/ko/threats/case-lottecard_weblogic/)
* [SKT 해킹 가설: 유심 데이터 탈취와 BPFDoor 설치, 어떻게 이뤄졌나?](https://blog.plura.io/ko/column/skt-hacking-hypothesis/)

