---
date: 2017-08-18T00:01:00
draft: false
title: "ëˆ„êµ°ê°€ ë‹¹ì‹ ì˜ ì¸í„°ë„· ì‚¬ìš©ì„ í›”ì³ë³´ê³  ìˆë‹¤? ARP Spoofing"
description: 
featured_image: "cdn/threats/arp_spoofing_overview-1.png"
tags: ["ARP Spoofing", "ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ", "í•´í‚¹ ê¸°ë²•", "ì‚¬ì´ë²„ ë³´ì•ˆ", "ì •ë³´ ë³´í˜¸"]
---

âš”ï¸ARP ìŠ¤í‘¸í•‘ì€ ê°„ë‹¨í•˜ì§€ë§Œ í”¼í•´ëŠ” ì¹˜ëª…ì ì¸ ê³µê²©ì…ë‹ˆë‹¤.  
ê·¸ëŸ¼ ë„ëŒ€ì²´ ARP ìŠ¤í‘¸í•‘ì´ ë­˜ê¹Œìš”?

> **2016ë…„ 3ì›” 26ì¼** ë°˜ë””ì†Œí”„íŠ¸ í™ˆí˜ì´ì§€ê°€ ARP ìŠ¤í‘¸í•‘ ê³µê²©ì„ ë°›ì•„, ì´ ê¸°ê°„ ë™ì•ˆ ë°˜ë””ì†Œí”„íŠ¸ í™ˆí˜ì´ì§€ë¥¼ í†µí•´ ê¿€ë·°ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ì€ ì‚¬ìš©ìë“¤ì—ê²Œ ê¿€ë·° ì„¤ì¹˜ íŒŒì¼ ëŒ€ì‹  ì•…ì„±ì½”ë“œê°€ ë‹¤ìš´ë¡œë“œ ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤.
>
> **2016ë…„ 4ì›”** íŠ¹ì • í˜¸ìŠ¤íŒ…ì‚¬ê°€ ARP ìŠ¤í‘¸í•‘ ê³µê²©ì„ ë‹¹í•´ ì‡¼í•‘ëª°, P2P, ë‚ ì”¨ ë°°ë„ˆ, ì»¤ë®¤ë‹ˆí‹° ë“± í˜¸ìŠ¤íŒ… ì„œë¹„ìŠ¤ë¥¼ ë°›ëŠ” ë‹¤ìˆ˜ì˜ ì›¹ì‚¬ì´íŠ¸ì—ì„œ íŒŒë°ìš© ì•…ì„±ì½”ë“œê°€ ìœ í¬ë˜ì—ˆìŠµë‹ˆë‹¤.  
> í˜¸ìŠ¤íŒ… ì—…ì²´ë¥¼ ë…¸ë¦° ARP ìŠ¤í‘¸í•‘ ê³µê²©ì€ íŠ¹ì • íŒ¨í‚·ì„ ë³€ì¡°í•´ ì•…ì„± URLì´ë‚˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì¨ ë‹¤ìš´ë¡œë“œ ë§í¬ë¥¼ ë³€ì¡°ì‹œí‚¤ëŠ” ê³µê²© ë°©ì‹ì´ì—ˆìŠµë‹ˆë‹¤.
>
> **2015ë…„ 3ì›”** êµ­ë‚´ ë³´ì•ˆì—…ê³„ ìµœëŒ€ í–‰ì‚¬ì¸ í–‰ì •ìì¹˜ë¶€ ì£¼ìµœ 'ì „ìì •ë¶€ ì†”ë£¨ì…˜ í˜ì–´'ì™€ 'ì„¸ê³„ ë³´ì•ˆ ì—‘ìŠ¤í¬'ì˜ í™ˆí˜ì´ì§€ê°€ ARP ìŠ¤í‘¸í•‘ ê³µê²©ì— ë‹¹í•´ í–‰ì‚¬ ì „ë‚  ë°¤ ë™ì‹œì— ë§ˆë¹„ëìŠµë‹ˆë‹¤.  
> í•´í‚¹ ì‚¬ì‹¤ì„ í™•ì¸í•œ í–‰ì‚¬ ì¡°ì§ìœ„ì›íšŒ ì¸¡ì€ ì•…ì„±ì½”ë“œê°€ í¼ì ¸ë‚˜ê°ˆ ê²ƒì„ ìš°ë ¤í•˜ì—¬ ì„œë²„ ì ‘ì†ì„ ì¤‘ë‹¨ì‹œì¼°ìŠµë‹ˆë‹¤.

<!--more-->
![arp_spoofing_overview](https://blog.plura.io/cdn/threats/arp_spoofing_overview-1.png)

## ARP (Address Resolution Protocol)

ARPëŠ” ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ IP ì£¼ì†Œë¥¼ ë¬¼ë¦¬ì  ì£¼ì†Œ(MAC ì£¼ì†Œ)ë¡œ ëŒ€ì‘ ì‹œì¼œ ì£¼ëŠ” í”„ë¡œí† ì½œì…ë‹ˆë‹¤.  
ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ íŠ¹ì • IPë¥¼ ê°€ì§€ê³  ìˆëŠ” í˜¸ìŠ¤íŠ¸ê°€ ëˆ„êµ°ì§€ ë¬¼ì–´ë³´ë©´(Request), í•´ë‹¹ IPë¥¼ ê°€ì§„ í˜¸ìŠ¤íŠ¸ê°€ ì‘ë‹µ(Reply)í•˜ëŠ” Requestì™€ Reply êµ¬ì¡°ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

### ARP ë™ì‘ê³¼ì •
![arp-request](https://github.com/user-attachments/assets/0e4b777d-2fa3-484d-b969-47d758796f2e)

1. ì†¡ì‹ ìê°€ ìˆ˜ì‹ ìì—ê²Œ ë°ì´í„°ë¥¼ ë³´ë‚¼ ë•Œ ë¨¼ì € ARP í…Œì´ë¸”ì„ í™•ì¸í•©ë‹ˆë‹¤.  
   ARP í…Œì´ë¸”ì— ìˆ˜ì‹ ìì— ëŒ€í•œ ì •ë³´ê°€ ì—†ë‹¤ë©´ ì†¡ì‹ ìëŠ” ARP Request ë©”ì‹œì§€ë¥¼ ìƒì„±í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ìƒì— ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤.
2. ë„¤íŠ¸ì›Œí¬ ìƒì˜ ëª¨ë“  í˜¸ìŠ¤íŠ¸ë“¤ì€ ARP Request íŒ¨í‚·ì„ ìˆ˜ì‹ í•˜ê³  í•´ë‹¹ IPë¥¼ ê°€ì§„ í˜¸ìŠ¤íŠ¸ë§Œ ìì‹ ì˜ ë¬¼ë¦¬ì£¼ì†Œë¥¼ í¬í•¨í•˜ëŠ” ARP Reply ë©”ì‹œì§€ë¥¼ ì†¡ì‹ ìì—ê²Œ ìœ ë‹ˆìºìŠ¤íŠ¸ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.
3. ì†¡ì‹ ìëŠ” ARP Reply íŒ¨í‚·ì„ ë°›ê³  ëª©ì ì§€ IPì™€ ë¬¼ë¦¬ì£¼ì†Œë¥¼ ARP í…Œì´ë¸”ì— ê¸°ë¡í•©ë‹ˆë‹¤.  
   ì´í›„ ARP í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![arp-reply](https://github.com/user-attachments/assets/e54c6989-c84d-4710-9fba-e69f35c2d120)

---

## ARP Spoofing?

ARP Spoofingì€ victimì—ê²Œ ì˜ëª»ëœ MAC ì£¼ì†Œê°€ ë‹´ê¸´ ARP Replyë¥¼ ë³´ë‚´ victimì˜ ARP ìºì‹œë¥¼ ì¡°ì‘í•˜ì—¬ ì •ë³´ë¥¼ ë¹¼ë‚´ëŠ” í•´í‚¹ ê¸°ë²•ì…ë‹ˆë‹¤.  
ARP Reply íŒ¨í‚·ìœ¼ë¡œ ë°›ì€ MAC ì£¼ì†Œì˜ ì§„ìœ„ ì—¬ë¶€ë¥¼ ê²€ì¦í•˜ëŠ” ì¸ì¦ ì‹œìŠ¤í…œì´ ì—†ëŠ” ì·¨ì•½ì ì„ ì´ìš©í•œ ê³µê²©ì…ë‹ˆë‹¤.

![Attack-MITM](https://github.com/user-attachments/assets/de2a1bdd-8a96-48ef-99ba-0c63b22336f1)

### ë™ì‘ê³¼ì •

1. ê³µê²©ìê°€ victimì—ê²Œ gatewayì˜ IP ì£¼ì†Œì™€ ê³µê²©ìì˜ MAC ì£¼ì†Œê°€ ë‹´ê¸´ íŒ¨í‚·ì„ ì§€ì†ì ìœ¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.
2. victimì€ ARP í…Œì´ë¸”ì— í•´ë‹¹ ë‚´ìš©ì„ ê·¸ëŒ€ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

**Targetâ€™s ARP Table**:

| Gatewayâ€™s IP      | Attackerâ€™s MAC Address |
|--------------------|-------------------------|

3. victimì€ ê³µê²©ìë¥¼ gatewayë¡œ ìƒê°í•˜ê³  ê³µê²©ìì˜ MAC ì£¼ì†Œë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.  
   ê³µê²©ìëŠ” ë°›ì€ ë°ì´í„°ë¥¼ í¬ì›Œë”©í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤. (í¬ì›Œë”©í•˜ì§€ ì•Šìœ¼ë©´ Targetì´ ì •ìƒ í†µì‹ ì„ í•  ìˆ˜ ì—†ì–´ ê³µê²©ì„ ì˜ì‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)

---

## ARP Spoofingìœ¼ë¡œ ê°€ëŠ¥í•œ ê³µê²©

- ì•…ì„±ì½”ë“œ ìœ í¬
- ì„¸ì…˜ í•˜ì´ì¬í‚¹
- DNS Spoofing
- VoIP ë„ì²­
- ë¡œê·¸ì¸ ì •ë³´(ì•„ì´ë””/íŒ¨ìŠ¤ì›Œë“œ) ìˆ˜ì§‘

---

## ğŸ› ï¸ëŒ€ì‘ë°©ë²•

- íŒ¨í‚· ê°ì§€ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ARP ì‹ í˜¸ë¥¼ ë³´ë‚´ëŠ” íŒ¨í‚· í™•ì¸
- ARP í…Œì´ë¸”ì„ ì •ì ìœ¼ë¡œ ê´€ë¦¬
- ARP ìŠ¤í‘¸í•‘ ê°ì§€ ì†Œí”„íŠ¸ì›¨ì–´ ì‚¬ìš©
- ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ì—ì„œ ë™ì¼í•œ IPì— ë™ì¼ MAC ì£¼ì†Œê°€ ë§¤í•‘ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

---

## ê³µê²© í…ŒìŠ¤íŠ¸

![re_cap](https://github.com/user-attachments/assets/6ca7e9de-b559-462e-9696-721857259700)

### ì‹œë‚˜ë¦¬ì˜¤ 1

**Targetì˜ ARP í…Œì´ë¸”ì— Gatewayì˜ IPì™€ Attackerì˜ MAC ì£¼ì†Œê°€ ì €ì¥ë˜ë„ë¡ í•˜ì—¬ Targetì´ ì£¼ê³ ë°›ëŠ” íŒ¨í‚·ì„ ìŠ¤ë‹ˆí•‘.**

<ê³µê²© ì „ Targetâ€™s ARP Table>  
![arp_before_v2](https://github.com/user-attachments/assets/3996d878-82c9-4fbd-a855-8b61d12af1f3)

<ê³µê²© í›„ Targetâ€™s ARP Table>  
![arp_after_v2](https://github.com/user-attachments/assets/2f0075be-e96b-4333-a43b-0c0fc65a4a9e)

**Targetì´ ë¡œê·¸ì¸ ì‹œ ê³„ì • ì •ë³´ ìŠ¤ë‹ˆí•‘**  
![ê³„ì •ì •ë³´](https://github.com/user-attachments/assets/e06da358-76a7-4467-bb84-df28884082f3)

---

### ì‹œë‚˜ë¦¬ì˜¤ 2

**Switchì˜ ARP í…Œì´ë¸”ì— Gatewayì˜ IPì™€ Attackerì˜ MAC ì£¼ì†Œë¥¼ ì €ì¥í•˜ì—¬ ìŠ¤ìœ„ì¹˜ì— ì—°ê²°ëœ ëª¨ë“  í˜¸ìŠ¤íŠ¸ì˜ íŒ¨í‚·ì„ ìŠ¤ë‹ˆí•‘.**

<ê³µê²© ì „ Switchì˜ ARP Table>  
![SW_arp-table_before](https://github.com/user-attachments/assets/fe82acfd-6c65-4fd2-aeec-770671987b1a)

<ê³µê²© í›„ Switchì˜ ARP Table>  
![SW_arp-table_after](https://github.com/user-attachments/assets/23945841-c391-439a-9108-539bbb8d88d1)

---

### ì‹œë‚˜ë¦¬ì˜¤ 3

**Routerì— Gatewayì˜ IPì™€ Attackerì˜ MAC ì£¼ì†Œë¥¼ ë³´ë‚´ ë¼ìš°í„°ì˜ ARP í…Œì´ë¸”ì—ì„œ ë™ì¼ IPì— ì¤‘ë³µ MAC ì£¼ì†Œë¥¼ ë§¤í•‘.**

```log
Router# show logging

*Feb 28 15:19:48.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:20:18.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:20:48.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:21:18.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:21:48.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:22:18.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:22:48.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:23:18.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
*Feb 28 15:23:48.203: %IP-4-DUPADDR: Duplicate address 192.168.10.1 on FastEthernet0/0, sourced by 0800.27ef.e2a9
```

