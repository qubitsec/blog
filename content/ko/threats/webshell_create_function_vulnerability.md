---
date: 2024-06-03
draft: false
title: "[WEB] ì›¹ì‰˜ ê³µê²©ê³¼ create_function í•¨ìˆ˜ì˜ ì·¨ì•½ì„±"
description: 
featured_image: "cdn/column/webshell_attack_and_create_function-1.png"
tags: ["ì›¹ì‰˜", "ë³´ì•ˆ", "PHP", "create_function", "ì›¹ ê³µê²©", "ì·¨ì•½ì  ë¶„ì„"]
---

## Webshell(ì›¹ì‰˜) ê°œìš”

ì›¹ì‰˜(Webshell)ì€ ì›¹ ì„œë²„ì— ì—…ë¡œë“œëœ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¡œ, ê³µê²©ìê°€ ì„œë²„ë¥¼ ì›ê²©ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.  
ì´ë¥¼ í†µí•´ ì„œë²„ì˜ íŒŒì¼ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê³  ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥
- **íŒŒì¼ ê´€ë¦¬:** ì—…ë¡œë“œ, ë‹¤ìš´ë¡œë“œ, ìˆ˜ì •, ì‚­ì œ  
- **ëª…ë ¹ ì‹¤í–‰:** ì„œë²„ì—ì„œ shell ëª…ë ¹ ì‹¤í–‰  
- **ë„¤íŠ¸ì›Œí¬ í™œë™:** ì•…ì„± ì½”ë“œ ì „íŒŒ ë° ì‹œìŠ¤í…œ ê³µê²©  
- **ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼:** ë¯¼ê°í•œ ì •ë³´ ìœ ì¶œ  

<!--more-->
![webshell_attack_and_create_function](https://blog.plura.io/cdn/column/webshell_attack_and_create_function-1.png)

---

## Webshell ì‹¤í–‰/ë¶„ì„ ì •ë³´

![1](https://github.com/user-attachments/assets/d1b54924-32cc-41d0-a570-ffc3a192e64f)

### ë¶„ì„ ì •ë³´
- **MD5:** `3cd5c4352b1379bd789ab3de7b76a196`  
- **SHA-1:** `3a728d71ac418a906f9db78ba3fa935736eb02c9`  
- **SHA-256:** `ec04ce68129b58837f0b7b720f9dcb453d840f051ef9d1e2f7d197abf4167384`  

[ì‚¬ì§„ 1] Virustotal Webshell ë¶„ì„ ì •ë³´  

---

## create_function í•¨ìˆ˜ì˜ ì·¨ì•½ì„±

![3](https://github.com/user-attachments/assets/e3da1cf0-5ecc-4947-88e7-f1f50d917a86)

**create_function í•¨ìˆ˜**ëŠ” PHPì—ì„œ ìµëª… í•¨ìˆ˜(Anonymous Function)ë¥¼ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.  
ê·¸ëŸ¬ë‚˜ ë³´ì•ˆ ì·¨ì•½ì ìœ¼ë¡œ ì¸í•´ ì ì°¨ ì‚¬ìš©ì´ ì¤‘ë‹¨ë˜ì—ˆìœ¼ë©°, ìµœì‹  PHP ë²„ì „ì—ì„œëŠ” ì™„ì „íˆ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.

### PHP ë²„ì „ë³„ ë™ì‘ ì—¬ë¶€

1. **PHP 4.0.1 ~ 7.1.x**  
   - ì •ìƒì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥.  

2. **PHP 7.2.0 ~ 7.4.x**  
   - `create_function()`ì€ deprecated ìƒíƒœë¡œ ê²½ê³  ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì§€ë§Œ, ì‹¤í–‰ì€ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
   - **ì¶œë ¥ ì˜ˆì‹œ:**  
     ```plaintext
     Deprecated: Function create_function() is deprecated in /path/to/file.php on line 2
     ```

3. **PHP 8.0 ì´ìƒ**  
   - í•¨ìˆ˜ê°€ ì™„ì „íˆ ì œê±°ë˜ì–´ ì‹¤í–‰ ì‹œ Fatal Error ë°œìƒ.  
   - **ì¶œë ¥ ì˜ˆì‹œ:**  
     ```plaintext
     Fatal error: Uncaught Error: Call to undefined function create_function() in /path/to/file.php:2
     ```

---

## ğŸ› ï¸ ëŒ€ì‘ ë°©ì•ˆ

PHP ë²„ì „ ì—…ë°ì´íŠ¸ëŠ” ë³´ì•ˆ ë° ì„±ëŠ¥ ê°•í™”ë¥¼ ìœ„í•´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.  
íŠ¹íˆ, create_function í•¨ìˆ˜ì˜ ë³´ì•ˆ ì·¨ì•½ì„±ì„ ë°©ì§€í•˜ë ¤ë©´ ìµœì‹  PHP ë²„ì „ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

### ìµœì‹  ë²„ì „ ì—…ë°ì´íŠ¸ì˜ ì´ì 
1. **ë³´ì•ˆ ê°•í™”:** Webshell ê³µê²© ë° ì·¨ì•½ì  ë°©ì§€.  
2. **ì„±ëŠ¥ ê°œì„ :** ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ë‹µ ì†ë„ ìµœì í™”.  
3. **ìƒˆë¡œìš´ ê¸°ëŠ¥ ì œê³µ:** ìµœì‹  ë¬¸ë²•ê³¼ ê¸°ëŠ¥ í™œìš© ê°€ëŠ¥.  

PHP 8.0 ì´ìƒìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ ë³´ì•ˆê³¼ ì„±ëŠ¥ì„ ìœ ì§€í•˜ë©°, Webshellê³¼ ê°™ì€ ê³µê²©ìœ¼ë¡œë¶€í„° ì‹œìŠ¤í…œì„ ë³´í˜¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“– í•¨ê»˜ ì½ê¸°

- [PHP ê³µì‹ ë¬¸ì„œ - create_function í•¨ìˆ˜](https://www.php.net/manual/en/function.create-function.php)  
- [Virustotal ì›¹ì‰˜ ë¶„ì„ ê²°ê³¼](https://www.virustotal.com/gui/file/ec04ce68129b58837f0b7b720f9dcb453d840f051ef9d1e2f7d197abf4167384/details)  
