---
date: 2021-09-17T01:01:00
draft: false
title: "VPN 취약점 악용 공격 증가"
description: "VPN 제품의 보안 취약점을 악용한 공격 사례와 대응 방안"
featured_image: "cdn/threats/vpn_vulnerability_exploitation_increase-1.png"
tags: ["VPN", "보안", "취약점", "랜섬웨어", "김수키", "KMS 인증 서버", "다단계 인증"]
---

## VPN (Virtual Private Network) 개요

VPN은 주로 서버에 대한 원격 접속 용도로 사용되며, 공용 네트워크를 통해 내부 시스템 자원에 접근할 목적으로 쓰이는 가상 사설 네트워크입니다.¹⁾  
COVID-19로 인한 재택근무가 증가하며, 이에 대한 보안 대책으로 기업에서 VPN 사용이 늘어나고 있습니다.

그러나 VPN 제품의 보안 취약점을 이용한 공격은 패치가 제공되기 전까지 동일한 제품을 사용하는 다른 기업들에까지 영향을 미칠 수 있습니다.  
공격자는 일부 사용자가 패치를 적용하지 않는 점을 악용합니다.

<!--more-->
![vpn_vulnerability_exploitation_increase](https://blog.plura.io/cdn/threats/vpn_vulnerability_exploitation_increase-1.png)

2021년 6월, 한국원자력연구원과 KAI(한국항공우주산업)가 북한 소행으로 추정되는 해킹 공격을 받은 사례가 있습니다.

---

## 한국원자력연구원 해킹 내용

| 날짜             | 내용                                               |
|------------------|----------------------------------------------------|
| 21.05.14. 금    | 해킹 발생                                          |
| 21.05.29. 토    | 한국과학기술정보연구원 → 한국원자력연구원 해킹 위험 메일 통보 |
| 21.05.31. 월    | 보안 조치                                          |

- **VPN 취약점을 통해 외부인이 일부 시스템에 접속한 이력 확인**  
- **13개 외부 IP 주소에서 VPN 시스템 비인가 접속 발생**  
- **피해 IP 주소:** VPN, 메일 시스템, KMS 인증 서버 (Windows, Unix)  

13개 외부 IP 주소는 이전에도 사용된 적 있는 **Kimsuky(김수키)** 관련 IP로 확인되었습니다.  
특히 KMS 인증 서버는 다양한 프로그램의 인증을 담당하며, 이를 통해 악성코드가 유포되면 피해 범위가 크게 증가할 수 있습니다.  
한국원자력연구원은 공격자 IP를 외부망 방화벽 및 IPS에서 차단하여 긴급 조치했습니다.²⁾  

---

## KAI 해킹 사례

같은 VPN 제품을 사용하던 **KAI**(한국항공우주산업)도 해킹을 당해 중요 정보가 유출되었습니다.  
해당 VPN 제품은 국내 시장 1위로, 공공기관, 기업, 학교 등 400여 곳에서 사용되고 있었습니다.  
해커는 발견된 취약점을 통해 여러 기관을 손쉽게 동시에 해킹할 수 있었습니다.  
국정원은 4월부터 해당 제품의 취약점을 인지하고 보안 조치를 요구했지만, 대응 지연으로 인해 피해를 막지 못했습니다.³⁾

---

## VPN 공격 유형

1. **취약한 계정 사용**⁴⁾  
   - 기본 설정 계정 및 추측하기 쉬운 패스워드 사용  
     - 예: `admin/admin1234`

2. **취약한 VPN 제품 버전 사용**⁵⁾  
   - 예: `Pulse Connect Secure 9.0R1 ~ 9.0R3.3`  
     - 인증되지 않은 사용자가 원격으로 파일 실행을 수행할 수 있는 취약점 존재 (`CVE-2021-22893`)

3. **위장된 VPN 제품 사용**  
   - 무료 VPN 소프트웨어의 경우 백도어 역할 가능성  

VPN 관련 공격은 주로 애플리케이션의 취약점을 이용해 주요 데이터를 탈취하거나 랜섬웨어를 배포하며, 백도어를 설치해 지속적인 접근성을 확보합니다.

---

## 보안 권고 사항

1. **VPN 제품 취약점 보안 강화**  
   - 사용 중인 VPN 제품의 최신 버전으로 업데이트 필요  
   - 예: **[시큐위즈]⁶⁾**

| 영향받는 버전                        | 해결 버전                          |
|------------------------------------|----------------------------------|
| SecuwaySSL V3.0 : 3.0.9.0          | SecuwaySSL V3.0 : 3.0.10.0       |
| SecuwaySSL V3.1 : 3.1.8.0          | SecuwaySSL V3.1 : 3.1.9.0        |

   - **[Pulse Secure]** : [보호나라 공지사항](https://www.boho.or.kr/data/secNoticeView.do?bulletin_writing_sequence=36009)  
   - **[Fortinet]** : [보호나라 공지사항](https://www.boho.or.kr/data/secNoticeView.do?bulletin_writing_sequence=35989)  
   - **[Cisco]** : [AhnLab 블로그](https://blog.alyac.co.kr/3977)  

2. **취약점 발견 시 보안 패치 전까지 운영 중단 권고**  
3. **Default 계정/패스워드 변경**  
4. **허용된 사용자 및 단말기만 접근 가능하도록 설정**  
   - OTP 등 다단계 인증 적용  
5. **업무망과 인터넷망 분리 운영**  
6. **문서 암호화 보안 솔루션(DRM) 도입 권고**  

---

## 비인가 접속 탐지 방안

1. **VPN 로그 수집 및 분석**  
   - 로그인 시도 시 발생되는 로그를 수집하고 분석  

   ![0-1](https://github.com/user-attachments/assets/1f01726f-d7dc-482b-be6a-02bb21d6dae8)

2. **탐지 패턴 조정**  
   - 인가된 IP 주소 외의 접속을 탐지  

   ![1-1](https://github.com/user-attachments/assets/75edcaa7-1abf-4c25-b9ca-e37cb3478ea2)

3. **비인가 IP 접근 방어 조치**  
   - 인가되지 않은 IP 주소에서 로그인 성공 시 즉시 방어  

   ![2](https://github.com/user-attachments/assets/79dbf7e6-fcc4-4c9a-9036-efe9d3203336)

4. **알림 기능 활용**  
   - 탐지 및 방어 동작 시 담당자에게 실시간 알림  

   ![4](https://github.com/user-attachments/assets/bd60d9ca-47ae-4e6e-8da4-8d95393277e1)

**로그 수집 → 탐지 → 방어 → 알림**까지의 과정을 실시간으로 수행하는 시스템을 구축하면 보안 위협에 즉각 대응할 수 있습니다.

---

## 참조
1. [Virtual private network - Wikipedia](https://en.wikipedia.org/wiki/Virtual_private_network)  
2. [디지털데일리](http://m.ddaily.co.kr/m/m_article/?no=216447)  
3. [TV조선](http://news.tvchosun.com/site/data/html_dir/2021/07/02/2021070290112.html)  
4. [YouTube - VPN 보안](https://www.youtube.com/watch?v=B6pnCJFvnYE)  
5. [Pulse Secure Security Advisory](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784/)  
6. [보호나라 - 시큐위즈 공지](https://www.boho.or.kr/data/secNoticeView.do?bulletin_writing_sequence=36140)  
7. [보호나라 - 보안 권고](https://www.boho.or.kr/data/secNoticeView.do?bulletin_writing_sequence=36049)  
