아래는 **HSS**(Home Subscriber Server)를 중심으로 한 **통신사 보안 아키텍처**와 **MITRE ATT\&CK for Telco 기반 위협 모델링**에 대한 **블로그 게시용 전문 콘텐츠**입니다.
모든 설명은 **실무자 및 기술 담당자를 대상으로** 하되, **명확하고 이해하기 쉬운 표현**을 사용하였습니다.

---

# 📡 HSS를 중심으로 한 통신사 보안 아키텍처와 위협 모델링

## 🧭 개요

이동통신사 보안의 중심에는 **HSS**(Home Subscriber Server)가 있습니다.
HSS는 단순한 인증 서버가 아니라, **모든 가입자 인증, 위치 정보, 서비스 정책**을 관리하는 **통신망 보안의 심장부**입니다.
이 글에서는 HSS를 중심으로 한 보안 아키텍처를 정리하고, MITRE ATT\&CK 프레임워크를 기반으로 실질적인 **공격 시나리오와 대응 전략**을 제안합니다.

---

## 🔍 HSS란 무엇인가?

| 항목    | 내용                                            |
| ----- | --------------------------------------------- |
| 정식 명칭 | Home Subscriber Server                        |
| 주요 역할 | 가입자 인증, 위치 관리, 정책 정보 제공 (IMSI, MSISDN, QoS 등) |
| 연동 대상 | MME/AMF, PCRF/PCF, IMS, HLR, AAA 등            |
| 프로토콜  | Diameter, LDAP, REST, HTTPS                   |
| 구성 위치 | **코어망(Core Network)** 내부                      |

---

## 🛡 HSS 중심 보안 아키텍처

### 🔸1. 기본 아키텍처 구조

```mermaid
flowchart TD
    사용자 --> 인터넷망 -->[1]FW-->[2]LoadBalancer-->[3]Web/API Gateway-->[4]HSS관리UI
    HSS관리UI -->[5]HSS Core Logic
    HSS Core Logic --> MME & PCRF & IMS
```

### 🔸2. 방어 구성 요소

| 위치   | 구성 요소                    | 역할                                   |
| ---- | ------------------------ | ------------------------------------ |
| \[1] | 방화벽(FW)                  | 외부 트래픽 필터링 및 포트 제한                   |
| \[2] | L4 로드밸런서                 | 요청 분산 및 기본 보안정책 적용                   |
| \[3] | 웹방화벽(WAF) 또는 API Gateway | **웹 기반 공격(CSRF/XSS/Injection 등) 차단** |
| \[4] | 접근제어(ACL)                | 관리자 IP 제어 및 권한 기반 인증                 |
| \[5] | 감사 및 로깅 시스템              | 변경 기록 및 이상 탐지 기반 대응                  |

---

## 🎯 MITRE ATT\&CK for Telco 기반 위협 모델링

MITRE ATT\&CK는 공격자의 전술(Tactic)과 기술(Technique)을 분류한 체계로, 통신사 특화 영역에 \*\*"Telco Vertical"\*\*도 포함되어 있습니다.

### 💣 주요 위협 시나리오 (HSS 기준)

| 전술(Tactic)        | 기술(Technique)                                      | 실제 위협                         |
| ----------------- | -------------------------------------------------- | ----------------------------- |
| Initial Access    | Valid Accounts, Exploit Public-Facing App          | 웹 UI 또는 API 취약점으로 관리자 계정 탈취   |
| Credential Access | Brute Force, Credential Dumping                    | 관리자 계정에 대한 딕셔너리 공격            |
| Discovery         | Network Sniffing, System Information Discovery     | HSS 네트워크 구조 및 설정 파악           |
| Lateral Movement  | Internal Spearphishing, Application Layer Protocol | Diameter 트래픽 통해 다른 코어망 요소로 확산 |
| Exfiltration      | Exfiltration Over Command & Control Channel        | 가입자 인증정보(IMSI, 키 등) 외부 유출     |
| Impact            | Data Manipulation, Denial of Service               | 인증 정책 위조 또는 가입자 서비스 마비        |

> 📌 특히 **HSS의 웹 UI/API가 WAF 없이 운영되거나, 포트 제한 없이 노출된 경우** 위 공격들이 현실화될 수 있습니다.

---

## ✅ 대응 전략 요약

| 영역          | 대응 방안                                     |
| ----------- | ----------------------------------------- |
| 관리 인터페이스    | WAF 적용, 관리자 IP 화이트리스트, 2FA 도입             |
| 인증 및 접근제어   | 역할 기반 권한관리(RBAC), 최소 권한 원칙 적용             |
| 로깅 및 감시     | 실시간 감사 로그 분석, 이상 행위 탐지 시스템 연동             |
| API 보안      | Rate Limiting, Token 기반 인증, JSON 스키마 검사 등 |
| Diameter 보호 | Signaling Firewall 도입, 정규 트래픽 패턴 분석       |

---

## 🧩 결론

HSS는 더 이상 단순한 가입자 관리 장비가 아닙니다.
**공격자는 HSS를 장악함으로써 수백만 명의 사용자 정보를 확보하고, 통신망 전체를 교란할 수 있습니다.**
따라서 **웹 방화벽**, **접근 제어**, **실시간 모니터링**, **MITRE 기반 위협 대응**을 모두 갖춘 통합 보안 체계가 필수입니다.

---

다음은 **HSS(Home Subscriber Server)** 환경에서 발생할 수 있는 보안 위협을 실질적으로 이해하고 대응할 수 있도록 구성한 **위협 탐지 시나리오 예시 3선**입니다.
실제 MITRE ATT\&CK for Telco 프레임워크와 보안 실무를 기반으로 작성되었으며, **통신사 보안 담당자, SIEM 운영자, 보안 관제 요원(SOC)**에게 유용한 내용입니다.

---

# 🛡 HSS 기반 위협 탐지 시나리오 예시 3선

---

## 📌 시나리오 1. 관리 웹 인터페이스를 통한 침입 (Initial Access)

### ● 개요

공격자가 외부에 노출된 **HSS 관리용 웹 UI**의 취약점을 이용해 관리자 권한을 탈취하고 내부망에 진입하는 시나리오.

### ● 공격 흐름

1. 공격자는 HSS 관리 포트(예: `443`, `8443`) 스캔
2. 공개 취약점(CVE) 또는 디폴트 계정으로 웹 로그인 시도
3. 로그인 성공 후, 웹 UI를 통해 인증 설정 및 로그 정책 조작
4. 내부 인증 시스템 교란, 타 가입자 정보 조회 또는 수정

### ● 탐지 포인트

| 구분        | 로그 예시 / 탐지 방식                                      |
| --------- | -------------------------------------------------- |
| 웹 서버 로그   | `/admin/login`에 대해 평소보다 높은 실패율 탐지 (Brute-force 의심) |
| 시스템 로그    | 관리자 권한 변경, 정책 파일 조작, UI 설정 변경 감지                   |
| PLURA-XDR | `POST /admin/*` 요청의 이상한 패턴 탐지, Header 정보 무결성 확인    |

### ● 대응 방안

* WAF로 `/admin` 경로 보호
* 관리자 인증에 2FA 적용
* 로그인 시도 횟수 제한 및 알림 연동

---

## 📌 시나리오 2. Diameter 프로토콜을 악용한 수직 확산 (Lateral Movement)

### ● 개요

공격자가 침투 후, HSS의 **Diameter 메시지 통신 구조**를 분석해 다른 코어망 장비(MME, PCRF 등)로 **수평/수직 확산**을 시도.

### ● 공격 흐름

1. HSS 내부에서 MME로 향하는 Diameter 트래픽 스니핑
2. 인증 벡터 요청 패턴을 위조하여 세션 하이재킹 또는 세션 테이블 중복 생성
3. 다른 가입자에 대한 정책이나 인증정보 조작 시도

### ● 탐지 포인트

| 구분       | 예시 / 탐지 방식                               |
| -------- | ---------------------------------------- |
| 네트워크 IDS | `CER`, `DWR` 등의 Diameter 요청이 정상 패턴에서 벗어남 |
| 시스템 로그   | 특정 가입자에 대한 인증 요청이 비정상적 빈도로 반복됨           |
| XDR 분석   | `IMSI`, `MSISDN` 등 파라미터 변조 패턴 감지         |

### ● 대응 방안

* Signaling Firewall 도입 (Diameter 전용 보안 솔루션)
* 통신 빈도 기반 이상 탐지
* IMSI 단위 접근 제어 정책 적용

---

## 📌 시나리오 3. REST API를 통한 가입자 정보 탈취 (Exfiltration)

### ● 개요

HSS가 제공하는 **RESTful API**를 통해 외부에서 IMSI, 가입자 위치, QoS 설정 등의 민감 정보를 조회하거나 탈취하는 공격 시나리오.

### ● 공격 흐름

1. 내부 계정 또는 외부 노출된 API Key 유출
2. 반복적 GET 요청으로 다수 가입자 정보 수집
3. 외부로 데이터 전송 (예: Cloud 저장소 업로드 또는 외부 API 연동)

### ● 탐지 포인트

| 구분             | 로그 예시 / 탐지 방식                                |
| -------------- | -------------------------------------------- |
| API Gateway 로그 | 평소보다 많은 가입자 정보 요청 (e.g. `GET /subscriber/*`) |
| 시계열 분석         | 특정 시간대에 특정 API 호출이 폭증                        |
| PLURA-XDR      | `Response Body`에 포함된 개인정보 필드값 추출 및 이상 감지     |

### ● 대응 방안

* API 요청 횟수 제한 (Rate Limiting)
* 개인정보 필드 암호화 및 로그 필터링
* IP, API Key 단위 접근 제어 정책 강화

---

## ✅ 결론

| 공통 보안 권고사항                                                                  |
| --------------------------------------------------------------------------- |
| 1. 웹 인터페이스 및 API 경로는 **WAF 및 접근제어**로 보호해야 함                                 |
| 2. **Diameter 프로토콜 통신을 모니터링**할 수 있는 전용 방화벽 또는 IDS 필요                        |
| 3. PLURA-XDR 같은 **실시간 로그 기반 탐지 시스템**과 연계하면 웹/네트워크/시스템 전 계층 위협을 조기에 탐지할 수 있음 |

---


