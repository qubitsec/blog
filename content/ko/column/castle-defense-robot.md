---

title: "\[공성전 비유] 성을 지키는 사이버 방어 — ‘돌처럼 보낸 로봇’ 🤖"
date: 2025-09-11
draft: false
description: "방화벽·WAF·IPS로도 뚫리는 이유를 공성전으로 풀어 설명하고, 내부 행위·비콘(C2) 탐지와 자동 대응으로 막는 법을 제시합니다."
featured\_image: "cdn/column/castle-defense-robot.png"
tags: \["공성전", "사이버보안", "XDR", "EDR", "Zero Trust", "IR", "PLURA"]
---

# 성을 지키는 사이버 방어 — ‘돌처럼 보낸 로봇’ 🤖

공격자는 **단 한 번만 성공**하면 되고, 수비자는 **항상 완벽**해야 합니다.
겉에서 보면 성벽(방화벽·WAF·IPS)은 높고 두꺼워 보이지만, 가까이 가보면 **보이지 않던 균열**이 있습니다.
적은 투석기로 돌을 던지는 척하다가, 사실은 \*\*돌처럼 위장한 ‘로봇’(백도어)\*\*을 성 안으로 떨어뜨립니다.
로봇은 성 안을 돌아다니며 길을 익히고(권한 탈취·측면이동), 바깥의 공성군과 \*\*비콘(C2 통신)\*\*으로 속삭이죠.

<!--more-->

![Protect the Castle](https://blog.plura.io/cdn/column/castle-defense-robot.png)

핵심은 ‘벽’이 아니라 **벽을 넘은 뒤의 행위**입니다.
이 글은 공성전 비유로 **왜 기존 방어가 실패했는지**, **무엇을 바꿔야 하는지**를 정리합니다.

---

## 1) 짧은 이야기: 성벽은 막았지만, 바닥의 물길은 열려 있었다

왕국은 금으로 장식된 성문, 붉은 깃발, 정기 점검 절차를 세웠습니다.
그러나 적은 **배수로**를 타고 들어왔고, **보물창고는 비었습니다**.
모두가 절차를 지켰지만, **현실의 공격 경로**는 절차서에 없었습니다.

> 교훈: **절차 준수 = 안전**이 아닙니다.
> **보이지 않는 경로(노출면)와 내부 행위**가 실제 리스크를 만듭니다.

---

## 2) 공성전 ↔ 사이버 매핑표

| 공성 요소        | 사이버 현실(공격)               | 수비 포인트(방어)                                 |
| ------------ | ------------------------ | ------------------------------------------ |
| 성벽           | FW/WAF/IPS 우회, 포트·경로 스캐닝 | 기본은 필수. **규칙·패치·노출면 최소화**                  |
| 해자/바리케이드     | 네트워크 동서 트래픽              | **Zero Trust·마이크로세그멘테이션**                  |
| 성문·열쇠        | 계정·권한, MFA               | **최소권한·MFA·권한승급 모니터링**                     |
| 투석기·노포       | DDoS·대량 인증 시도            | **레이트리밋·챌린지/캡차·WAF 룰**                     |
| 사다리·공성탑      | 피싱·드라이브바이로 초기거점          | **메일 보안·EDR·애플리케이션 제어(Allowlist/WDAC)**    |
| 갱도(굴착)       | 공급망 취약점·웹셸               | **SBOM·무결성·행위기반 탐지**                       |
| 간첩           | 자격증명 탈취·내부자              | **UEBA·비정상 로그인·이상 패턴**                     |
| 역병 시체        | 웜/랜섬웨어 확산                | **EDR 격리·실행 차단·불변 백업**                     |
| 성벽의 균열       | 과오픈 보안그룹·오픈 버킷·낡은 VPN    | **ASM(자산/노출면 관리)·드리프트 탐지**                 |
| 돌처럼 보낸 로봇 🤖 | 드로퍼/백도어·C2 비콘            | **엔드포인트 행위 + DNS/HTTP(S) Egress 통제·자동 대응** |

> 메모: 현대 TLS(특히 1.3, 1.2의 PFS)는 **중간 수동 복호화가 사실상 불가**합니다.
> 그래서 **엔드포인트 행위/비콘 탐지**와 \*\*목적지 기반 Egress 통제(DNS/도메인 Allowlist)\*\*가 결정적입니다.

---

## 3) 왜 수비가 어려운가 (Defender’s Dilemma)

1. **비대칭성**: 공격자는 ‘한 번 성공’, 수비자는 ‘항상 성공’
2. **복잡성 폭증**: 멀티클라우드·컨테이너·IaC → “**시스템은 복잡할수록 실패하기 쉽다**”
3. **가시성 저하**: 암호화·E2E·BYOD로 네트워크 중간 관측 한계
4. **과거형 룰 의존**: 정적 시그니처/룰은 변주에 취약
5. **운영 피로도**: 경보 홍수·포인트 솔루션 난립 → **IR 지연**

---

## 4) ‘성벽 중심’ 방어가 실패하는 전형

* **필요조건이지 충분조건이 아님**: 벽은 막아도, **안의 이동/비콘**을 놓치면 피해로 연결
* **우회·제한**: 대용량/Chunked/멀티파트 업로드, 일부 장비의 **바디 임계 초과 시 부분 검사/우회**
* **암호화의 맹점**: TLS로 내용 관측 어려움 → **목적지·행위·메타데이터 기반** 필수
* **운영 분절**: WAF·EDR·SIEM·SOAR가 따로 놀면 \*\*맥락(누가/어디서/무엇을)\*\*이 끊김
* **튜닝 피로**: 규칙·오탐 관리에 인력 소모, **자동 격리·증거수집**이 뒤로 밀림

---

## 5) 제대로 막는 법 — 원칙 6가지

1. **연결된 다계층 방어**: 네트워크·엔드포인트·아이덴티티 **텔레메트리 통합**
2. **Zero Trust**: 성 전체가 아닌 **방·복도 단위 경계**(마이크로세그멘트)
3. **자격증명 탄력화**: **MFA·단기 토큰·권한승급 차단**
4. **비콘/Egress 통제**: **DNS/HTTP(S) 목적지 Allowlist + 행위 비콘 탐지**
5. **즉응 IR**: **원클릭 격리/차단·자동 증거수집·즉시 리포트**
6. **노출면 관리(ASM)**: 자산·포트·도메인 **상시 인벤토리 & 드리프트 경보**

### 실행 체크리스트(현실 점검)

* [ ] 외부 노출 자산/포트/도메인 **자동 인벤토리 및 주기 스캔**
* [ ] **EDR 행위 규칙 + Sysmon/Audit**로 MITRE ATT\&CK TTP 추적
* [ ] **DNS/Egress Allowlist**(신규·의심 도메인 차단/알림)
* [ ] **비정상 로그인/권한승급** UEBA 경보 → **자동 격리 플레이북** 연동
* [ ] **대용량/Chunked 업로드 우회** 정책 재검토 및 테스트
* [ ] **불변(Immutable) 백업**·격리 복구 리허설 정례화
* [ ] **SBOM/패치** 파이프라인·공급망 취약점 SLA 운영
* [ ] **MTTD/MTTR** 대시보드 주간 점검, 오탐/미탐 리뷰
* [ ] **Table-top/Purple Team**로 시나리오 반복 훈련

---

## 6) 흐름 다이어그램

```mermaid
flowchart LR
  A[공격자] -->|피싱/취약점/우회| B[성벽(FW/WAF/IPS)]
  B -->|균열/오구성/공급망| C[초기 침투]
  C --> D[내부 이동/권한승급/자격증명 탈취]
  D --> E[비콘(C2)/데이터 유출 시도]
  subgraph 내부 수비
    F[엔드포인트 행위 탐지(EDR·Sysmon/Audit)]
    G[DNS/HTTP(S) Egress 통제 & 비콘 탐지]
    H[자동 대응(SOAR): 격리·차단·증거수집·리포트]
  end
  C --> F
  E --> G
  F --> H
  G --> H
  H --> I[복구·패치·정책개선(노출면 관리)]
  I --> B
```

> 캡션: **‘벽’ 이후의 전투** — 내부 행위·비콘을 잡고 자동 봉쇄로 끝낸다.

---

## 7) 용어 정리

* **IR(Incident Response)**: 침해사고 대응. 탐지 후 **격리·차단·증거수집·보고·복구**까지 포함
* **비콘(Beacon)**: 내부의 악성 요소가 외부 C2로 **주기적 신호/명령 교환**을 시도하는 행위
* **UEBA**: 사용자·엔티티 행위 기반 이상 탐지
* **ASM(Attack Surface Management)**: 노출 자산·취약 경로의 **상시 발굴·관리**

---

## 8) 현장 스케치(익명화)

* **사례 A**: 외부 노출 경로가 없다고 판단했으나, 배포 자동화 중 생성된 **임시 포트**가 열려 초기 거점 확보. 이후 **자격증명 탈취 → 측면 이동 → C2 비콘**으로 이어짐. *EDR 행위 탐지와 DNS Egress 차단으로 차단.*
* **사례 B**: 대용량 업로드 경로에서 일부 장비가 **바디 임계 초과 시 부분 검사/우회**. 공격 페이로드를 심층에 숨겨 WAF 우회 시도. *정책 재설계와 업로드 경로 분리로 해결.*

---

### 📖 함께 읽기

* [BPFDoor 계열 위협과 대응](https://blog.plura.io/ko/respond/bpfdoor/)
* [SKT 사건 가설과 교훈](https://blog.plura.io/ko/column/skt-hacking-hypothesis/)
* [정책 제안: 인증 제도와 보안의 괴리](https://blog.plura.io/ko/column/policy-proposal/)

---

### 마무리

오늘의 방어전은 \*\*‘벽’이 아니라 ‘안’\*\*에서 벌어집니다.
**엔드포인트 행위·비콘 탐지와 자동 대응**을 중심으로,
노출면을 줄이고(ASM), **IR을 즉응화**하면 승산이 있습니다.
공성전의 승패는 **균열을 먼저 발견하고 메우는 손**에 달려 있습니다.
