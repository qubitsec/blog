아래는 기존 글의 흐름과 핵심 메시지를 유지하면서도, **가독성**, **논리 구조**, **추가 정보**를 보강한 예시입니다. 강조 표현과 이모지 사용은 **핵심 포인트** 위주로 정리했으며, **SIEM 도입 전 고려사항**을 좀 더 구체적으로 담았습니다.

---

---

title: "SIEM, 도입하면 뭐하나요? 로그 수집도 분석도 안 된다면"
date: 2025-05-16
draft: false
description: "SIEM을 도입했지만 제대로 된 로그 수집도 불가능하고, 수집한 로그를 분석할 역량도 없다면 그것은 그저 비싼 시각화 툴에 불과합니다. 실질적인 한계를 정리해 봅니다."
featured\_image: "cdn/column/why\_siem\_always\_fails.png"
tags: \["SIEM", "보안운영", "오버엔지니어링", "로그분석", "보안", "Security", "PLURA-XDR"]
-------------------------------------------------------------------------

## SIEM, **정말** 제대로 활용 중인가요?

많은 기업이 **SIEM**(Security Information and Event Management) 도입을 고민합니다.
하지만 중요한 질문 하나가 있습니다:
**정말 로그 수집이 되고 있나요?** 그리고 **수집한 로그를 제대로 분석하고 있나요?**

결론부터 말하면, **대부분의 기업은 웹 로그, OS 감사 로그 등** 기초적인 로그도 제대로 수집하지 못합니다. 또한 **분석할 역량**이나 체계도 구축되어 있지 않은 경우가 많습니다.
이런 상황에서 SIEM은 결국 **고가의 시각화 대시보드** 그 이상도 이하도 아닙니다.

![SIEM 도입의 허상](https://blog.plura.io/cdn/column/why_siem_always_fails.png)

---

## 1. 로그 수집부터 쉽지 않은 현실

### 1.1 웹 로그의 한계

* 대부분의 웹 서버는 기본적으로 **액세스 로그**만 남깁니다.

  * 이 로그는 URL, 상태 코드, 요청 헤더 정도만 기록합니다.
* 문제는 \*\*요청 본문(Request Body)과 응답 본문(Response Body)\*\*이 빠져 있다는 점입니다.

  * SQL Injection, XSS 등은 보통 **요청 본문에 포함된 악성 코드**를 통해 동작합니다.
  * 개인정보 유출은 **응답 본문**에 담긴 정보를 외부로 전송하는 방식으로 발생합니다.
* 즉, 공격의 핵심 단서가 되는 정보가 **로그에 아예 남지 않는** 경우가 허다합니다.

> 물론 일부 WAF(Web Application Firewall)나 고급 로깅 기능을 통해 Request Body/Response Body 캡처가 가능합니다.
> 하지만 이는 **성능 저하**와 **추가 비용** 문제가 뒤따르기 때문에, 실제로는 많은 조직이 제대로 활용하지 못하고 있습니다.

### 1.2 운영체제 감사 정책의 부재

* 윈도우나 리눅스 모두, **감사(Auditing) 정책**을 설정하지 않으면

  * 사용자 로그인, 프로세스 실행, 권한 변경 같은 핵심 이벤트가 **기록되지 않습니다.**
* 감사 정책을 활성화해도, 수십만 건 이상의 로그가 쌓입니다.

  * **어떤 이벤트가 이상 징후인지** 명확한 기준과 룰 없이 단순 보관만 하면, 결국 유의미한 분석은 불가능합니다.

---

## 2. 로그 분석? 할 수 없습니다

아래는 **2.1 웹로그에서 공격 쿼리 추출** 부분에 대해,
“외부 도구를 통해 Request Body나 악성 페이로드를 어떻게든 SIEM에 수집한다 해도,
결국 ‘이게 SQL 인젝션이다’, ‘이게 XSS다’라고 **직접 정의**하고 **검색 쿼리**를 작성해야 하는 문제를 어떻게 해결할 것인가?”에 대한 **한계점**을 좀 더 구체적으로 풀어낸 예시입니다.

---

### 2.1 웹로그에서 공격 쿼리를 직접 추출할 수 있을까?

#### 1) Request Body까지 수집·인덱싱한다고 가정해봅시다

* 기본적으로 웹 서버 로그는 **URL, 상태 코드**만 저장하지만,

  * \*\*WAF(Web Application Firewall)\*\*나 **에이전트**를 이용해 **Request Body**(또는 **Response Body**)까지
    **모든 트래픽 데이터를 로깅**할 수도 있습니다.
* 이 경우, 이론적으로는 “`select * from`”이나 `<script>` 같은 **악성 페이로드**를

  * SIEM 내에서 **검색 쿼리**로 찾아볼 수 있게 됩니다.

#### 2) “이게 정말 SQL 인젝션/XSS인지”를 **SIEM이** 자동 판단할 수 있을까?

* 로그에 “`select * from`” 문자가 들어 있다고 무조건 SQL 인젝션은 아닙니다.

  * 정당한 쿼리, 예: 애플리케이션 내부에서 “select \* from logs”를 호출하는 정상 트래픽일 수도 있습니다.
* XSS 역시 “<script>” 문자열만으로는 정당한 스크립트 삽입(예: 게시판 기능)에 불과할 수 있습니다.
* 결국, **SIEM이 자동으로** “이건 공격이다!”라고 태깅해주려면,

  1. **로그 필드를 어떻게 파싱**할지,
  2. “어떤 문자열/패턴이 악성”인지를 **사용자가 직접 정의**해야 합니다.
* “`WHERE request_body CONTAINS 'select * from' AND NOT … (정상 패턴들 제외)`” 같은 **복잡한 필터링 쿼리**가 필요해지는데,

  * 이를 작성·유지하는 부담이 **사용자**에게 전가됩니다.

#### 3) “자동 시그니처 업데이트”가 있다고 해도…

* 일부 솔루션은 **공격 시그니처**(“이런 패턴은 SQL 인젝션이다” 등)를 자동 업데이트해주기도 합니다.

  * 그러나 무수히 많은 변종 공격을 100% 커버하기는 어렵고,
  * 특정 기업 환경(내부 API, 특수 파라미터)에서는 업데이트된 시그니처가 제대로 동작하지 않을 수 있습니다.
* 따라서, “우리는 SIEM이 알아서 SQL 인젝션을 다 잡아줄 것”이라고 기대하기는 **무리**입니다.

  * 여전히 **SIEM 운영자**가

    * “어떤 페이로드가 우리 서비스에 **특히 위험**한지”
    * “어떤 예외 케이스는 **정상 트래픽**인지”
  * **세심하게 룰을 설정**해야만 합니다.

#### 4) 결론: **사용자가 결국 모든 ‘공격’을 정의**해야 한다

* Request Body 로그를 수집하더라도, **자동 탐지**는 쉽지 않습니다.

  * **공격 패턴**을 명확히 정의하고,
  * **예외 상황**을 구분하며,
  * 룰(또는 시그니처) 업데이트를 **지속적으로** 관리해야 합니다.
* SIEM은 단지 **수집된 로그**를 “검색 가능한 상태”로 만들어줄 뿐,

  * “이게 SQL 인젝션이다”라는 **판단**은 **사용자가 만든 규칙**이 있어야 가능하다는 것입니다.

> **즉, “외부 도구로 Request Body까지 모두 확보했다.”**
> **“이젠 SIEM으로 SQL 인젝션을 자동으로 잡아낼 수 있겠지.”**
> → 현실은, 여전히 **사용자**가 공격 정의와 필터링 쿼리를 일일이 관리해야 한다는 **한계**가 남습니다.

---

이처럼, **Request Body·Response Body 로깅**이나 **외부 공격 시그니처**를 활용하더라도,
**SIEM이 자동으로 모든 공격을 식별**해주진 않습니다.
**사용자**가

1. **수집된 데이터를 해석**하고,
2. **공격 패턴**을 정확히 설정하며,
3. **정상·오탐 케이스**를 꾸준히 분류·보완해줘야만,
   비로소 **SQL 인젝션·XSS·RCE** 같은 공격을 어느 정도 찾아낼 수 있습니다.

즉, \*\*“웹로그 데이터를 어떻게든 모아서 SIEM에 넣기만 하면 끝”\*\*이라고 생각하면 큰 오산이고,
**체계적인 룰 설계·관리**가 뒤따르지 않으면,
결국 **“어느 게 진짜 공격 로그인지”** 스스로 검색 쿼리를 만들고
**스스로 판별**해야 하는 상황이 이어질 수밖에 없습니다.


---

### 2.2 BPFDoor 같은 고도화된 위협 식별: **SIEM 쿼리로 가능할까?**

#### 1) 커널 레벨 로그를 확보해도...

* BPFDoor 같은 커널 레벨 백도어를 탐지하려면,

  * eBPF 모니터링, 커널 후킹 탐지 도구 등 **외부 포렌식/추적 솔루션**이 필요합니다.
* 이 솔루션이 \*\*"BPFDoor 의심 이벤트"\*\*를 로깅하여 SIEM으로 보내준다고 가정해 봅시다.

#### 2) 문제는 “어떻게 검색할 것인가?”

* SIEM 내에 로그가 들어왔다 해도,

  * **“이 이벤트가 정말 BPFDoor다”** 라는 결론을 내리는 **분석 룰**(검색 쿼리, 알림 정책 등)은
  * **결국 사용자가 직접 정의**해야 합니다.
* 즉, “`WHERE event_name = 'BPFDoor'`” 같은 쿼리를 만들어야 하는데,

  * SIEM은 기본적으로 “어떤 로깅 이벤트가 BPFDoor에 해당하는지”를 **알지 못합니다.**
  * 외부 도구에서 전송해 준 이벤트 필드값에 “bpfd”가 들어있는지,
    혹은 특정 해시(signature)나 이벤트 ID를 **사용자가 인지**하고 쿼리해야만
    “BPFDoor로 의심되는 이벤트”를 찾아낼 수 있는 구조입니다.

#### 3) 결론: **여전히 ‘사용자의 정의’가 필요하다**

* 아무리 전문 포렌식 도구가 “BPFDoor 의심 징후”를 남긴다 해도,

  * SIEM에서 그 흔적을 **자동으로** “BPFDoor”로 라벨링·탐지하는 것은
  * **이미 사전에 룰을 만들어 놓았을 때만** 가능합니다.
* **사용자가 공격을 정의**(“이 패턴은 BPFDoor다”)하고,

  * **SIEM 쿼리나 코릴레이션 룰**을 설정하지 않으면,
  * 로그가 있어도 **그것이 무엇을 의미하는지** 알 수 없습니다.

---

### 2.3 DLL 인젝션 탐지: **“이 로그가 DLL 인젝션”임을 알 수 있을까?**

#### 1) DLL 인젝션 로그를 남긴다고 해도…

* ETW(Sysmon 이벤트)나 커널 후킹 기반 모듈을 써서

  * “**DLL이 특정 프로세스에 로드됐다**”라는 사실을 SIEM에 전송한다고 합시다.

#### 2) “DLL 인젝션이다”라고 **SIEM이** 알려주지 않는다

* 정작 **SIEM에 수집된 로그**는 대개 “프로세스 A가 DLL B를 로드” 정도의 형식일 것입니다.

  * 이 정보를 **DLL 인젝션 공격**으로 분류할지 여부는
  * **어떤 DLL인지**, **정상 경로인지**, **서명 정보가 있는지** 등
  * **추가 맥락(Context)을 사용자가 직접 분석**해야 합니다.
* “`WHERE dll_name = 'malicious.dll'`” 같은 쿼리를 설정한다고 해도,

  * “malicious.dll”이라는 문자열을 **미리 알고 있어야** 의미가 있습니다.
  * 새롭게 변형된 악성 DLL이라면, **사용자 정의 없이** SIEM이 자동 탐지하기 어렵습니다.

#### 3) 결국, **사용자 지식·룰**이 필수

* DLL 인젝션을 탐지하는 룰(“**이 DLL은 비정상 경로에서 로드됐다**”, “**서명 없는 DLL이 내부 프로세스에 삽입됐다**” 등)을

  * **사전에 규정**해두지 않으면
  * SIEM은 “그냥 ‘DLL 로딩 이벤트’가 있었구나” 정도로만 기록할 뿐,
  * 이를 인젝션 공격으로 **판단**해주지 않습니다.
* 결과적으로, **사용자**가

  1. **관련 로그를 얼마나 세부적으로 수집**할지,
  2. 어떤 \*\*DLL 특성을 ‘악성’\*\*으로 볼지,
  3. 탐지 쿼리나 경고 룰을 **어떻게 정의**할지를

  * 모두 결정해야 한다는 한계가 있습니다.

---

### 추가 정리: **결국 “사용자가 모든 문제를 정의”해야 하는 구조**

* BPFDoor건 DLL 인젝션이건,

  * 외부 포렌식·모니터링 도구가 **로그를 수집**해 SIEM으로 보내줄 수는 있습니다.
* **하지만** SIEM 자체는

  * “이게 정말 **어떤 위협**인지”
  * “어떤 **공격 기법**에 해당하는지”
  * “어떤 **대응**을 해야 하는지”
  * **스스로 판단**하지 못합니다.
* **사용자**가

  1. “이 이벤트 패턴을 ‘○○ 위협’이라고 명명”하고,
  2. 그에 맞춰 SIEM 쿼리·코릴레이션 규칙을 작성해야만,
  3. 비로소 SIEM이 “이상 징후 발견!”을 알릴 수 있습니다.

즉, \*\*“어떻게 쿼리를 짜야 BPFDoor나 DLL 인젝션을 찾을 수 있나?”\*\*라는 질문에 대한 답은,

* **공격 기법**과 **로그 필드**를 **사용자가 충분히 이해**하고,
* **사전 정의**(“이런 이벤트가 발생하면 BPFDoor 의심” 등)를 **반드시** 해둬야 가능하다는 것입니다.

이는 상당히 고난이도 작업이며,
**모든 공격 기법**을 **미리 규정**하고 **SIEM 룰**을 만들기엔 사실상 **인력·시간** 한계가 존재합니다.
따라서, SIEM만으로 \*\*“자동으로 모든 공격을 식별하겠다”\*\*라는 기대는

> **오버 엔지니어링**에 가깝고,
> 실제 현장에선 **거의 불가능**하다는 점을 반드시 인지해야 합니다.


---

## 3. SIEM의 본질은 **대시보드가 아니다**

### 3.1 예쁜 차트가 위협을 막아주진 않는다

* SIEM 업체들은 종종 “AI 대시보드”, “위험 점수 시각화” 등의 화려한 기능을 강조합니다.
* **하지만 시각화 자체가 위협을 자동으로 탐지해주진 않습니다.**

  * 결국 **로그 품질**과 **분석 역량**이 뒷받침되어야 의미 있는 결과가 나옵니다.

### 3.2 SIEM은 만능 보안 솔루션이 아니다

* SIEM은 어디까지나 **수집된 로그를 저장·가공·분석**하는 도구입니다.
* **무엇을 수집**하고 **어떻게 분석**할지를 명확히 정의하지 않으면,

  * SIEM은 그저 **공허한 통계화면**에 불과합니다.

---

## 4. 결론: SIEM 도입, 그 전에 해야 할 일

> **로그가 없으면 탐지도 없다**
> **룰이 없으면 분석도 없다**
> **대시보드만 있으면 보안은 그냥 ‘그림’일 뿐이다**

### 4.1 먼저, 로그 수집 체계를 정비하세요

* 웹 본문(Request/Response), OS 감사 로그, DB 감사 로그 등 **실제 공격 흔적**이 남을 만한 곳부터 우선적으로 챙겨야 합니다.
* 필요하다면 WAF나 에이전트 기반 로깅 솔루션을 도입해 **본문 캡처**도 고려할 수 있습니다.

### 4.2 분석 기준과 탐지 룰을 마련하세요

* 공격 시나리오를 구체적으로 도식화하고, **MITRE ATT\&CK**이나 내부 정책을 참고해 **탐지 규칙**을 설정합니다.
* 예) “프로세스 스폰 체인”, “DLL 인젝션” 등 고도화된 공격 시나리오는 포렌식 도구나 전문 로그(ETW, Sysmon 등)를 활용해 **정교한 룰**이 필요합니다.

### 4.3 실무자의 이해와 교육

* SIEM을 운영할 인력이 **로그 수집부터 분석**까지 전체 흐름을 숙지해야 합니다.
* “로그 유형별 활용 방법”, “이상 징후 식별 절차” 등을 **주기적으로 교육**하고,

  * 외부 컨설팅이나 전문가 도움을 받을 수 있는 체계를 마련하면 좋습니다.

---

## 5. SIEM 도입 전, 체크리스트

아래는 **SIEM 도입·운영 전** 꼭 확인해야 할 항목을 간단히 정리한 표입니다.

| 항목                 | 질문                                         | 체크 |
| ------------------ | ------------------------------------------ | -- |
| **로그 수집 범위**       | Request Body/Response Body 로깅이 필요한 시스템인가?  | □  |
|                    | DB 감사 로그, OS 감사 로그 등을 수집할 수 있는가?           | □  |
| **감사 정책(윈도우/리눅스)** | 로그인/권한 변경/프로세스 실행 기록이 남도록 설정되었는가?          | □  |
| **분석 룰·시나리오**      | MITRE ATT\&CK 등 표준 프레임워크를 참고해 탐지 룰을 정의했는가? | □  |
| **운영 책임·인력**       | 로그 분석을 수행할 전담 인력(또는 교육받은 담당자)이 있는가?        | □  |
| **자동화·성능 고려**      | 대량의 로그를 저장·분석할 인프라(스토리지, 네트워크 등)는 충분한가?    | □  |

위 항목들을 **충족**하지 않으면, SIEM을 도입해도 제대로 된 효과를 보기는 어렵습니다.

---

## ✍️ 최종 정리

1. **SIEM 도입** 자체가 보안의 골든 티켓은 아닙니다.
2. **로그 수집** 범위와 품질이 확보되지 않으면, SIEM이 무용지물이 됩니다.
3. 분석 룰과 시나리오가 없다면, 아름다운 대시보드도 그냥 ‘보여주기’에 그칩니다.
4. 결국 **인력 역량**과 **체계적인 운영**이 뒷받침되어야 SIEM이 빛납니다.

---

### 📖 함께 읽기

* [보안 로그 수집, 진짜 하고 계신가요?](https://blog.plura.io/ko/column/log-collection-reality/)
* [MITRE ATT\&CK을 활용한 탐지 룰 설계](https://blog.plura.io/ko/column/mitre_detection_rules/)
* [XDR과 SIEM의 차이점은 무엇인가요?](https://blog.plura.io/ko/column/xdr_vs_siem/)

---

