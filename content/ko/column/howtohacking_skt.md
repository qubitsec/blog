---
title: "SKT 유심 해킹 사건 총정리: 유출 원인, 피해 규모, 대응 방법까지"
date: 2025-05-03
draft: false
description: "2025년 4월 발생한 SKT 유심 정보 대규모 유출 사건의 원인과 피해 규모, 그리고 현실적인 대응 방법까지 쉽게 정리했습니다"
featured_image: "cdn/column/howtohacking_skt.png"
tags: ["SKT 해킹", "SKT 유심 유출", "유심 해킹", "SIM 스와핑", "BPFDoor", "APT 공격", "PLURA-XDR", "개인정보 유출"]
---

> **핵심 한 줄 요약**  
> 2025년 4월 18일, SK텔레콤 **HSS**(Home Subscriber Server)가 해킹되어 **최대 2,300만** 가입자의 USIM 인증 정보가 노출되었으며, SKT는 **4월 28일**에 전 고객을 대상으로 **무료 USIM 교체**를 발표했습니다.

<!--more-->

![해킹 공격 시퀀스 다이어그램](https://blog.plura.io/cdn/column/howtohacking_skt.png)

---

아래 문서는 "SKT 해킹 사건에서 BPFDoor를 설치하기 위한 주요 침투 벡터가 웹셸(WebShell)·RCE(Remote Code Execution) 중심이다"라는 가설을 전제로 작성하였습니다. 대한민국 법원 해킹 사례 등에서도 볼 수 있듯이, 망분리 환경이더라도 웹(80/443) 서비스나 SSL VPN(4500포트) 등 웹 기반 공격이 가장 효과적인 침투 경로로 활용되는 경우가 흔합니다. 물론 실제로는 계정 탈취, 내부자 악용 등의 공격 수단이 존재할 수 있으나, 본 글에서는 웹셸·RCE에 무게중심을 두고 분석을 전개합니다. 향후 새로운 증거가 나오면 이 가설 역시 수정될 수 있음을 염두에 두고 읽어주시기 바랍니다.

---

## 1. SKT 유심 해킹 사건과 BPFDoor 개요

1. **사건 요약**

   - 2025년 4월, SK텔레콤(이하 SKT) 핵심 서버인 **HSS**(Home Subscriber Server)가 해킹되어 **BPFDoor** 악성코드가 설치되었고, 대규모 유심(USIM) 가입자 정보가 탈취된 것으로 추정됨.  
   - SKT 해킹은 **중국계 APT 그룹**(Red Menshen, Earth Bluecrow, APT41 등)과 연계된 정황이 유력하며, BPFDoor는 공격자가 장기간 은밀하게 서버 내부를 장악하기 위한 **스텔스 백도어**로 활용됨.

2. **BPFDoor의 특징**

   - **커널 레벨**(BPF) 필터 활용: 일반 포트 리스닝 대신 **매직 패킷**을 수신해야만 활성화되는 **수동형 백도어**.  
   - **메모리 상주**(fileless): `/dev/shm` 등에 복사 후 원본 삭제, 프로세스 위장·백그라운드 실행 등 **은폐 기술**을 다단계로 사용.  
   - **광범위 APT 공격**에 활용: 중동·아시아 등 통신사·금융기관에서 동일한 BPFDoor 변종 보고. 이번 SKT 사건도 그런 **고도화된 공격**의 연장선으로 평가됨.

---

## 2. 웹셸(WebShell)·RCE를 통한 BPFDoor 배포: 가설적 시나리오

이 문서의 핵심 가설은 다음과 같습니다:

> **“SKT 사건에서, 공격자들은 가장 흔하고 효율적인 웹 기반 공격(웹셸·RCE)을 통해 HSS 서버 내부권한을 확보한 뒤, BPFDoor를 설치했을 가능성이 높다.”**

이는 **대한민국 법원 해킹 사례**와 같이 망분리 환경에서도 사실상 열려 있는 **80/443 웹 포트**나 VPN 서비스를 통해 내부망으로 진입하는 패턴이 흔하다는 점, 그리고 현장에서 자주 확인되는 APT 공격 흐름에 근거합니다. 또한 국내외 보고서에서도 *웹셸 또는 RCE 취약점이 전체 침투의 ‘대다수’를 차지한다*는 경험적 사실이 꾸준히 제시되고 있습니다.

### 2.1 일반적인 웹셸·RCE 공격 흐름

1. **취약점 식별**

   - 공격 대상 서버(예: WebLogic, Apache, Nginx, Tomcat, 자체 개발 웹 앱 등)에 존재하는 **공개취약점**(N-day) 또는 **0-day**를 공격자가 파악.  
   - 또는 파일 업로드 기능이 존재하고, 확장자 필터가 허술하거나 우회가 가능한 경우, **웹셸 업로드 시나리오**가 열림.

2. **원격 코드 실행(RCE) 달성**

   1) **웹셸 업로드**: `.php`, `.jsp` 같은 악성 스크립트를 업로드 → `/uploads/…` 등 경로에서 직접 호출 → 서버 내부 명령 실행.  
   2) **RCE 취약점 이용**: Log4Shell, WebLogic RCE, 역직렬화 취약점 등으로 **HTTP 요청**만으로 바로 OS 명령어 실행.

   - 이 단계에서 공격자는 낮은 권한(www-data, tomcat 등)으로도 서버에 진입할 수 있게 됨.

3. **권한 상승 및 백도어 설치**

   - *sudo misconfig*, *커널 취약점*, *권한 상승 툴* 등을 이용해 **root 권한** 획득.  
   - 확실한 재진입 통로를 확보하기 위해, **BPFDoor**와 같은 고급 백도어를 심음.  
   - SKT 사례에서는 백도어가 `kdmtmpflush` 등 이름으로 `/dev/shm`에 상주, 원본 삭제로 은폐.

4. **지속적 침투**

   - BPFDoor는 외부에서 특별한 매직 패킷을 수신해야만 활성화되는 수동형 C2 방식으로 은밀히 운영 → 장기간 서버 장악.  
   - 이후 HSS DB 쿼리, 대량 유심 정보 탈취, 다른 내부 서버로 횡적 이동.

---

## 3. 왜 웹셸·RCE가 핵심인가?

1. **공격자 입장에서 가장 손쉬운 초기 진입**

   - 통상 기업망에서 **웹 서비스**는 외부에 노출되어 있고, 프레임워크·플러그인·파일 업로더 등 공격 표면이 넓음.  
   - 패치가 미비하거나 취약점이 새로 공개되면, **자동화 스캐너**로 수많은 표적을 신속히 탐색해 한꺼번에 침투 가능.

2. **웹셸 vs. RCE, 결과는 동일: 서버 장악**

   - **웹셸**: 업로드 취약점을 통해 `.jsp` 파일 등 실행 가능 스크립트를 배치 → 웹서버 권한으로 명령어 실행.  
   - **RCE**: 업로드 없이도 특정 취약점(PHP deserialization, Log4j, WebLogic 등)으로 곧바로 명령 실행.  
   - 한 번이라도 서버 명령어(shell)를 획득하면, **BPFDoor** 같은 백도어 설치가 매우 간단.

3. **망분리 환경에서도 80/443 포트는 열려 있음**

   - 예컨대 **2023년 5월 발생한 대한민국 법원 해킹 사례**를 보면, 망분리된 환경에서도 DMZ를 통해 내부로 접속하기 위해서는 **80, 443** 등 웹 포트가 필수적으로 열려 있었다고 합니다.  
   - IPSec VPN 서비스(포트 4500) 역시 대부분 웹 서비스(SSL VPN 형태)처럼 동작하기도 하여, 공격자 입장에선 **결국 “웹 트래픽”만이 열려 있는 유일한 통로**가 됩니다.  
   - 이런 상황에서 RCE·웹셸 공격이 성공하면 **측면이동**(Lateral Movement)으로 계속 깊숙이 내부망에 침투할 수 있습니다.

4. **피해 스케일 확장**

   - 특히 통신사·금융기관 등은 수십~수백 대의 웹 서버를 운영 → 공격 표면 다수.  
   - 방화벽·VPN 관제보다도, 웹서비스는 잦은 업데이트가 필요해 **취약점 패치 누락**이 빈번할 수 있음.  
   - 실제 침해사고 현장에서도 “웹셸로 시작” 혹은 “RCE로 한 번에 뚫림”이 대다수 사례를 차지한다는 보고 많음.

---

## 4. 구체적 BPFDoor 설치 시나리오 (웹 기반 가정)

아래는 이번 SKT 사건에 대해 **가설적**으로 구성한 웹셸·RCE 중심 시나리오입니다. 실제 침해경로가 다를 수 있으나, “웹 공격이 주력”이라는 가정 아래 보면 일관성이 높습니다.

1. (가정) **WebLogic, Tomcat, 혹은 자체 웹앱 취약점**

   - HSS 관리 혹은 관련 웹 서버(운영·개발용 등) 중 하나가 **취약 버전**이었다고 가정.  
   - 공격자가 자동 스캔 후, `curl -F file=@shell.jsp …` 같은 방식으로 웹셸을 업로드하거나, RCE 익스플로잇을 사용.  

2. **Low-privilege 셸 획득**

   - 웹서버 계정(tomcat, www-data) 권한으로 시스템 내부에 진입.  
   - 공격자: `uname -a`, `cat /etc/passwd` 등으로 환경 탐색 → 추가 권한 상승 루트 파악.

3. **Root 권한 확보**

   - SUID 파일, 커널 버그, sudo misconfig 등 악용 → root 권한 상승.  
   - 이제 BPFDoor 설치가 가능(커널 소켓 필터 등록에는 높은 권한 필요).

4. **BPFDoor 업로드 & 실행**

   - `/dev/shm/kdmtmpflush` 등 임시 디렉터리에 복사 → 원본 파일 삭제.  
   - 백도어 프로세스가 부모 프로세스와 분리되며 메모리에 상주.  
   - BPF 필터 세팅 → “매직 패킷”이 올 때만 셸 연결을 열어둠.

5. **HSS DB 접근 및 자료 탈취**

   - BPFDoor를 통해 공격자가 언제든 재접속 가능.  
   - HSS 내부 DB(유심 인증키, 가입자 IMSI 등)에 대량 쿼리 → 결과 파일 유출.  
   - 최종적으로 SKT 고객 유심 정보 대규모 노출 사태 발생.

---

## 5. MITRE ATT&CK 매핑 (웹셸·RCE 기반)

- **Initial Access (TA0001)**:  
  - *Exploit Public-Facing Application (T1190)*: 웹 RCE 취약점 공격  
  - *Drive-by Compromise (T1189)* 혹은 *WebShell Upload (하위 T1190 사례)*  

- **Execution (TA0002)**:  
  - *Command-Line Interface (T1059.004)*: 웹셸 호출 시, `shell_exec()` 등으로 실제 OS 명령어 구동  

- **Persistence (TA0003)**:  
  - 웹셸 자체는 HTTP 요청만 있으면 재실행 가능. BPFDoor는 별도 디스크 등록 없이 메모리에 상주  

- **Privilege Escalation (TA0004)**:  
  - *Exploitation for Privilege Escalation (T1068)*: 커널 취약점, SUID, sudo misconfig 등  

- **Defense Evasion (TA0005)**:  
  - 웹셸: 파일 확장자 우회, MIME 헤더 위장.  
  - BPFDoor: 파일 삭제(T1070.004), 타임스템핑(T1070.006), 프로세스 위장(T1036) 등.  

- **Command and Control (TA0011)**:  
  - BPFDoor: Traffic Signaling(T1205.002), Non-standard port(T1571), Encrypted Channel(T1573).  

- **Exfiltration (TA0010)**:  
  - 공격자 셸(웹셸 or BPFDoor 역방향 셸)에서 DB 파일을 압축·전송.

---

## 6. 보안팀을 위한 대응 전략 (웹 공격 관점)

1. **웹 애플리케이션 보안강화**

   - **파일 업로드 제한**: 실행 확장자·MIME 필터링, 업로드 디렉터리에 ‘실행권한 제거’를 기본 설정.  
   - **RCE 취약점 패치**: WebLogic, Tomcat, Apache, 각종 CMS·플러그인 등 업데이트 모니터링. N데이 노출 즉시 패치.

2. **WAF(Web Application Firewall)**

   - 웹셸·RCE 시그니처 차단, HTTP 패러미터 검증, 파일 업로드 요청 검사.  
   - Zero-day 공격에도 대응 가능한 **행위 기반 룰**(명령어 패턴 탐지) 적용.

3. **서버 최소권한·하드닝**

   - 웹서버 계정은 root가 아닌 전용 계정으로 실행, SELinux/AppArmor 등으로 프로세스 권한 최소화.  
   - SUID/GUID 파일 점검, `sudoers` 설정 최소화.  
   - `/dev/shm` 등 임시 디렉터리에 **noexec 옵션** 검토(가능하면 마운트 옵션으로 실행 차단).

4. **BPFDoor 탐지 및 차단**

   - IDS/IPS/NDR에 BPFDoor IOC 시그니처 등록 (매직 바이트, C2 IP 등).  
   - Host EDR로 `/dev/shm` 의심 바이너리·이상 프로세스 모니터링.  
   - Auditd/Sysmon for Linux에서 `socket()` + `setsockopt(SO_ATTACH_FILTER)` 호출을 상시 로그.

5. **침해사고 대응 프로세스 확립**

   - 웹셸 혹은 RCE가 의심되는 경우 **즉각 격리** 후 메모리 포렌식으로 BPFDoor 같은 백도어 탐색.  
   - **사후 포렌식** 통해 DB 접근 내역, 탈취 규모 파악 → 피해자(고객) 보호조치, 재발방지 대책.

---

## 7. PLURA-XDR 정보보안 통합 플랫폼: 웹 요청 본문 분석을 통한 추가 방어

앞서 제시한 **웹 공격 대응 전략**(웹 애플리케이션 보안강화, WAF 활용, 서버 하드닝, BPFDoor 탐지/차단, 침해사고 대응 프로세스 확립)만으로도 기본적인 방어 체계를 구축할 수 있습니다. 그러나 최근 APT 공격에서는 **웹 요청을 교묘히 위장**하거나 **파일 업로드를 암호화**하여 전통적 규칙 기반 솔루션(WAF, IPS)을 우회하는 사례가 많아졌습니다. 이때 **웹 요청 본문(HTTP Body) 분석**까지 수행하는 **PLURA-XDR** 같은 통합 보안 플랫폼이 큰 도움이 될 수 있습니다.

### 7.1 PLURA-XDR의 핵심 기능

1. **다계층 이벤트 연계(Extended Detection & Response)**

   * PLURA-XDR는 **네트워크, 엔드포인트, 클라우드, 웹 트래픽** 등 다양한 이벤트를 통합 분석하여, **단편적 징후**가 아닌 **행위 기반(Behavior-based) 상관관계**로 공격을 식별합니다.
   * 예: 웹서버의 HTTP Body 이상행위 + `/dev/shm` 내 악성 파일 실행 + 특정 C2 IP 접속이 연쇄적으로 감지되면, **고위험 공격**이라고 바로 판단해 알림을 발생시킵니다.

2. **HTTP Body/Payload 고급 분석**

   * 일반적인 WAF/IPS는 **URI, 헤더, 쿠키** 위주로 검사하지만, PLURA-XDR는 **HTTP Body**(파일 업로드, POST 데이터) 내용을 심층 분석해 **의심 명령어, 웹셸 코드를 식별**할 수 있습니다.
   * 예: Base64로 인코딩된 JSP 웹셸 스니펫이 Body에 포함되어 있는지, 스크립트로 의심되는 난독화 문자열이 있는지 **AI·패턴 매칭**을 결합해 실시간 탐지.

3. **Zero-day 위협 탐지(행위 기반 룰)**

   * 시그니처 기반 방식을 넘어서, *“POST 바디에 쉘 명령어 패턴이 보임”*, *“업로드된 파일 내부에 JSP/PHP 문법”* 등 **행위형 룰**을 설정 가능.
   * 웹셸·RCE 취약점이 알려지지 않았더라도, PLURA-XDR는 **명령 패턴/프로세스 실행 흐름**에서 이상 징후를 탐지해 선제적으로 차단할 수 있습니다.

4. **자동 대응(Automated Response)**

   * 위험도가 높은 이벤트(예: `shell.jsp` 업로드 시도 + 서버 내부 쉘 실행) 감지 시, PLURA-XDR가 **자동으로 IP 차단**, **프로세스 격리**, **알림 발송** 등을 수행.
   * 별도의 보안 인력이 24시간 모니터링하기 어려운 환경에서도 **즉각적 방어**를 제공.

### 7.2 웹 요청 본문 분석이 중요한 이유

* **파일 업로드 기반 웹셸**: 일반 WAF가 확장자 `.jsp`, `.php`만 검사한다면, 공격자는 `.jpg` 등으로 위장 + Body 내용에 JSP 코드를 넣어 통과할 수 있습니다. PLURA-XDR는 실제 Body 내부를 열어, **스크립트/명령어 패턴**을 탐지할 수 있음.
* **복잡한 RCE 페이로드**: 공격자들은 Log4Shell 같은 취약점을 노릴 때, 요청 본문에 JNDI URL이나 역직렬화 페이로드를 숨겨 전송합니다. 이때 PLURA-XDR는 **다단계 분석**을 통해 Request Body에 숨어 있는 조작된 객체, 난독화 문자열 등을 인지.
* **HTTP/2, SSL, HTTP Chunked 등** 다양한 프로토콜 변형에도 대응: PLURA-XDR가 **SSL/TLS 트래픽 복호화** 및 HTTP 스펙 변형 처리까지 제공하면, 공격자가 특수 인코딩을 이용한 우회 시도를 줄일 수 있습니다.

### 7.3 PLURA-XDR 도입 시 기대 효과

1. **웹셸·RCE 실시간 감지 및 차단**

   * 기존 WAF와 달리, **심층 본문 분석 + 행위 기반 룰**을 결합하여 의심스러운 업로드, 특정 명령어 삽입 시나리오를 곧바로 차단.
   * 웹셸이 업로드되더라도, PLURA-XDR가 서버 엔드포인트(EPP/EDR)와 연계해 프로세스 실행을 실시간 모니터링하므로, 추가적 루트 권한 상승 시도도 탐지.

2. **BPFDoor 같은 은밀한 백도어 탐지**

   * BPFDoor는 커널 레벨 BPF 소켓 필터를 사용하지만, **결국 C2 통신**은 ICMP/TCP를 통해 발생. PLURA-XDR가 **네트워크 트래픽 + 호스트 프로세스 활동**을 통합 시나리오로 분석하여 은밀한 C2를 드러낼 수 있음.
   * 예: `iptables` 규칙이 순간적으로 변경되고(Host EDR 이벤트), 직후 특정 ICMP Ping에 패킷이 삽입되는 흐름(Network D\&R 이벤트)을 연계 인지.

3. **종합 위협 인텔리전스 적용**

   * PLURA-XDR는 \*\*보안 정보(SIEM), 위협 인텔리전스(Threat Intelligence)\*\*를 통합 관리하므로, BPFDoor IOC(매직 바이트, C2 IP 등)나 최신 RCE 익스플로잇 패턴을 자동 업데이트해 공격을 더 빠르게 방어할 수 있음.

4. **자동화된 포렌식 및 보고**

   * 침해사고가 의심되는 시점에서 PLURA-XDR 콘솔에서 \*\*관련 이벤트(HTTP 요청, 파일 실행, 프로세스 생성, 네트워크 연결)\*\*를 자동으로 수집·시각화.
   * 사고 직후 신속히 공격 경로를 재현하고, 유출 범위를 추산할 수 있어 대응 시간을 크게 단축.

### 7.4 요약: PLURA-XDR로 웹 공격 방어 체계 업그레이드

* **PLURA-XDR**는 기존의 WAF, IPS, EDR 등을 한데 묶는 통합 플랫폼으로, **웹 요청 본문 분석** 같은 고급 기능을 통해 **웹셸·RCE** 공격을 정밀 차단한다.
* 특히 망분리 환경에서도 80/443 포트가 열려 있다면(대한민국 법원 해킹 사례처럼), **PLURA-XDR가 웹 트래픽을 철저히 검사**함으로써 침입 루트를 봉쇄할 수 있다.
* **추가적인 커널·엔드포인트 모니터링**(BPFDoor·root킷 탐지), **자동화된 Incident Response**(IP 차단, 프로세스 격리) 기능까지 제공하므로, APT급 공격에 강력한 방어 효과를 기대할 수 있다.

---

> **결론적으로**, PLURA-XDR와 같은 **정보보안 통합 플랫폼**을 통해 \*\*웹 트래픽 본문 분석(Body Inspection)\*\*을 수행하면, 웹셸·RCE 공격의 숨은 페이로드를 찾기 수월해지고, 실제 서버 내부에서 발생하는 \*\*행위(백도어 설치, 시스템 명령어 호출)\*\*까지 연동 관제할 수 있습니다. 이는 SKT 해킹 사건처럼 **BPFDoor 등 고도화된 APT 공격**을 막는 실질적 방어력으로 이어질 것입니다.

---

## 8. 결론

- **이번 SKT 해킹 사례**를 웹 공격(웹셸·RCE) 중심으로 해석하면, 공격자는 **인터넷 노출된 웹 서비스**를 발판 삼아 HSS 서버에 침투하고, **BPFDoor**를 설치하여 장기 거점을 확보했을 개연성이 높습니다.  
- **망분리 환경에서도 80/443 웹 포트는 거의 유일한 통로**: 대한민국 법원 해킹 사례처럼, DMZ에서 내부망으로 향하는 연결은 웹서비스(80/443)나 VPN(4500) 정도만 열려있는 경우가 많습니다. 이는 공격자가 **웹셸·RCE**를 노려 침투·측면이동하는 주요 원인이 됩니다.  
- **BPFDoor는 후속 은닉 수단**: 웹 기반 초기 침투로 얻은 저권한 셸을 통해 root 권한을 획득한 뒤, BPFDoor를 투입해 **스텔스성**과 **장기성**을 극대화한 것입니다.

> **가설적 결론**:  
> 1) SKT HSS 서버는 **웹셸 or RCE**를 통한 초기 장악 후,  
> 2) **BPFDoor**로 은밀히 C2를 구축,  
> 3) USIM/가입자 데이터 탈취로 이어졌을 가능성이 매우 높다.  
> 다른 경로(계정 탈취, 내부자 연루 등)도 배제할 수 없지만, **웹 공격이 가장 흔한 침투 벡터**임을 고려하면, 본 시나리오는 충분히 합리적이다.

> **향후 검증 필요성**:  
> - 실제 로그·포렌식 정보가 추가 공개돼야 최종 경로를 확정 지을 수 있으나,  
> - **기업망 침해사고의 절대다수는 웹 공격**이라는 업계 경험칙을 고려하면, 본 가설이 맞을 확률은 상당히 높다고 할 수 있음.

---

### 최종 제언

- **웹셸 및 RCE** 공격이 **대규모 침해사고의 주력 통로**라는 전제하에, 기업·기관은 **웹 취약점 관리, 파일 업로드 통제, WAF 운영** 등을 최우선 보안과제로 삼아야 합니다.  
- 침입 이후 **BPFDoor** 같은 스텔스 백도어가 설치되면 탐지·차단이 매우 까다로우므로, **초기 진입 자체를 봉쇄**하는 것이 가장 효과적인 방법입니다.  
- 만일 침입이 감지되면 **메모리 기반 포렌식** 및 **행위 모니터링**을 통해 BPFDoor나 유사 악성코드 은닉을 철저히 수색해야 합니다.  
- 이번 SKT 사건을 교훈 삼아, **중요 서버**(특히 통신·금융·공공 등 기간망)에 대한 웹 공격 방어와 리눅스 보안 강화가 시급하다는 점을 재확인해야 합니다.

---

---

### 📺 함께 시청하기
* [BPFDoor 공격, 어떻게 침투하는가? | PLURA 실시간 탐지 시연](https://www.youtube.com/watch?v=bzGv1AwHy9k)

### 📖 함께 읽기
* [SKT 유심 해킹 사건 총정리: 유출 원인, 피해 규모, 대응 방법까지](https://blog.plura.io/ko/column/leak_of_skt_usim/)  
* [SKT 해킹 악성코드 BPFDoor 분석 및 탐지 시연 영상 (PLURA-XDR 대응 전략 포함)](https://blog.plura.io/ko/respond/bpfdoor/)  
* [SKT 해킹으로 본 NDR 기술 한계: BPFDoor 같은 스텔스 공격 대응법](https://blog.plura.io/ko/column/limitations-ndr-bpfdoor/)  
