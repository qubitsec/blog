---
title: "SSL VPN 취약점 공격 및 Ivanti 대응 전략"
date: 2025-05-05
draft: false
description: "SKT 유심 해킹 사건에 사용된 BPFDoor 사례를 통해 NDR 기술의 한계를 분석하고, 스텔스 공격을 효과적으로 대응할 수 있는 현실적 방안을 정리했습니다"
featured_image: "cdn/column/limitations-ndr-bpfdoor.png"
tags: ["SKT 해킹", "BPFDoor", "NDR 한계", "스텔스 공격", "네트워크 보안", "IDS", "IPS", "Symbiote", "LummaC2", "PLURA-XDR"]
---

# 📘 SSL VPN 취약점 공격 및 Ivanti 대응 전략

## 0. 배경: 2023년 5월 법원 해킹부터 2025년 SKT 해킹까지

**SSL VPN 취약점 공격**은 2023년 5월 **법원 해킹 사건**에서 본격적으로 주목받기 시작했습니다. 당시 공격자들은 **SSL VPN 솔루션의 인증 우회 취약점**을 이용해 내부망에 침투한 뒤, 중요 데이터를 무단 열람하는 데 성공했습니다. 그 후 2024년까지 Ivanti(구 Pulse Secure), FortiGate 등 주요 SSL VPN 제품군에서 **여러 차례 제로데이 취약점**이 보고되었고, 결국 2025년에는 **SKT 해킹 사건**에서 Ivanti 취약점이 다시금 악용되었습니다.

> **중요성**  
> - SSL VPN은 기업 외부와 내부망을 연결하는 **경계 지점**으로, 공격자가 장악할 경우 내부 전산망 전반에 영향을 미칠 수 있습니다.  
> - 특히 Ivanti는 **인증 우회(RCE)** 등 중대한 취약점이 연속적으로 발견되어, **제로데이 공격의 주 타겟**이 되었습니다.

---

## 1. 공격 시나리오 흐름

| 단계        | 설명                                 | 예시                              |
| --------- | ---------------------------------- | -------------------------------- |
| **1. 초기 접근**  | SSL VPN 인증 우회 취약점 또는 RCE 스캔               | `/dana-na/`, `/remote/fgt_lang`  |
| **2. 취약점 이용** | 디렉토리 트래버설, 명령 주입, 임의 파일 열람 등            | `cmd=ping;cat+/etc/passwd`       |
| **3. 웹셸 업로드** | 업로드 경로에 `.jsp`, `.php` 등 삽입                 | `/portal/uploads/shell.jsp`      |
| **4. 명령 실행**  | 웹셸 혹은 직접 명령 주입으로 서버 권한 탈취               | `bash -i`, `curl`, `whoami` 등    |
| **5. 백도어 설치** | **BPFDoor** 등 스텔스 백도어 설치 후 상주화             | `nohup ./bpfd &`                 |

위 시나리오는 **2023년 법원 해킹** 당시에도 사용됐으며, **SKT 해킹**에서도 유사한 흐름이 반복되었습니다.

---

## 2. PLURA-XDR 관점에서 본 탐지 포인트

다른 보안 솔루션(WAF, IDS 등)을 따로 운영하기 어려운 환경이라도, **PLURA-XDR** 하나만으로 **네트워크 트래픽 + 시스템 행위** 전반을 모니터링할 수 있습니다. 아래는 PLURA-XDR에서 주로 포착할 수 있는 탐지 포인트입니다.

### A. PLURA-XDR 네트워크 모듈(패킷 기반 탐지)

| 항목                 | 예시                                           | 설명                                         |
| ------------------ | -------------------------------------------- | ------------------------------------------ |
| **비정상 URL 접근**     | `/dana-na/`, `/remote/fgt_lang?...`          | Ivanti·FortiGate VPN 관련 취약 경로 자동 탐지                |
| **POST 내 웹셸 패턴**   | 업로드 경로에 `*.jsp`, `*.php` 존재 시 경고              | 웹셸 업로드 시도 여부 실시간 파악                           |
| **명령 주입 시그니처**  | 패킷에 `bash -i`, `wget`, `base64` 등의 키워드 포함       | 쉘 명령 전송·수신 로그를 **실시간** 분석해 공격 여부 판단             |
| **User-Agent 이상**  | `python-requests`, `curl/`, `Go-http-client` 등  | 자동화 스크립트(봇)에 의한 무차별 대입/스캐닝 시도 신호                 |

- **PLURA-XDR**는 L7 레벨의 상세 트래픽까지 분석하므로, SSL VPN 트래픽에서 **의심스러운 패턴**이 감지되면 빠르게 알림/차단을 수행합니다.

### B. PLURA-XDR 에이전트(시스템 기반 탐지)

| 항목               | 예시                                        | 설명                                            |
| ---------------- | ----------------------------------------- | --------------------------------------------- |
| **비정상 프로세스**   | `/dev/shm/bpf*`, `bpfd` 등                | BPFDoor, Symbiote 등 스텔스 백도어 프로세스 실행 추적             |
| **악성 파일 생성**   | `/tmp/shell.php`, `/data/tmp/suspect.sh` | 웹셸/스크립트 생성 시도 실시간 알림                          |
| **명령 실행 모니터링** | `execve("/bin/bash")`, `curl`, `whoami` 등    | Ivanti 장비나 리눅스 서버에서 일어나는 **불필요 명령 실행**을 감지 및 이력 추적  |
| **네트워크 연결**    | `netstat`, `ss` 결과를 상시 모니터링              | 리버스 쉘 연결, 비인가 IP 접속 등을 **PLURA-XDR 콘솔**에서 한눈에 확인 |

- **에이전트 설치**가 어려운 Ivanti VPN 장비는 **에이전트리스(Agentless) 모듈**을 통해 Syslog, SSH 접근 로그를 수집할 수 있습니다.

---

## 3. PLURA-XDR 탐지 구조 (Mermaid 다이어그램)

아래 다이어그램은 **PLURA-XDR** 기반의 SSL VPN 공격 탐지 구조를 간략히 나타냅니다.

```mermaid
graph TD
  외부공격자 -->|SSL VPN 취약점 공격| Ivanti장비
  Ivanti장비 -->|네트워크 로그| PLURA-XDR(NTA)
  Ivanti장비 -->|Syslog 등| PLURA-XDR(Agentless)
  PLURA-XDR(NTA) --> PLURA-XDR(Server)
  PLURA-XDR(Agentless) --> PLURA-XDR(Server)
  PLURA-XDR(Server) -->|이상행위 및 패턴 분석| 관리콘솔
  관리콘솔 -->|공격 탐지 시| 알림/대응
````

* **NTA(Network Traffic Analysis)** 모듈과 **Agentless**(또는 Agent) 방식을 결합하여, Ivanti 장비의 **내부·외부 트래픽**과 **시스템 이벤트**를 중앙 분석합니다.

---

## 4. PLURA-XDR 기반 대응 기술

| 구분                    | 설명                                                                                      |
| --------------------- | --------------------------------------------------------------------------------------- |
| **네트워크 트래픽 분석**       | SSL VPN 트래픽 내 **의심 URL**, **명령어 주입 패턴**, **수상한 User-Agent** 등을 **PLURA-XDR**에서 실시간 식별   |
| **에이전트 기반 행위 감시**     | 시스템 내부에서 **새 프로세스 실행**, **비정상 파일 생성**, **백도어 통신** 등 발생 시 즉시 경고                          |
| **IoC 연동**            | **PLURA-XDR 위협 인텔리전스** 모듈을 통해 SSL VPN 취약점 관련 **CVE**, **악성 도메인**, **파일 해시** 정보를 상시 업데이트 |
| **자동화된 대응(Playbook)** | 의심 프로세스 발견 시 **즉시 격리**, 특정 IP로부터의 접근 **자동 차단** 등 **SOAR** 수준의 자동화된 사고 대응 수행             |

> **중요 포인트**:
>
> * PLURA-XDR는 **웹 트래픽 분석 + 내부 행위 감시**를 동시에 수행하므로, 공격자가 **VPN**을 통해 진입 후 **백도어**를 설치하거나 **추가 측면 이동**을 하는 순간까지 **모두 추적**이 가능합니다.
> * Ivanti 장비에 대한 **특화된 룰셋**도 제공되며, 신규 취약점(CVE) 정보가 발표될 때마다 **PLURA-XDR**에서 자동 룰 업데이트가 가능합니다.

---

## 5. 최근 SSL VPN 취약점 사례 (Ivanti 중심)

| CVE ID             | 설명                                                   |
| ------------------ | ---------------------------------------------------- |
| **CVE-2019-11510** | 인증 우회 → 내부 파일 유출, Ivanti(구 Pulse Secure) 대표 취약점 중 하나 |
| **CVE-2023-46805** | 인증 우회 → 로그인 없이 내부 리소스 접근 가능                          |
| **CVE-2024-21887** | 명령 주입 → 관리자 권한 RCE (예상 공개, Ivanti 관련 고위험군)           |

> **PLURA-XDR**는 위 취약점을 비롯해 **SSL VPN 제로데이**가 보고될 때마다 **IoC & 룰**을 신속히 업데이트하며, **자동 차단** 옵션을 제공해 즉시 방어가 가능합니다.

---

## 6. PLURA-XDR에서의 탐지 룰 예시

### A. 웹 요청 중 'dana-na' 경로 + 쉘 명령 추적

```json
{
  "plura_rule": {
    "name": "Ivanti-dana-NA shell command injection",
    "condition": "url.path CONTAINS 'dana-na' AND request.body MATCHES '(curl|bash|cat|wget|whoami)'",
    "action": "alert_and_block"
  }
}
```

> * Ivanti의 `/dana-na/` 경로에서 **`curl`, `bash` 등** 쉘 명령 문자열을 감지하면, PLURA-XDR가 자동으로 차단/알림을 수행합니다.

### B. 백도어 파일 생성 알림

```json
{
  "plura_rule": {
    "name": "Detect Potential BPFDoor File Creation",
    "condition": "file.path MATCHES '.*(bpf|bpfd|.php|shell.jsp).*'",
    "action": "alert"
  }
}
```

> * BPFDoor, 웹셸 등 **비정상 파일 생성** 패턴을 **PLURA-XDR 에이전트**가 감지하면 즉시 관리자에게 알림을 보냅니다.

---

## 7. 운영 및 대응 전략 (PLURA-XDR 기반)

| 영역                  | 주요 실무 지침                                                                      |
| ------------------- | ----------------------------------------------------------------------------- |
| **패치 관리**           | Ivanti 장비는 **즉각적인 보안 패치** 및 PLURA-XDR 룰 업데이트가 필수                              |
| **PLURA-XDR 정책 튜닝** | VPN 장비 트래픽·시스템 로그가 **정상/비정상** 구분 가능하도록 **맞춤형 정책**을 적용                         |
| **다중 인증(2FA)**      | SSL VPN 접속 시 **OTP·SMS** 등 2차 인증을 적용, PLURA-XDR Access Log 분석과 연계             |
| **침해지표(IoC) 활용**    | PLURA-XDR **위협 인텔리전스**와 연동해, **웹셸 파일명·악성 C2 IP** 등을 **자동 차단**                 |
| **사고 대응 시나리오**      | **법원 해킹**, **SKT 해킹**과 유사한 공격 재현 테스트를 통해 PLURA-XDR **Playbook** 자동화 대응을 정기 점검 |

---

## 8. 결론 및 권고

1. **2023년 법원 해킹 사건**에서 시작된 SSL VPN 취약점 공격은, 2025년 **SKT 해킹**까지 이어지며 지속적으로 **기업 핵심 인프라**를 위협하고 있습니다.
2. 특히 **Ivanti(구 Pulse Secure)** 제품군은 최근에도 **제로데이**가 보고될 만큼 공격 표면이 넓으므로, **PLURA-XDR** 같은 통합 보안 플랫폼을 통해 **상시 모니터링**해야 합니다.
3. **PLURA-XDR**는 네트워크 트래픽 + 시스템 행위를 **동시** 감지·분석할 수 있으므로, **VPN을 통한 침투**에서 **백도어 설치**, **내부망 확산**까지 **전(全) 단계**에 걸쳐 탐지·대응이 가능합니다.
4. **패치**와 **보안 정책**을 강화하되, **실시간 모니터링**과 **자동화된 침해 대응**(Playbook)이 결합돼야 **연쇄 공격**을 막을 수 있습니다.

---

> **문의 / 추가정보**
>
> * PLURA-XDR 공식 사이트: [https://www.plura.io/](https://www.plura.io/)
> * 기술지원: [plura@qubitsec.com](mailto:plura@qubitsec.com)
> * 자료 요청: PDF / HTML / Markdown 버전 모두 가능

위 내용이 **법원 해킹(2023)부터 SKT 해킹(2025)으로 이어지는 SSL VPN 취약점 공격**과
**Ivanti 대응 전략**을 이해하고, **PLURA-XDR**를 활용해 **효과적으로 방어**하는 데 도움이 되길 바랍니다.
