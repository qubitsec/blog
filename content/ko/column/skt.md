---
title: "SKT 해킹 가설: 유심 데이터 탈취와 BPFDoor 설치, 어떻게 이뤄졌나?"
date: 2025-05-03
draft: false
description: "2025년 4월 발생한 SKT 유심 정보 대규모 유출 사건을 중심으로, 웹셸·RCE 공격 가설과 BPFDoor 백도어의 침투 시나리오, 그리고 실제 적용 가능한 대응 방안을 쉽게 정리했습니다."
featured_image: "cdn/column/skt-hacking-hypothesis.png"
tags: ["SKT 해킹", "SKT 유심 유출", "유심 해킹", "RCE 취약점", "웹셸 공격", "BPFDoor", "APT 공격", "PLURA-XDR", "개인정보 유출", "망분리 해킹"]
---

> **핵심 한 줄 요약**  
> 2025년 4월 18일, SK텔레콤 **HSS**(Home Subscriber Server)가 해킹되어 **최대 2,300만** 가입자의 USIM 인증 정보가 노출되었으며, SKT는 **4월 28일**에 전 고객을 대상으로 **무료 USIM 교체**를 발표했습니다.

<!--more-->

![SKT 해킹 공격 시퀀스 다이어그램 예시](https://blog.plura.io/cdn/column/skt-hacking-hypothesis.png)

---

아래 문서는 "**SKT 해킹 사건에서 BPFDoor를 설치하기 위한 주요 침투 벡터가 웹셸(WebShell)·RCE(Remote Code Execution) 중심이다**"라는 가설을 전제로 작성하였습니다. **대한민국 법원 해킹 사례** 등에서도 볼 수 있듯이, 망분리 환경이더라도 웹(80/443) 서비스나 SSL VPN(4500포트) 등 **웹 기반 공격**이 가장 효과적인 침투 경로로 활용되는 경우가 흔합니다. 물론 실제로는 계정 탈취, 내부자 악용 등의 공격 수단이 존재할 수 있으나, 본 글에서는 **웹셸·RCE**에 무게중심을 두고 분석을 전개합니다. 향후 새로운 증거가 나오면 이 가설 역시 수정될 수 있음을 염두에 두고 읽어주시기 바랍니다.

---

## 1. SKT 유심 해킹 사건과 BPFDoor 개요

### 1.1 사건 요약
- 2025년 4월, SK텔레콤(이하 SKT) 핵심 서버인 **HSS(Home Subscriber Server)**가 해킹되어 **BPFDoor** 악성코드가 설치되었고, 대규모 유심(USIM) 가입자 정보가 탈취된 것으로 추정됨.  
- SKT 해킹은 **중국계 APT 그룹**(Red Menshen, Earth Bluecrow, APT41 등)과 연계된 정황이 유력하며, BPFDoor는 공격자가 장기간 은밀하게 서버 내부를 장악하기 위한 **스텔스 백도어**로 활용됨.

### 1.2 BPFDoor의 특징
- **커널 레벨(BPF) 필터** 활용: 일반 포트 리스닝 대신 **매직 패킷**을 수신해야만 활성화되는 **수동형 백도어**.  
- **메모리 상주(fileless)**: `/dev/shm` 등에 복사 후 원본 삭제, 프로세스 위장·백그라운드 실행 등 **은폐 기술**을 다단계로 사용.  
- **광범위 APT 공격**에 활용: 중동·아시아 등 통신사·금융기관에서 동일한 BPFDoor 변종이 확인되었다는 보고가 있으며, 이번 SKT 사건도 그런 고도화된 공격의 연장선으로 평가됨.

---

## 2. 웹셸(WebShell)·RCE를 통한 BPFDoor 배포: 가설적 시나리오

이 문서의 핵심 **가설**은 다음과 같습니다:

> **“SKT 사건에서, 공격자들은 가장 흔하고 효율적인 웹 기반 공격(웹셸·RCE)을 통해 HSS 서버 내부권한을 확보한 뒤, BPFDoor를 설치했을 가능성이 높다.”**

이는 **대한민국 법원 해킹 사례**와 같이 망분리 환경에서도 사실상 열려 있는 **80/443 웹 포트**나 VPN 서비스를 통해 내부망으로 진입하는 패턴이 빈번하고, 국내외 APT 보고서에서 *웹셸/RCE 취약점이 전체 침투의 ‘대다수’*를 차지한다는 경험적 사실을 근거로 합니다.

### 2.1 일반적인 웹셸·RCE 공격 흐름

1) **취약점 식별**  
   - 공격 대상 서버(예: WebLogic, Apache, Nginx, Tomcat, 자체 웹 앱 등)에 존재하는 **공개취약점(N-day)** 또는 **0-day**를 공격자가 파악.  
   - 파일 업로드 기능이 허술한 경우 **웹셸 업로드** 시나리오가 열림.

2) **원격 코드 실행(RCE) 달성**  
   - **웹셸 업로드**: `.php`/`.jsp` 등 스크립트를 삽입해 서버 내부 명령 실행.  
   - **RCE 취약점**: Log4Shell, WebLogic RCE 등으로 **HTTP 요청**만으로 OS 명령어 실행 가능.  
   - 이 단계에서 공격자는 **낮은 권한**(www-data, tomcat 등)으로 진입.

3) **권한 상승 및 백도어 설치**  
   - 커널 취약점, sudo misconfig 등으로 **root 권한** 획득.  
   - **BPFDoor** 같은 고급 백도어 심음. SKT 사례선 `/dev/shm/kdmtmpflush`로 복사, 원본 삭제로 은폐.

4) **지속적 침투**  
   - BPFDoor는 **매직 패킷**을 받아야 활성화되는 수동형 C2.  
   - HSS DB 접근, 유심 정보 탈취, 다른 서버로 횡적 이동.

---

## 3. 왜 웹셸·RCE가 핵심인가?

1) **공격자 입장에서 손쉬운 초기 진입**  
   - 웹 서비스는 외부 노출 필수, 취약점 패치가 늦으면 자동 스캐너로 쉽게 뚫림.

2) **웹셸 vs. RCE, 결과는 동일**  
   - 업로드 취약점이건 RCE건, 한 번 셸을 얻으면 **BPFDoor 설치** 등 **서버 장악**이 가능.

3) **망분리 환경에서도 80/443 포트는 열려 있음**  
   - **대한민국 법원 해킹 사례**처럼 DMZ-내부망 연결은 웹 포트·VPN만 열려, 공격자들은 **웹 기반 공격**을 선호.

4) **피해 스케일 확장**  
   - 통신사·금융기관은 웹 서버가 많고 패치 누락 시 대규모 피해. 실제 침해사고서 “웹셸 또는 RCE”가 발단인 경우 다수.

---

## 4. 구체적 BPFDoor 설치 시나리오 (웹 기반 가정)

가정적으로 **WebLogic·Tomcat 취약점**을 이용해 웹셸/RCE → **Low-privilege 셸** 획득 → **root 권한 상승** 후 BPFDoor 설치 → **HSS DB** 대량 탈취의 흐름이 충분히 일어났을 수 있습니다. 이는 실제 경로와 다를 수 있으나, “웹 공격”이 가장 흔한 벡터라는 점에서 **합리적**입니다.

---

## 5. MITRE ATT&CK 매핑 (웹셸·RCE 기반)

### 왜 MITRE ATT&CK을 매핑했는가?

**MITRE ATT&CK**은 전 세계 보안 전문가들이 **공격자 전술**(Tactics)과 **기법**(Techniques)을 표준화해놓은 체계입니다. 만약 SKT 해킹이 BPFDoor로 귀결되었다면, 그전에 **웹셸 업로드**, **권한 상승**, **내부 정찰** 등 APT 전형 단계들이 있었을 것입니다.  
- **초기 침투(Initial Access)~Privilege Escalation** 등에서 **사전에 이벤트**를 잡아낼 기회가 있었음에도, 현실적 사정(인력 부족, 솔루션 운영 미흡)으로 놓쳤다는 점이 시사됨.  
- 따라서 **마이터 어택**으로 각 단계(웹 RCE, 커널 취약점 악용, 은폐 등)를 분석하면, **“놓친 신호가 무엇이었고 어떻게 보완해야 하는지”**를 체계적으로 파악할 수 있습니다.

---

### 상세 매핑 항목

1. **Initial Access (TA0001)**  
   - T1190: Exploit Public-Facing Application  
   - 웹셸 Upload(T1189 하위) 등

2. **Execution (TA0002)**  
   - T1059.004: Command-Line Interface(웹셸 → `shell_exec()`)

3. **Persistence (TA0003)**  
   - 웹셸: HTTP 요청만 있으면 재실행  
   - BPFDoor: 메모리 상주

4. **Privilege Escalation (TA0004)**  
   - T1068: 커널 취약점, SUID 등

5. **Defense Evasion (TA0005)**  
   - 웹셸: 확장자 우회  
   - BPFDoor: 파일 삭제(T1070.004), 프로세스 위장(T1036)

6. **Command and Control (TA0011)**  
   - BPFDoor: Traffic Signaling(T1205.002), Non-standard Port(T1571)

7. **Exfiltration (TA0010)**  
   - DB 자료 압축·전송

---

> **결론(매핑 의의)**: BPFDoor가 설치되기 전 단계에서 이미 여러 침해 지표를 놓친 것일 수 있으며, **MITRE ATT&CK**은 이 일련의 과정을 구조화해 **APT 공격 흐름**을 빠르게 재현하고 **대응 전략**을 마련하도록 돕습니다.

---

## 6. 보안팀을 위한 현실적 대응 전략 (웹 공격 관점)

**표준 해법**(웹 보안강화, WAF, 서버 하드닝, 침해사고 대응 등)에도 불구하고, 실제 현장에는 **여러 현실적 어려움**이 존재합니다:

### 6.1 정보보안 운영의 어려움
- **인력 부족**: IT 부서가 다른 업무에 몰두, 보안 이벤트 모니터링이 뒤로 밀림.  
- **장비·솔루션 방치**: WAF·IDS 도입 후 규칙 업데이트 안 하면 유명무실.  
- **웹앱 업데이트 주기**: N데이 취약점이 수시로 터지지만, 패치 따라가기 벅참.

> **마이터 어택 시사점**: 초기 침투 로그·RCE 시도 등에서 경고를 잡아내야 했지만, 솔루션 제대로 운영되지 않아 놓친 사례 많음.

### 6.2 보안 담당자 vs. 시스템 운영·개발자 간 우선순위 충돌
- **개발 일정 vs. 보안 점검**: 코드 리뷰·침투 테스트가 일정 압박에 밀림.  
- **서비스 가용성 vs. 하드닝**: `/dev/shm noexec` 같은 보안 설정은 호환성 리스크로 기피.  
- **장비 정책 충돌**: WAF 규칙이 엄격하면 운영서버 장애 우려, 느슨하면 보안 구멍.

> **마이터 어택 시사점**: 웹셸 업로드(T1190)나 Persistence(TA0003) 방어가 뒷전이면, BPFDoor 설치 전 방어 기회를 사전에 상실.

### 6.3 결국, 통합 정보보안 플랫폼(PLURA-XDR) 도입이 최적
인력·시간·전문성 한계로 인해 APT 공격 전 단계를 놓치면, BPFDoor 같은 **스텔스 백도어** 설치 후에는 이미 피해가 커집니다. **PLURA-XDR**로 여러 보안 기능을 **단일 플랫폼**에서 종합 관리하면:

- **사일로 해소**: WAF 정책 느슨해도, 웹 요청 본문 분석+EDR 행위 모니터링으로 보완.  
- **실시간 관제**: 한두 명의 담당자로도 APT 전 단계를 추적·차단.  
- **마이터 어택 관점**: 초기 침투부터 권한 상승, 백도어 설치 이벤트까지 일원화된 경보로 인지 가능.

---

#### 결론

- IT 현장에서 웹 공격 방어라는 **표준 방법론**은 중요하나, **현실적 여건**(부서 우선순위·전문인력 부족 등)으로 쉽게 실패하여, BPFDoor 같은 사태로 이어질 수 있음.  
- **PLURA-XDR**로 웹셸·RCE 공격부터 스텔스 백도어 감지까지 단일 인터페이스로 운영하면, **APT 공격** 흐름을 **초기 단계**부터 인지·대응 가능.

---

## 7. PLURA-XDR 정보보안 통합 플랫폼: 웹 요청 본문 분석을 통한 추가 방어

### 7.1 핵심 기능
1. **다계층 이벤트 연계(XDR)**: 웹 트래픽+엔드포인트+네트워크를 통합 분석.  
2. **HTTP Body/Payload 고급 분석**: Base64 JSP 웹셸, RCE 페이로드 탐지.  
3. **Zero-day 행위 기반 룰**: 서명(Signature) 없이 명령 패턴으로 차단.  
4. **자동 대응**: 실시간 격리, IP 차단 등 수행.

### 7.2 웹 요청 본문 분석의 필요성
- **파일 업로드**: 기존 WAF가 확장자 중심이면 `.jpg` 위장에 속기 쉬움.  
- **복잡한 RCE**: Log4Shell 같은 난독화 요청 본문도 PLURA-XDR가 탐지.  
- **HTTP/2, SSL, HTTP Chunked**: 트래픽 복호화·행위 분석으로 우회 공격 차단.

### 7.3 도입 시 기대 효과
- **웹셸·RCE 실시간 차단**  
- **BPFDoor 등 은밀한 백도어 탐지** (ICMP 기반 C2도 행위 분석으로 발견)  
- **자동화된 포렌식·보고**: 침해 경로 신속 파악.

> **정리**: PLURA-XDR는 WAF·IDS에서 놓친 초기도 잡아내므로, **마이터 어택 관점**에서 “이미 발생한 이벤트”를 재현해 BPFDoor 설치 전 대응이 가능하다.

---

## 8. 결론

1. **이번 SKT 해킹**을 웹 공격(웹셸·RCE) 중심으로 보면, **HSS** 서버에 침투하여 **BPFDoor**를 설치하고 장기 거점을 확보했을 가능성이 높음.  
2. **망분리**도 80/443 웹 포트나 VPN(4500)만 열려있으면 충분히 뚫림(대한민국 법원 해킹 사례).  
3. **BPFDoor**는 커널 레벨 BPF와 파일리스 기법을 써서 은밀성·장기성이 극대화됨.

> **가설적 결론**:  
> 1) SKT HSS 서버는 **웹셸/RCE** 초기 침투 후  
> 2) 권한 상승을 거쳐 **BPFDoor**를 심었으며  
> 3) 대규모 유심 데이터 탈취에 이르렀을 가능성이 높다.  
> 다른 루트(계정 탈취, 내부자 악용 등)도 가능하지만, 국내외 침해사고 통계를 보면 **웹 공격**이 가장 흔하다는 점에서 이 가설은 매우 합리적이다.

> **향후 검증 필요**:  
> - 포렌식 로그·추가 정보 공개 전까지는 단언할 수 없지만,  
> - **기업망 침해사고** 중 **대다수**가 웹 기반 공격이라는 경험칙에照해볼 때, 본 가설이 적중률이 높을 것이다.

---

### 최종 제언

- **웹셸/RCE 공격**이 대규모 침해사고의 주력 통로라는 전제하에, 기업·기관은 **웹 취약점 관리, 업로드 통제, WAF**를 제대로 운영해야 함.  
- BPFDoor 같은 **스텔스 백도어**가 설치되면 발견·차단이 어려우므로, **초기에 막는 것**이 가장 효과적.  
- 침해가 의심된다면 **메모리 포렌식, 행위 모니터링**을 철저히 수행해 은닉 악성코드(BPFDoor 등)를 수색해야 함.  
- **PLURA-XDR** 같은 **통합 플랫폼** 도입으로 WAF나 IPS가 놓친 공격(HTTP Body 위장, 난독화 페이로드)도 행위 기반으로 탐지·차단 가능. 망분리 환경(법원 사례 등)에서도 실시간 C2 흐름을 파악해 선제 대응을 기대할 수 있다.

---

### 참고 레퍼런스
- [BPFDoor 공격, 어떻게 침투하는가? | PLURA 실시간 시연](https://www.youtube.com/watch?v=bzGv1AwHy9k)  
- [SKT 유심 해킹 사건 총정리: 유출 원인, 피해 규모, 대응 방법](https://blog.plura.io/ko/column/leak_of_skt_usim/)  
- [BPFDoor 분석 및 PLURA-XDR 대응 전략](https://blog.plura.io/ko/respond/bpfdoor/)  
- [NDR 기술 한계와 스텔스 공격 대응법 (SKT 해킹 사례 분석)](https://blog.plura.io/ko/column/limitations-ndr-bpfdoor/)  
