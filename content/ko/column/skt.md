---
title: "SKT 해킹 가설: 유심 데이터 탈취와 BPFDoor 설치, 어떻게 이뤄졌나?"
date: 2025-05-03
draft: false
description: "2025년 4월 발생한 SKT 유심 정보 대규모 유출 사건을 중심으로, 웹셸·RCE 공격 가설과 BPFDoor 백도어의 침투 시나리오, 그리고 실제 적용 가능한 대응 방안을 쉽게 정리했습니다."
featured_image: "cdn/column/skt-hacking-hypothesis.png"
tags: ["SKT 해킹", "SKT 유심 유출", "유심 해킹", "RCE 취약점", "웹셸 공격", "BPFDoor", "APT 공격", "PLURA-XDR", "개인정보 유출", "망분리 해킹"]
---

> **핵심 한 줄 요약**
> 2025년 4월 18일, SK텔레콤 **HSS**(Home Subscriber Server)가 해킹되어 **최대 2,300만** 가입자의 USIM 인증 정보가 노출되었으며,
> SKT는 **4월 28일**에 전 고객을 대상으로 **무료 USIM 교체**를 발표했습니다.

<!--more-->

![SKT 해킹 공격 시퀀스 다이어그램 예시](https://blog.plura.io/cdn/column/skt-hacking-hypothesis.png)

---

아래 문서는 "**SKT 해킹 사건에서 BPFDoor를 설치하기 위한 주요 침투 벡터가 웹셸(WebShell)·RCE(Remote Code Execution) 중심이다**"라는 가설을 전제로 작성하였습니다.

**대한민국 법원 해킹 사례** 등에서도 보듯, 망분리 환경이라도 80/443 웹 포트나 SSL VPN(4500) 등 **웹 기반 통로**가 남아 있으면 공격이 가능합니다.

물론 실제로는 계정 탈취, 내부자 악용 등의 다른 수단도 있을 수 있으나, 본 글에서는 **웹셸·RCE** 공격에 무게중심을 두고 전개합니다.

향후 새로운 증거가 나오면 이 가설 역시 수정될 수 있음을 염두에 두고 읽어주시기 바랍니다.

---

## 1. SKT 유심 해킹 사건과 BPFDoor 개요

### 1.1 사건 요약

2025년 4월, SK텔레콤(이하 SKT) 핵심 서버인 **HSS(Home Subscriber Server)**가 해킹당해,
**BPFDoor** 악성코드가 설치된 정황이 포착되었습니다.

그 결과 **대규모 유심(USIM) 가입자 정보**가 탈취된 것으로 추정되고,
피해 규모가 최대 **2,300만 건**에 이를 수 있다는 분석이 있습니다.

이번 공격은 **중국계 APT 그룹**(Red Menshen, Earth Bluecrow, APT41 등)과 연계된 흔적이 보이며,
**BPFDoor**라는 스텔스 백도어를 장기간 활용해 서버 내부를 은밀히 장악했을 가능성이 유력합니다.

### 1.2 BPFDoor의 특징

**BPFDoor**는 **커널 레벨(BPF) 필터**를 악용한 **수동형 백도어**로,
매직 패킷을 수신해야만 활성화됩니다.

일반적인 백도어처럼 포트를 열어두지 않고, ICMP 또는 비표준 포트를 통해 **은밀한 C2 통신**을 구축합니다.

또한 **메모리 상주(fileless)** 형태를 선호하여, `/dev/shm` 등 임시 디렉터리에 복제 후 원본 파일을 삭제합니다.

프로세스를 **정상 데몬**처럼 위장하는 등 은폐 기술이 뛰어나,
포렌식으로 흔적을 찾기가 쉽지 않습니다.

이 백도어는 중동·아시아 지역 통신사·금융기관 등에서 여러 차례 발견되었고,
이번 SKT 사건도 이와 유사한 **고도화된 공격** 흐름의 연장으로 평가됩니다.

---

## 2. 웹셸(WebShell)·RCE를 통한 BPFDoor 배포: 가설적 시나리오

이 문서의 주요 **가설**은 다음과 같습니다:

> "**SKT 사건에서, 공격자들은 가장 흔하고 효율적인 웹 기반 공격(웹셸·RCE)을 통해 HSS 서버 내부권한을 확보한 뒤, BPFDoor를 설치했을 가능성이 높다.**"

이는 **대한민국 법원 해킹 사례**처럼 망분리 환경이더라도 **80/443 웹 포트**나 VPN을 통해 내부망으로 접속이 가능하고,
다수의 APT 보고서에서 웹셸/RCE 공격이 침해사고 초기에 가장 많이 악용된다는 점에 근거합니다.

### 2.1 일반적인 웹셸·RCE 공격 흐름

1) **취약점 식별**
- 공격 대상 서버(예: WebLogic, Apache, Tomcat, 자체 웹 앱 등)에 존재하는 **공개취약점(N-day)** 또는 **0-day** 파악.
- 파일 업로드 기능이 허술하면, **웹셸 업로드**가 가능합니다.

2) **원격 코드 실행(RCE) 달성**
- **웹셸 업로드**: `.jsp`/`.php` 스크립트 삽입 후 특정 URL로 호출해 서버 명령을 실행.
- **RCE 취약점**: Log4Shell, WebLogic RCE, 역직렬화 등으로 HTTP 요청만으로 OS 명령 수행.
- 이 단계에서 공격자는 웹서버 계정(www-data, tomcat 등) 권한으로 내부 진입.

3) **권한 상승 및 백도어 설치**
- 커널 취약점, sudo misconfig 등으로 **root 권한**을 획득.
- **BPFDoor** 같은 고급 백도어를 심어 장기 거점을 마련.
- SKT 사례에서는 `/dev/shm/kdmtmpflush`라는 이름으로 복제 후 원본 삭제 정황이 의심됩니다.

4) **지속적 침투**
- BPFDoor는 매직 패킷이 와야만 활성화되는 **수동형 C2**.
- 이후 HSS DB 접근, 유심(USIM) 인증키, IMSI 등 대규모 정보 탈취.

---

## 3. 왜 웹셸·RCE가 핵심인가?

1) **공격자 입장에서 가장 손쉬운 초기 진입**
- 웹 서비스는 반드시 외부에 노출해야 하고, 프레임워크나 플러그인 등이 많아 공격 표면이 넓습니다.
- 패치 미비나 N-day 취약점이 있다면 자동화 스캐너로 대량 공격이 가능.

2) **웹셸 vs. RCE, 결과는 동일: 서버 장악**
- 업로드 취약점을 악용한 웹셸도, RCE 취약점을 이용한 원격 명령 실행도, 결국 OS 수준 접근을 허용합니다.
- 한 번 셸을 획득하면 **BPFDoor 설치** 등 고도화 침투가 손쉽게 진행됨.

3) **망분리 환경에서도 80/443 포트는 열려 있음**
- **2023년 5월 대한민국 법원 해킹 사례**처럼, DMZ-내부망간 통로는 80/443 웹 포트나 VPN(4500) 정도가 필수로 열려 있습니다.
- 공격자는 **결국 웹 트래픽**을 통해 측면 이동(Lateral Movement)을 시도합니다.

4) **피해 스케일 확장**
- 통신사·금융기관은 수십~수백 대의 웹 서버를 운영, 취약점 패치가 제때 안 되면 대규모 피해가 발생.
- 실제 현장에서도 “웹셸로 시작된 침해” 혹은 “RCE로 한 번에 뚫린” 사례가 빈번합니다.

---

## 4. 구체적 BPFDoor 설치 시나리오 (웹 기반 가정)

아래는 “웹 공격이 주력”이라는 전제하에 가정된 **가설적** 시나리오입니다.
실제 침해 경로와 다를 수 있으나, 여러 APT 침해사고와 비슷한 패턴을 보입니다.

1) (가정) **WebLogic, Tomcat, 혹은 자체 웹앱 취약점**
- HSS 관리와 연계된 웹 서버 중 하나가 **취약 버전**이었고,
- 공격자가 자동 스캔 후 RCE(Exploit Public-Facing Application)나 웹셸 업로드를 시도.

2) **Low-privilege 셸 획득**
- 웹서버 계정(tomcat, www-data) 권한으로 환경 탐색(`uname -a`, `cat /etc/passwd` 등).
- 필요한 추가 권한 상승 루트를 모색.

3) **Root 권한 확보**
- 커널 취약점, sudo misconfig, SUID 파일 등을 악용해 root 획득.
- 이제 BPFDoor 설치가 가능 (커널 레벨 소켓 필터 등록에는 높은 권한 필요).

4) **BPFDoor 업로드 & 실행**
- `/dev/shm/kdmtmpflush` 등 임시 디렉터리에 파일을 복사 후 원본 삭제.
- 프로세스 위장, 커널 BPF 필터 설정 → 매직 패킷으로 수동 C2 채널 형성.

5) **HSS DB 접근 및 자료 탈취**
- BPFDoor로 재접속이 가능, HSS 내부 DB에서 유심(USIM) 인증키, IMSI 등 대량 쿼리.
- 대규모 유심 정보 유출 사태로 이어짐.

---

## 5. MITRE ATT&CK 매핑 (웹셸·RCE 기반)

### 왜 MITRE ATT&CK을 매핑했는가?

**MITRE ATT&CK**은 전 세계 보안 전문가들이 **공격자의 전술(Tactics)**과 **기법(Techniques)**을 표준화해놓은 체계입니다.

이번 SKT 해킹에서 최종적으로 **BPFDoor**가 설치·활동했다면, 그 이전 단계에서 *웹셸 업로드*, *권한 상승*, *내부 정찰* 등 여러 이벤트가 발생했을 것입니다.

실제로 **BPFDoor** 같은 스텔스 백도어는 공격 후반부(나중 단계)에 투입되는 경우가 많은데,
**초기 침투(Initial Access), 실행(Execution), 권한 상승(Privilege Escalation)** 등에서 **이미 사전 경고**를 잡을 기회가 있었다는 뜻입니다.

이를 구조적으로 분석하기 위해 **ATT&CK** 매핑이 유용합니다.  
공격자가 어떤 단계(TA000x)에서 어떤 기법(T1xxx)을 사용했는지 분류하면,
**“우리는 어느 지점에서 놓쳤나?”**를 체계적으로 파악할 수 있기 때문입니다.

---

### 주요 전술·기법 예시

1. **Initial Access (TA0001)**
- T1190: **Exploit Public-Facing Application** (RCE)
- WebShell Upload (T1189 하위)  
- 의의: 망분리라도 80/443 포트 열려 있으면 공격자가 진입 가능.

2. **Execution (TA0002)**
- T1059.004: **Command-Line Interface** (웹셸 → `shell_exec()` 등)
- 의의: 공격자는 웹셸에서 OS 명령을 마음대로 실행, wget/curl로 추가 악성코드 다운로드 등 수행.

3. **Persistence (TA0003)**
- 웹셸은 HTTP 요청만 있으면 재실행.
- BPFDoor는 메모리 상주(fileless)로 재부팅 전까지 지속.
- 의의: 한 번 배포되면 쉽게 제거하기 어렵다.

4. **Privilege Escalation (TA0004)**
- T1068: **Exploitation for Privilege Escalation** (커널 취약점, SUID, sudo misconfig)
- 의의: 웹서버 기본 계정(tomcat, www-data)은 제한적 권한. root가 되어야 BPFDoor 설치가 수월.

5. **Defense Evasion (TA0005)**
- 웹셸: 확장자 우회, `.php.jpg` 등 MIME 헤더 위장.
- BPFDoor: 파일 삭제(T1070.004), 프로세스 위장(T1036), 타임스템핑(T1070.006).
- 의의: 은밀성을 극대화해 보안솔루션, 관리자 눈을 피함.

6. **Command and Control (TA0011)**
- BPFDoor: Traffic Signaling(T1205.002), Non-standard port(T1571), Encrypted Channel(T1573).
- 의의: 매직 패킷으로 수동 C2를 열고, ICMP나 비표준 포트+암호화로 방어 우회.

7. **Exfiltration (TA0010)**
- 웹셸 or 역방향 셸을 통해 DB 파일을 압축·전송.
- 의의: APT 공격의 최종 단계로, 대규모 유심 정보가 유출된 정황.

---

### 정리: MITRE ATT&CK 매핑의 의미

**BPFDoor** 설치를 성공하기 전까지, 공격자는 **Initial Access → Execution → Privilege Escalation** 등 여러 단계를 거쳤을 것입니다.

즉, 초기에 **웹셸 업로드**나 **RCE** 공격, **sudo misconfig** 같은 권한 상승 시도가 있었을 텐데,
이를 사전에 인지했다면 **BPFDoor** 같은 스텔스 백도어로 이어지지 않았을 가능성이 큽니다.

**ATT&CK 매핑**은 이 전 과정을 표준화해, **보안팀이 어느 부분을 놓쳤는지**와 **어떻게 보완해야 할지**를 체계적으로 제시한다는 장점이 있습니다.

---

## 6. 보안팀을 위한 현실적 대응 전략 (웹 공격 관점)

웹 애플리케이션 보안강화, WAF 설정, 서버 하드닝, BPFDoor 탐지·차단, 침해사고 대응 프로세스 마련 등 **표준 해법**이 흔히 제시되지만,
실제 **기업·기관** 환경에서는 다음과 같은 **현실적 어려움**들로 인해 APT 공격 흐름을 놓치기 쉽습니다.

> **주의**: 마이터 어택 관점에서 보면, BPFDoor가 최종 설치되기 전 단계(Initial Access 등)에서 **충분히 이벤트 감지**가 가능했음에도, 아래와 같은 문제로 **보안팀**이 실패했을 확률이 높습니다.

### 6.1 정보보안 운영의 현실적인 어려움

- **현장 인력 부족**
- IT 부서는 개발·운영·지원 업무로 바쁘고, 보안 전담팀은 적거나 전무.
- 공격 이벤트가 로그에 남아도 즉각 분석·대응이 어려움.

- **장비·솔루션 도입 후 방치**
- WAF, IDS 같은 장비가 있어도, 규칙 업데이트·로그 분석이 제때 이루어지지 않으면 유명무실.
- 공격자는 최신 RCE 취약점을 활용하나, 조직은 6개월 전 시그니처를 쓰고 있는 경우 흔함.
- (마이터 어택 시사점) 초기 침투(TA0001) 로그만 제대로 봤어도 웹셸 업로드 시도를 차단했을 수 있음.

- **웹 애플리케이션 업데이트 속도**
- WebLogic, Tomcat, CMS 등은 패치가 잦고, 하루아침에 N데이 취약점이 터집니다.
- IT 인력이 부족하면 이런 업데이트를 제때 따라가기 어렵습니다.
- (마이터 어택 시사점) T1190(Exploit Public-Facing App) 공격을 쉽게 허용했을 가능성.

---

### 6.2 보안 담당자 vs. 시스템 운영·개발자 간 우선순위 불일치

- **개발 일정 vs. 보안 점검**
- 기능 구현·배포가 촉박하면, 코드 리뷰·침투 테스트·업로드 필터링 등이 후순위로 밀림.
- 웹셸 업로드(T1190 하위)를 방어할 필터 설정이 생략되는 사례가 종종 있음.

- **서비스 가용성 vs. 하드닝**
- 운영팀은 24/7 무중단을 원하고, 보안 담당자는 SELinux 강화나 `/dev/shm noexec` 옵션을 요구.
- 하드닝은 호환성 문제를 일으킬 수 있어 서로 충돌.  
- Persistence(TA0003) 관점에서, `/dev/shm noexec`만 적용되어도 BPFDoor 실행을 막을 기회가 컸을 수 있음.

- **장비 정책 충돌**
- WAF 규칙을 빡빡하게 잡으면 정상 트래픽까지 차단돼 운영 부서가 반발.
- 느슨하게 하면 RCE·웹셸 공격이 그대로 통과.  
- Execution(TA0002) 단계에서 의심 명령어를 놓칠 수 있음.

---

### 6.3 결국, 통합 정보보안 플랫폼(PLURA-XDR) 도입이 올바른 선택

이처럼 인력 부족·솔루션 방치·부서 간 우선순위 불일치로 **APT 공격 전 단계**를 놓친다면,
BPFDoor가 설치된 뒤엔 이미 피해가 확산된 상태일 것입니다.

**PLURA-XDR(Extended Detection & Response)**를 통해 여러 보안 기능을 **단일 플랫폼**에서 종합 운영하면,
사일로를 해소하고 **마이터 어택 관점**에서 초반부터 공격 흐름을 탐지·대응하기가 수월해집니다.

> 요컨대, PLURA-XDR는 WAF 정책이 느슨한 환경에서도 **웹 요청 본문(HTTP Body)과 호스트 행위(EDR)를 연계 분석**하므로,
> **초기 침투**(Initial Access) 시점부터 RCE·웹셸 페이로드를 탐지하고,
> Privilege Escalation(T1068)까지 일어나는 과정을 실시간으로 경고해줄 수 있습니다.

원론적으로 이번 SKT 해킹도 **PLURA-XDR**가 도입되었다면,
웹셸 호출 흔적이나 권한 상승 이벤트를 **단계별**로 인지하여,
**BPFDoor**가 설치되기 이전에 선제 대응이 가능했을 것입니다.

---

## 7. PLURA-XDR 정보보안 통합 플랫폼: 웹 요청 본문 분석을 통한 추가 방어

앞서 말한 표준 웹 보안 전략(파일 업로드 필터링, RCE 패치, 침해사고 대응 프로세스)만으로도 기본은 갖출 수 있으나,
최근 APT 공격은 **웹 요청을 난독화**하거나 **암호화된 파일 업로드**를 시도해 전통적 규칙 기반 솔루션(WAF, IPS)을 우회합니다.

이때 **PLURA-XDR**는 **HTTP Body(POST, 업로드 파일 등)**를 열어보고,
**행위 기반 룰**을 통해 **Zero-day** 공격까지 포착 가능하므로,
“WAF가 놓쳤을 공격”을 **초기 단계**부터 잡아내는 역할을 합니다.

### 7.1 PLURA-XDR의 핵심 기능

1) **다계층 이벤트 연계(XDR)**
- 네트워크, 엔드포인트(EDR), 클라우드, 웹 트래픽 등 **단편 지표가 아닌 상관관계**로 공격 식별.

2) **HTTP Body/Payload 고급 분석**
- Base64로 인코딩된 JSP 웹셸, 역직렬화 페이로드, Log4Shell 등도 다단계 분석.

3) **Zero-day 행위 기반 룰**
- 시그니처 없이 명령어 패턴, 프로세스 흐름을 탐지해 선제 차단.

4) **자동화된 Incident Response**
- 위험 이벤트를 감지하면 IP 차단, 프로세스 격리, 관리자 알림을 **자동**으로 수행.

### 7.2 웹 요청 본문 분석이 중요한 이유

- **파일 업로드 기반 웹셸**: 단순 확장자 필터를 우회한 `.jpg` 내부에 JSP 코드를 숨길 수 있음. PLURA-XDR가 실제 Body를 열어봐야 식별 가능.
- **복잡한 RCE 페이로드**: Log4Shell, 역직렬화 등 난독화된 요청 본문을 다단계로 분석해야 탐지.
- **HTTP/2, SSL, Chunked 변형**: PLURA-XDR가 트래픽 복호화·행위 기반 룰로 우회 시도를 차단.

### 7.3 도입 시 기대 효과

1) **웹셸·RCE 실시간 감지 및 차단**
- 기존 WAF 시그니처가 놓친 패턴도, PLURA-XDR의 행위 기반 분석으로 포착.

2) **BPFDoor 등 은밀한 백도어 탐지**
- BPFDoor 커널 레벨 C2도 결국 네트워크+호스트 이벤트가 발생.
- PLURA-XDR가 아이피테이블(IPTables) 순간 변경, ICMP Ping에 삽입된 매직 바이트 등을 연결 분석 가능.

3) **자동화된 포렌식 및 보고**
- 침해사고 의심 시, 관련 HTTP·프로세스·네트워크 로그를 시각화.  
- 빠른 시간 내에 공격 경로를 재현, 피해 범위를 확인할 수 있음.

4) **Zero-day 대응력 향상**
- 공격이 알려지지 않은 취약점이라도, “파일 업로드 직후 이상 프로세스 생성 → 권한 상승 시도” 같은 행위로 잡아낼 수 있음.

---

> **정리**: PLURA-XDR는 “WAF나 IPS가 놓친 초기 웹 공격”을 메워주는 역할을 하므로,  
> 마이터 어택 관점에서 Execution(T1059), Privilege Escalation(T1068) 이전에 경고를 발생시켜,  
> BPFDoor 같은 스텔스 백도어가 설치되기 전에 선제 대응할 수 있게 해줍니다.

---

## 8. 결론

**이번 SKT 해킹**에서 대규모 유심(USIM) 정보가 유출된 것은, 고도화된 **APT 공격** 흐름(웹셸·RCE → 권한 상승 → BPFDoor 설치)이 성공적으로 진행되었기 때문일 가능성이 높습니다.

**망분리**라도 **80/443 웹 포트**나 **VPN(4500)**이 존재하면, **대한민국 법원 해킹 사례**처럼 공격자는 웹 기반 공격을 노리고 내부망에 진입할 수 있습니다.

**BPFDoor**는 커널 레벨 BPF와 파일리스(fileless) 기법을 활용해 디스크 포렌식과 관리자 모니터링을 우회,  
“매직 패킷”을 통해 C2를 은밀히 구축합니다.

결과적으로 SKT HSS 서버가 장기간 장악되었고, **2,300만** 가입자 유심 정보가 유출되었다고 추정됩니다.

### 가설적 결론

1) **웹셸/RCE**를 통한 초기 침투(TA0001, T1190 등)  
2) 커널 취약점 등으로 **root 권한 상승**(TA0004)  
3) **BPFDoor** 설치(Persistence) 및 C2(Command & Control)  
4) **유심 데이터**(Exfiltration) 대거 유출

이 시나리오는 국내외 침해사고에서 가장 흔한 “웹 공격 → 백도어” 흐름과 부합하며,  
다른 루트(계정 탈취, 내부자 악용 등)도 완전히 배제할 순 없지만,  
**웹셸·RCE 공격이 대다수**라는 업계 경험칙에照해볼 때 **합리적**이라 할 수 있습니다.

> **향후 검증 필요**:  
> - 실제 포렌식, 로그 자료가 추가로 공개되어야 최종 경로가 확정.  
> - 다만, 웹 공격이 APT 초기 침투의 **절대다수**라는 점에서 본 가설의 타당성은 높음.

---

### 최종 제언

- **웹셸/RCE**가 대규모 침해사고의 “주력 통로”라는 인식을 다시 확인해야 합니다.
- BPFDoor 같은 **스텔스 백도어**가 설치된 뒤에는 탐지가 훨씬 어려우므로, **초기 침투 차단**이 최선입니다.
- 침해가 의심될 경우 **메모리 포렌식** + **행위 모니터링**으로 은닉 악성코드(BPFDoor·root킷 등)을 철저히 찾아야 합니다.
- **PLURA-XDR** 같은 통합 보안 플랫폼을 도입하면, WAF가 놓칠 가능성이 있는 **HTTP Body 분석**을 행위 기반으로 수행하고,
커널·엔드포인트 레벨까지 실시간 연동 관제하므로, 마이터 어택 상 여러 공격 단계를 **초반부터** 감지·차단할 수 있습니다.

---

### 📺 함께 시청하기
* [BPFDoor 공격, 어떻게 침투하는가? | PLURA 실시간 탐지 시연](https://www.youtube.com/watch?v=bzGv1AwHy9k)

### 📖 함께 읽기
* [SKT 유심 해킹 사건 총정리: 유출 원인, 피해 규모, 대응 방법까지](https://blog.plura.io/ko/column/leak_of_skt_usim/)  
* [SKT 해킹 악성코드 BPFDoor 분석 및 탐지 시연 영상 (PLURA-XDR 대응 전략 포함)](https://blog.plura.io/ko/respond/bpfdoor/)  
* [SKT 해킹으로 본 NDR 기술 한계: BPFDoor 같은 스텔스 공격 대응법](https://blog.plura.io/ko/column/limitations-ndr-bpfdoor/)  

