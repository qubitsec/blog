---
title: "NDR의 한계: 스텔스형 공격 대응의 현실적 문제"
date: 2025-05-02
draft: false
description: "NDR(Network Detection and Response)의 한계와 스텔스형 위협 대응을 위한 현실적인 접근 방안을 탐구합니다."
featured_image: "cdn/column/limitations-ndr-bpfdoor.jpg"
tags: ["NDR", "네트워크 보안", "스텔스 공격", "BPFdoor", "Symbiote", "LummaC2", "암호화 트래픽", "보안 솔루션", "PLURA-XDR"]
---

📡 **NDR**(Network Detection and Response)은 네트워크 트래픽 분석을 통해 위협을 탐지하는 보안 기술이지만,  
최근 SK텔레콤 해킹 사건처럼 고도화된 **스텔스형 공격** 앞에서는 분명한 기술적 한계를 드러냈습니다.

![NDR의 한계](https://blog.plura.io/cdn/column/limitations-ndr-bpfdoor.jpg)

<!--more-->

---

## 1. 최근 스텔스형 공격의 특징

* **BPFdoor** – 매직 패킷을 받기 전까지 ‘포트리스(portless)’ 상태로 은폐.  
* **Symbiote** – 리눅스 정상 프로세스에 기생하는 루트킷, 로그·/proc 조작 가능.  
* **LummaC2** – 난수형 주기·TLS 암호화 C2 통신으로 탐지면을 극소화.

이들은 모두 **전통적 시그니처·패턴 기반 보안**을 손쉽게 우회하도록 설계됐습니다.

---

## 2. NDR 기술의 명확한 한계 (요약)

| 구분 | 한계점 | 핵심 이유 |
|------|--------|-----------|
| **① 암호화 트래픽 분석 불가능** | TLS 1.3·QUIC·ESNI로 **내용 가시성 0** | 메타데이터만으로는 스텔스형 위협 식별 불가 |
| **② 행위 기반 탐지의 높은 오탐률** | 정상 세션과 미세 차이 → **오탐 & 미탐** | 경보 피로 (alert fatigue) 유발 |
| **③ 탐지 우회형 공격 대응 불가능** | BPFdoor 등은 **세션·포트 자체가 존재 안 함** | NDR의 탐지 범위 밖 |

---

## 3. NDR 기술의 명확한 한계 (상세)

### 🔍 1) 암호화 트래픽 분석의 불가능성
첫째, NDR은 네트워크의 암호화된 트래픽에 대해 메타데이터와 트래픽 패턴 분석에 의존하여 위협을 탐지합니다. 하지만 BPFdoor와 같은 스텔스형 악성코드는 포트리스(portless) 형태로 작동하며, 정상적인 네트워크 트래픽과 구분이 거의 불가능한 수준으로 은닉되어 있습니다. 특히, BPFdoor는 특정 ‘매직 패킷’에만 반응하여 네트워크 트래픽에서 나타나는 비정상성을 최소화하여 탐지를 회피합니다. 따라서 NDR의 행위 기반 탐지 방식으로는 이런 유형의 공격을 탐지하기 어렵습니다.  

> **서술형 보강**  
> TLS 1.3·QUIC·ESNI까지 적용되면 패킷 내부뿐 아니라 _SNI·ALPN_ 정보도 암호화되어 JA3/TLS 지문·세션 길이 등 간접 지표에만 의존해야 합니다. 문제는 스텔스 악성코드가 애초에 **세션을 거의 만들지 않거나, 정상 트래픽과 동일한 타이밍·패턴으로 위장**해 신호대-잡음비(S/N)를 극도로 낮춘다는 점입니다. 결국 “보이지 않는 패킷을 본다”는 전제 자체가 깨져, NDR 모델은 통계적으로 의미 있는 특징을 추출할 수 없습니다.

---

### 🔍 2) 행위 기반 탐지의 높은 오탐률
둘째, 행위 기반 탐지는 본질적으로 오탐(false positives)과 미탐(false negatives)의 위험을 크게 안고 있습니다. 특히 정상적인 업무 트래픽과 미세한 차이만을 보이는 고도화된 위협인 경우, 잘못된 경고가 지나치게 많이 발생하거나 실제 위협이 탐지되지 않을 수 있습니다. 이는 NDR 시스템이 과부하되거나 관리자의 자원을 낭비하게 만들어 오히려 보안 운영의 효율성을 저하시킬 수 있습니다.  

> **서술형 보강**  
> 예를 들어 JA3 지문은 _Google Chrome 버전 별 변동_·_미들박스 재가공_ 등에 의해 충돌이 빈번해, 동일 지문이 SaaS API·멀웨어 트래픽을 동시에 나타낼 수 있습니다. AI/ML 모델이라도 학습 데이터 편향을 완전히 제거하지 못하기 때문에, **정상 서비스를 차단하거나 실제 공격을 놓치는 이중 리스크**가 현실화됩니다. 이렇게 쌓인 ‘경보 피로(alert fatigue)’는 SOC 팀의 대응 시간을 늘려 결과적으로 방어 면역력을 약화시키는 악순환을 만들게 됩니다.

---

### 🔍 3) 탐지 우회형 공격 대응 불가능
셋째, NDR은 암호화된 트래픽의 내용을 직접 분석할 수 없습니다. 최근 대부분의 인터넷 트래픽은 TLS 1.3 및 QUIC 프로토콜과 같이 핸드셰이크 단계부터 암호화되는 방식이므로, NDR은 실제 공격 트래픽의 내용을 전혀 볼 수 없습니다. 따라서 트래픽의 겉모습만으로 스텔스형 위협을 정확히 구분하는 것은 거의 불가능에 가깝습니다.  

> **서술형 보강**  
> BPFdoor·Symbiote·LummaC2는 **“행위 시그널 자체를 없애는”** 설계를 택합니다.  
> * **BPFdoor** — 매직 패킷이 오기 전까지 포트 오픈·DNS 쿼리 모두 ZERO.  
> * **Symbiote** — 호스트 내부에서 `/proc`·로그를 변조해 패킷 기록을 애초에 남기지 않음.  
> * **LummaC2** — 난수형 주기·TLS 암호화로 비콘(beacon) 타임라인을 지워 버림.  
> 이런 공격은 “네트워크에서 관찰할 수 있는 단서”를 의도적으로 제거하기 때문에, NDR이 아무리 고도화돼도 **탐지할 표본 자체가 존재하지 않는** 논리적 한계에 부딪힙니다.

---

## 4. 한계를 극복하는 현실적 대안: **PLURA-XDR**

### ✅ PLURA-XDR의 통합 접근

1. **본문 로그 실시간 수집** – TLS 내부 요청·응답까지 가시화.  
2. **OWASP 기반 L7 분석** – 네트워크가 아닌 **애플리케이션 레이어**에서 직접 차단.  
3. **EDR·루트킷 탐지** – 커널/유저 공간 은폐 행위 식별.  
4. **AI 상관 분석 & 자동 대응** – 네트워크·호스트·로그를 한 그래프로 묶어 즉시 차단.

> **요약:** PLURA-XDR은 NDR이 놓치는 암호화·스텔스 구간을 **엔드포인트·로그·AI 상관 분석**으로 메우는 다층 방어 플랫폼입니다.

---

## 5. 결론: 통합 방어 전략이 답이다

스텔스형 위협 시대, **NDR**으로는 결코 완벽 대응이 불가능합니다.  
**PLURA-XDR**과 같은 **다층·통합 솔루션**을 적용해야만 실질적인 보안 효과를 얻을 수 있습니다.

**✅ PLURA-XDR = NDR의 한계를 보완하는 현실적 차세대 보안 솔루션.**

---

### 📖 **함께 읽기**
* ["기사: 기존 보안으론 못막아… 잇단 대형 해킹에 스텔스 위협 대응 촉구"](https://n.news.naver.com/article/018/0006002991)
* ["WAF vs IPS vs UTM 비교하여 웹 공격 최상의 제품 선택하기"](https://blog.plura.io/ko/column/waf_ips_utm_comparison/)
* ["Cisco Encrypted Traffic Analytics(ETA)의 한계"](https://community.cisco.com/t5/security-knowledge-base/cisco-eta-feature-encrypted-traffic-analysis-at-glance/ta-p/4783197)
